<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js frappé">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>AI/ML/DS book</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="last-changed.css">
        <link rel="stylesheet" href="./theme/catppuccin.css">
        <link rel="stylesheet" href="./theme/catppuccin-highlight.css">
        <link rel="stylesheet" href="././mdbook-admonish.css">

        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "macchiato" : "frappé";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('frappé')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="preface.html">Preface</a></li><li class="chapter-item expanded affix "><li class="part-title">Trending applications</li><li class="chapter-item expanded "><a href="technolgoies-libraries.html"><strong aria-hidden="true">1.</strong> Technologies / libraries</a></li><li class="chapter-item expanded "><a href="query-a-knowledge-base.html"><strong aria-hidden="true">2.</strong> Query a knowledge base</a></li><li class="chapter-item expanded affix "><li class="part-title">General</li><li class="chapter-item expanded "><a href="general/eda.html"><strong aria-hidden="true">3.</strong> EDA</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> Tasks</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="anomaly-detection.html"><strong aria-hidden="true">4.1.</strong> Anomaly detection</a></li><li class="chapter-item expanded "><a href="recsys.html"><strong aria-hidden="true">4.2.</strong> Recsys</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="recsys-ii.html"><strong aria-hidden="true">4.2.1.</strong> Recsys II</a></li><li class="chapter-item expanded "><a href="recsys-youtube.html"><strong aria-hidden="true">4.2.2.</strong> YouTube</a></li></ol></li><li class="chapter-item expanded "><a href="survival-analysis.html"><strong aria-hidden="true">4.3.</strong> Survival analysis</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.4.</strong> Market basket analysis</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.5.</strong> Time series analysis</div></li></ol></li><li class="chapter-item expanded "><a href="stream-processing.html"><strong aria-hidden="true">5.</strong> Stream processing</a></li><li class="chapter-item expanded "><a href="hyperparameter-optimisation.html"><strong aria-hidden="true">6.</strong> Hyperparameter optimisation</a></li><li class="chapter-item expanded "><a href="feature-transformation.html"><strong aria-hidden="true">7.</strong> Feature transformation</a></li><li class="chapter-item expanded "><a href="feature-selection.html"><strong aria-hidden="true">8.</strong> Feature selection</a></li><li class="chapter-item expanded "><a href="feature-engineering.html"><strong aria-hidden="true">9.</strong> Feature engineering</a></li><li class="chapter-item expanded "><a href="train-test-split.html"><strong aria-hidden="true">10.</strong> Train-test split</a></li><li class="chapter-item expanded "><a href="cross-validation.html"><strong aria-hidden="true">11.</strong> Cross validation</a></li><li class="chapter-item expanded "><a href="ensembling.html"><strong aria-hidden="true">12.</strong> Ensembling</a></li><li class="chapter-item expanded "><a href="eda-plus-plus.html"><strong aria-hidden="true">13.</strong> EDA++</a></li><li class="chapter-item expanded "><a href="tests.html"><strong aria-hidden="true">14.</strong> Tests</a></li><li class="chapter-item expanded "><a href="ml-system-design.html"><strong aria-hidden="true">15.</strong> ML system design</a></li><li class="chapter-item expanded "><a href="general-metrics.html"><strong aria-hidden="true">16.</strong> Metrics</a></li><li class="chapter-item expanded "><a href="general/bonus-questions.html"><strong aria-hidden="true">17.</strong> Bonus questions</a></li><li class="chapter-item expanded "><a href="bias-variance-decomposition.html"><strong aria-hidden="true">18.</strong> Bias-variance decomposition</a></li><li class="chapter-item expanded "><a href="rare-event-classification.html"><strong aria-hidden="true">19.</strong> Rare event classification / anomaly detection</a></li><li class="chapter-item expanded "><a href="blas.html"><strong aria-hidden="true">20.</strong> BLAS</a></li><li class="chapter-item expanded "><a href="coursera.html"><strong aria-hidden="true">21.</strong> Coursera</a></li><li class="chapter-item expanded "><a href="improve-generalisation.html"><strong aria-hidden="true">22.</strong> Improve generalisation</a></li><li class="chapter-item expanded "><a href="general-course-history.html"><strong aria-hidden="true">23.</strong> Course history</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Domain: Vision</li><li class="chapter-item expanded "><a href="vision/eda.html"><strong aria-hidden="true">24.</strong> EDA</a></li><li class="chapter-item expanded "><a href="image-processing.html"><strong aria-hidden="true">25.</strong> Image processing</a></li><li class="chapter-item expanded "><a href="image-frameworks.html"><strong aria-hidden="true">26.</strong> Image frameworks</a></li><li class="chapter-item expanded "><a href="techniques.html"><strong aria-hidden="true">27.</strong> Techniques</a></li><li class="chapter-item expanded "><a href="vision/regularisation.html"><strong aria-hidden="true">28.</strong> Regularisation</a></li><li class="chapter-item expanded "><a href="basic-cnn-architectures.html"><strong aria-hidden="true">29.</strong> Basic CNN architectures</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">30.</strong> Tasks</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="image-classification.html"><strong aria-hidden="true">30.1.</strong> Image classification</a></li><li class="chapter-item expanded "><a href="object-detection.html"><strong aria-hidden="true">30.2.</strong> Object detection</a></li><li class="chapter-item expanded "><a href="instance-segmentation.html"><strong aria-hidden="true">30.3.</strong> Semantic segmentation</a></li><li class="chapter-item expanded "><a href="reidentification.html"><strong aria-hidden="true">30.4.</strong> Reidentification</a></li><li class="chapter-item expanded "><a href="autoaugment.html"><strong aria-hidden="true">30.5.</strong> AutoAugment</a></li><li class="chapter-item expanded "><a href="style-transfer.html"><strong aria-hidden="true">30.6.</strong> Style transfer</a></li><li class="chapter-item expanded "><a href="obj-inst-seg.html"><strong aria-hidden="true">30.7.</strong> Obj det / instance seg</a></li><li class="chapter-item expanded "><a href="ocr.html"><strong aria-hidden="true">30.8.</strong> OCR</a></li><li class="chapter-item expanded "><a href="ui.html"><strong aria-hidden="true">30.9.</strong> UI</a></li><li class="chapter-item expanded "><a href="vision/others.html"><strong aria-hidden="true">30.10.</strong> Others</a></li></ol></li><li class="chapter-item expanded "><a href="computer-vision/pretraining-tasks.html"><strong aria-hidden="true">31.</strong> Pretraining tasks</a></li><li class="chapter-item expanded "><a href="computer-vision/models.html"><strong aria-hidden="true">32.</strong> Models</a></li><li class="chapter-item expanded "><a href="vision/trending.html"><strong aria-hidden="true">33.</strong> Trending</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Domain: Language</li><li class="chapter-item expanded "><a href="language/language.html"><strong aria-hidden="true">34.</strong> Intro</a></li><li class="chapter-item expanded "><a href="language/processing.html"><strong aria-hidden="true">35.</strong> Processing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="language/tokenisation.html"><strong aria-hidden="true">35.1.</strong> Tokenisation</a></li><li class="chapter-item expanded "><a href="language/embeddings.html"><strong aria-hidden="true">35.2.</strong> Embeddings</a></li><li class="chapter-item expanded "><a href="language/encoding.html"><strong aria-hidden="true">35.3.</strong> Encoding</a></li><li class="chapter-item expanded "><a href="language/representation.html"><strong aria-hidden="true">35.4.</strong> Representation</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">36.</strong> Tasks</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="language/language-modelling.html"><strong aria-hidden="true">36.1.</strong> Language modelling</a></li><li class="chapter-item expanded "><a href="language/topic-modelling.html"><strong aria-hidden="true">36.2.</strong> Topic modelling</a></li><li class="chapter-item expanded "><a href="language/sequence-modelling.html"><strong aria-hidden="true">36.3.</strong> Sequence modelling</a></li><li class="chapter-item expanded "><a href="language/ner.html"><strong aria-hidden="true">36.4.</strong> NER</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">37.</strong> Tasks</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="language/sentiment-analysis.html"><strong aria-hidden="true">37.1.</strong> Sentiment analysis</a></li><li class="chapter-item expanded "><a href="language/qa.html"><strong aria-hidden="true">37.2.</strong> QA</a></li><li class="chapter-item expanded "><a href="language/summarisation.html"><strong aria-hidden="true">37.3.</strong> Summarisation</a></li><li class="chapter-item expanded "><a href="language/machine-translation.html"><strong aria-hidden="true">37.4.</strong> Machine translation</a></li><li class="chapter-item expanded "><a href="language/coreference.html"><strong aria-hidden="true">37.5.</strong> Coreference</a></li><li class="chapter-item expanded "><a href="language/reading-comprehension.html"><strong aria-hidden="true">37.6.</strong> Reading comprehension</a></li><li class="chapter-item expanded "><a href="language/paraphrase.html"><strong aria-hidden="true">37.7.</strong> Paraphrase</a></li><li class="chapter-item expanded "><a href="language/commonsense.html"><strong aria-hidden="true">37.8.</strong> Commonsense</a></li><li class="chapter-item expanded "><a href="language/nli.html"><strong aria-hidden="true">37.9.</strong> NLI</a></li></ol></li><li class="chapter-item expanded "><a href="language/language-models.html"><strong aria-hidden="true">38.</strong> Language models</a></li><li class="chapter-item expanded "><a href="language/pretraining.html"><strong aria-hidden="true">39.</strong> Pretraining tasks</a></li><li class="chapter-item expanded "><a href="language/fine-tuning.html"><strong aria-hidden="true">40.</strong> Fine-tuning</a></li><li class="chapter-item expanded "><a href="language/models.html"><strong aria-hidden="true">41.</strong> Models</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="language/prompting.html"><strong aria-hidden="true">41.1.</strong> Prompting</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">Domain: Speech</li><li class="chapter-item expanded "><a href="digital-signal-processing.html"><strong aria-hidden="true">42.</strong> Digital signal processing</a></li><li class="chapter-item expanded "><a href="speech/models.html"><strong aria-hidden="true">43.</strong> Models</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Domain: Graph</li><li class="chapter-item expanded "><a href="graph-analysis.html"><strong aria-hidden="true">44.</strong> Graph analysis</a></li><li class="chapter-item expanded "><a href="graph/models.html"><strong aria-hidden="true">45.</strong> Models</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Domain: Multimodal</li><li class="chapter-item expanded "><a href="multimodal/pretraining.html"><strong aria-hidden="true">46.</strong> Pretraining tasks</a></li><li class="chapter-item expanded "><a href="multimodal/models.html"><strong aria-hidden="true">47.</strong> Models</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Domain: AI planning</li><li class="chapter-item expanded "><div><strong aria-hidden="true">48.</strong> AI planning</div></li><li class="spacer"></li><li class="chapter-item expanded "><a href="loss-functions.html"><strong aria-hidden="true">49.</strong> Loss functions</a></li><li class="chapter-item expanded "><a href="metrics.html"><strong aria-hidden="true">50.</strong> Metrics</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">51.</strong> Hyperparameter optimisation</div></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">'Learning' types</li><li class="chapter-item expanded "><div><strong aria-hidden="true">52.</strong> Supervision</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="supervised-learning.html"><strong aria-hidden="true">52.1.</strong> Supervised learning</a></li><li class="chapter-item expanded "><a href="semi-supervised-learning.html"><strong aria-hidden="true">52.2.</strong> Semi-supervised learning</a></li><li class="chapter-item expanded "><a href="weakly-supervised-learning.html"><strong aria-hidden="true">52.3.</strong> Weakly-supervised learning</a></li><li class="chapter-item expanded "><a href="self-supervised-learning.html"><strong aria-hidden="true">52.4.</strong> Self-supervised learning</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">52.5.</strong> Unsupervised learning</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="clustering-algorithms.html"><strong aria-hidden="true">52.5.1.</strong> Clustering algorithms</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">52.5.2.</strong> Dimensionality reduction algorithms</div></li></ol></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">53.</strong> n-shot learning</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">54.</strong> Deep learning</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">54.1.</strong> Knowledge distillation</div></li><li class="chapter-item expanded "><a href="intro-to-dl.html"><strong aria-hidden="true">54.2.</strong> Intro to DL</a></li><li class="chapter-item expanded "><a href="tensor-libraries.html"><strong aria-hidden="true">54.3.</strong> Tensor libraries</a></li><li class="chapter-item expanded "><a href="sparse-matrices.html"><strong aria-hidden="true">54.4.</strong> Sparse matrices</a></li><li class="chapter-item expanded "><a href="transfer-learning.html"><strong aria-hidden="true">54.5.</strong> Transfer learning</a></li><li class="chapter-item expanded "><a href="weight-initialisation.html"><strong aria-hidden="true">54.6.</strong> Weight initialisation</a></li><li class="chapter-item expanded "><a href="bonus-questions.html"><strong aria-hidden="true">54.7.</strong> Bonus questions</a></li><li class="chapter-item expanded "><a href="frameworks.html"><strong aria-hidden="true">54.8.</strong> Frameworks</a></li><li class="chapter-item expanded "><a href="improving-predictive-power.html"><strong aria-hidden="true">54.9.</strong> Improving predictive power</a></li><li class="chapter-item expanded "><a href="optimisers.html"><strong aria-hidden="true">54.10.</strong> SGD optimisers</a></li><li class="chapter-item expanded "><a href="limitations-and-new-frontiers.html"><strong aria-hidden="true">54.11.</strong> Limitations and new frontiers</a></li><li class="chapter-item expanded "><a href="learning-rate-scheduler.html"><strong aria-hidden="true">54.12.</strong> Learning rate scheduler</a></li><li class="chapter-item expanded "><a href="backpropagation-softmax-and-categorical-cross.html"><strong aria-hidden="true">54.13.</strong> Backpropagation softmax and categorical cross</a></li><li class="chapter-item expanded "><a href="hyperparameter-search.html"><strong aria-hidden="true">54.14.</strong> hyperparameter-search</a></li><li class="chapter-item expanded "><a href="layers.html"><strong aria-hidden="true">54.15.</strong> layers</a></li><li class="chapter-item expanded "><a href="improving-speed-accuracy.html"><strong aria-hidden="true">54.16.</strong> improving-speed-accuracy</a></li><li class="chapter-item expanded "><a href="activation-functions.html"><strong aria-hidden="true">54.17.</strong> Activation functions</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">55.</strong> Machine learning</div></li><li class="chapter-item expanded "><a href="reinforcement-learning.html"><strong aria-hidden="true">56.</strong> Reinforcement learning</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">57.</strong> Bayesian learning</div></li><li class="chapter-item expanded "><a href="metric-learning.html"><strong aria-hidden="true">58.</strong> Metric learning</a></li><li class="chapter-item expanded "><a href="learning-to-rank.html"><strong aria-hidden="true">59.</strong> Learning to rank</a></li><li class="chapter-item expanded "><a href="deep-generative-models.html"><strong aria-hidden="true">60.</strong> Deep generative models</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Models and algorithms</li><li class="chapter-item expanded "><a href="association-rule-mining.html"><strong aria-hidden="true">61.</strong> Association rule mining</a></li><li class="chapter-item expanded "><a href="decision-tree.html"><strong aria-hidden="true">62.</strong> Decision tree</a></li><li class="chapter-item expanded "><a href="dbscan.html"><strong aria-hidden="true">63.</strong> DBSCAN</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">64.</strong> Diffusion model</div></li><li class="chapter-item expanded "><a href="evolutionary-algorithms.html"><strong aria-hidden="true">65.</strong> Evolutionary algorithms</a></li><li class="chapter-item expanded "><a href="frequent-itemsets.html"><strong aria-hidden="true">66.</strong> Frequent itemsets</a></li><li class="chapter-item expanded "><a href="gaussian-process.html"><strong aria-hidden="true">67.</strong> Gaussian process</a></li><li class="chapter-item expanded "><a href="gmm.html"><strong aria-hidden="true">68.</strong> GMM</a></li><li class="chapter-item expanded "><a href="hierarchical-clustering.html"><strong aria-hidden="true">69.</strong> Hierachical clustering</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">70.</strong> HMM</div></li><li class="chapter-item expanded "><a href="gradient-boosting.html"><strong aria-hidden="true">71.</strong> Gradient boosting</a></li><li class="chapter-item expanded "><a href="k-means.html"><strong aria-hidden="true">72.</strong> k-means</a></li><li class="chapter-item expanded "><a href="k-nn.html"><strong aria-hidden="true">73.</strong> k-NN</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">74.</strong> KDE</div></li><li class="chapter-item expanded "><a href="lda.html"><strong aria-hidden="true">75.</strong> LDA</a></li><li class="chapter-item expanded "><a href="linear-models.html"><strong aria-hidden="true">76.</strong> Linear models</a></li><li class="chapter-item expanded "><a href="logistic-regression.html"><strong aria-hidden="true">77.</strong> Logistic regression</a></li><li class="chapter-item expanded "><a href="mean-shift.html"><strong aria-hidden="true">78.</strong> Mean shift</a></li><li class="chapter-item expanded "><a href="naive-bayes.html"><strong aria-hidden="true">79.</strong> Naive Bayes</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">80.</strong> Neural networks</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">80.1.</strong> MLP</div></li><li class="chapter-item expanded "><a href="cnn.html"><strong aria-hidden="true">80.2.</strong> CNN</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">80.3.</strong> RNN</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">80.4.</strong> LSTM</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">80.5.</strong> Transformer</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">80.6.</strong> GAN</div></li></ol></li><li class="chapter-item expanded "><a href="pagerank.html"><strong aria-hidden="true">81.</strong> PageRank</a></li><li class="chapter-item expanded "><a href="pca.html"><strong aria-hidden="true">82.</strong> PCA</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">83.</strong> PGM</div></li><li class="chapter-item expanded "><a href="svm.html"><strong aria-hidden="true">84.</strong> SVM</a></li><li class="chapter-item expanded "><a href="t-sne.html"><strong aria-hidden="true">85.</strong> t-SNE</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">86.</strong> Tree ensembles</div></li><li class="chapter-item expanded "><a href="umap.html"><strong aria-hidden="true">87.</strong> UMAP</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Representations</li><li class="chapter-item expanded "><a href="similarity-measures.html"><strong aria-hidden="true">88.</strong> Similarity measures</a></li><li class="chapter-item expanded "><a href="similarity-search.html"><strong aria-hidden="true">89.</strong> Similarity search</a></li><li class="chapter-item expanded "><a href="similar-items.html"><strong aria-hidden="true">90.</strong> Similar items</a></li><li class="chapter-item expanded "><a href="dimensionality-reduction.html"><strong aria-hidden="true">91.</strong> Dimensionality reduction</a></li><li class="chapter-item expanded "><a href="ann.html"><strong aria-hidden="true">92.</strong> ANN</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">System design</li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Others</li><li class="chapter-item expanded "><a href="concept-drift.html"><strong aria-hidden="true">93.</strong> Concept drift</a></li><li class="chapter-item expanded "><a href="interpretable-ai.html"><strong aria-hidden="true">94.</strong> Interpretable AI</a></li><li class="chapter-item expanded "><a href="adversarial-ai.html"><strong aria-hidden="true">95.</strong> Adversarial AI</a></li><li class="chapter-item expanded "><a href="automl.html"><strong aria-hidden="true">96.</strong> AutoML</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="latte">Latte</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="frappe">Frappé (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="macchiato">Macchiato</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mocha">Mocha</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">AI/ML/DS book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/remykarem/remkarem.github.io" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="preface"><a class="header" href="#preface">Preface</a></h1>
<p>Hi, these are my personal notes!</p>
<p><strong>LLM frameworks</strong></p>
<p>LlamaIndex</p>
<p><strong>Low-level frameworks</strong></p>
<p><a href="https://developer.apple.com/metal/pytorch/">MPS (Metal Performance Shaders)</a></p>
<p><strong>Hardware</strong></p>
<p>Apple Silicon
GPU</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="technologies--libraries"><a class="header" href="#technologies--libraries">Technologies / libraries</a></h1>
<ul>
<li><a href="https://www.pinecone.io/">Pinecone</a></li>
<li><a href="https://qdrant.tech/">Qdrant</a></li>
<li><a href="https://blog.langchain.dev/">LangChain</a></li>
<li><a href="https://github.com/weaviate/weaviate">Weaviate</a></li>
<li><a href="https://gpt-index.readthedocs.io/en/latest/">LlamaIndex</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="query-a-knowledge-base"><a class="header" href="#query-a-knowledge-base">Query a knowledge base</a></h1>
<p>&quot;In-Context Learning&quot;, few-shot</p>
<ol>
<li>Organise knowledge base as documents</li>
<li>Embed every document (chunking needed) and index</li>
<li>Embed query</li>
<li>Compare query against the index</li>
<li>Retrieve most similar document</li>
<li>Include document as context in the prompt, then ask the original query</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="eda"><a class="header" href="#eda">EDA</a></h1>
<p><a href="https://www.kaggle.com/gunesevitan/titanic-advanced-feature-engineering-tutorial">https://www.kaggle.com/gunesevitan/titanic-advanced-feature-engineering-tutorial</a></p>
<ul>
<li>Missing values
<ul>
<li>Fill using information from correlation</li>
<li>Fill using group information</li>
<li>Fill via knowledge (search)</li>
<li>Fill via heuristics (how a value is obtained in the real world)</li>
</ul>
</li>
<li>Importance of visualisation in the right angle</li>
<li>Distribution of a feature with hue=(train, test)</li>
<li>Remarks</li>
<li>Engineering features based on <em>information gain</em> (against target).</li>
<li>High cardinality indicates that a lot of feature engineering can be done. Convert high cardinality to count. (Is it always okay?)</li>
<li>Create a feature that is your own proxy of the target variable.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="anomaly-detection"><a class="header" href="#anomaly-detection">Anomaly detection</a></h1>
<p><a href="https://scikit-learn.org/stable/modules/outlier_detection.html#">https://scikit-learn.org/stable/modules/outlier_detection.html#</a></p>
<p><a href="https://github.com/arundo/adtk">https://github.com/arundo/adtk</a></p>
<p>Methods</p>
<ul>
<li>Outlier detection: training data already contains outliers
<ul>
<li>Local outlier factor</li>
<li>Isolation forest</li>
<li>One-class SVM</li>
<li>Robust covariance</li>
</ul>
</li>
<li>Novelty detection: training data not polluted by outliers
<ul>
<li>One-class SVM</li>
<li>Local outlier factor</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="recsys"><a class="header" href="#recsys">Recsys</a></h1>
<p>Recommender system, recommendation system</p>
<ul>
<li><a href="recsys.html#libraries">Libraries</a></li>
<li><a href="recsys.html#resources">Resources</a></li>
<li><a href="recsys.html#terminology">Terminology</a></li>
<li><a href="recsys.html#data">Data</a>
<ul>
<li><a href="recsys.html#types-of-interaction--feedback">Types of interaction / feedback</a>
<ul>
<li><a href="recsys.html#implicit-feedback">Implicit feedback</a></li>
<li><a href="recsys.html#explicit-feedback">Explicit feedback</a></li>
</ul>
</li>
<li><a href="recsys.html#train-test-split">Train-test split</a></li>
</ul>
</li>
<li><a href="recsys.html#methods">Methods</a>
<ul>
<li><a href="recsys.html#content-based-filtering">Content-based filtering</a></li>
<li><a href="recsys.html#collaborative-filtering">Collaborative filtering</a></li>
<li><a href="recsys.html#matrix-factorisation">Matrix factorisation</a>
<ul>
<li><a href="recsys.html#item-based-collaborative-filtering">Item-based collaborative filtering</a></li>
<li><a href="recsys.html#neighbourhood-methods-based-on-feedback-matrix">Neighbourhood methods based on feedback matrix</a></li>
<li><a href="recsys.html#supervised-learning">Supervised learning</a></li>
</ul>
</li>
<li><a href="recsys.html#hybrid">Hybrid</a>
<ul>
<li><a href="recsys.html#supervised-learning-1">Supervised learning</a></li>
<li><a href="recsys.html#ltr">LTR</a></li>
<li><a href="recsys.html#factorisation-machine">Factorisation machine</a></li>
</ul>
</li>
<li><a href="recsys.html#retrieval">Retrieval</a></li>
</ul>
</li>
<li><a href="recsys.html#metrics">Metrics</a></li>
<li><a href="recsys.html#tricks">Tricks</a></li>
<li><a href="recsys.html#case-studies">Case studies</a></li>
</ul>
<hr />
<p>Goal of recsys:</p>
<ul>
<li>Provide 'relevant' recommendations to users</li>
<li>Balance between diversity, novelty and familiarity</li>
</ul>
<p><img src="./recsys-1.png" alt="Spectrum" /></p>
<p><strong>Motivation</strong></p>
<p>Having a recommendation system helps users find things they wouldn’t have to look for on their own.</p>
<h1 id="libraries"><a class="header" href="#libraries">Libraries</a></h1>
<p><a href="https://github.com/facebookresearch/dlrm">DLRM</a></p>
<p><a href="https://github.com/NicolasHug/Surprise">Surprise</a></p>
<p><a href="https://github.com/microsoft/recommenders">Microsoft Recommenders</a></p>
<p>Implicit</p>
<p>DeepFM</p>
<p>LightFM - hybrid recommendation algorithm (3000)</p>
<p><a href="https://github.com/wubinzzu/NeuRec">NeuRec</a></p>
<h1 id="resources"><a class="header" href="#resources">Resources</a></h1>
<p><a href="https://developers.google.com/machine-learning/recommendation">Google’s recommendation system course</a></p>
<p><a href="https://blog.fastforwardlabs.com/2018/04/10/pytorch-for-recommenders-101.html">https://blog.fastforwardlabs.com/2018/04/10/pytorch-for-recommenders-101.html</a> (Collaborative filtering using supervised learning and DNN)</p>
<p><a href="https://www.ethanrosenthal.com/2017/06/20/matrix-factorization-in-pytorch/">https://www.ethanrosenthal.com/2017/06/20/matrix-factorization-in-pytorch/</a></p>
<p><a href="https://blog.fennel.ai/p/real-world-recommendation-system?s=r">https://blog.fennel.ai/p/real-world-recommendation-system?s=r</a></p>
<h1 id="terminology"><a class="header" href="#terminology"><strong>Terminology</strong></a></h1>
<p>“Dense features” - watch time, time since last watch, …</p>
<p>“Sparse features” - watch history, country, …</p>
<p>“Side features” - user metadata, …</p>
<p>“Factors” - embedding size</p>
<h1 id="data"><a class="header" href="#data">Data</a></h1>
<h2 id="types-of-interaction--feedback"><a class="header" href="#types-of-interaction--feedback">Types of interaction / feedback</a></h2>
<h3 id="implicit-feedback"><a class="header" href="#implicit-feedback">Implicit feedback</a></h3>
<ul>
<li>Click</li>
<li>Purchase</li>
<li>Follow</li>
<li>Duration of consumption</li>
</ul>
<p>indirectly reflect opinion by observing user behaviour including purchase history, browsing history (ALS is good).</p>
<p>Classification problem.</p>
<ul>
<li>How recent?</li>
<li>Downloaded or not?</li>
<li>Synopsis / reviews of books?</li>
</ul>
<h3 id="explicit-feedback"><a class="header" href="#explicit-feedback">Explicit feedback</a></h3>
<ul>
<li>Rating (star ratings eg. GoodReads, MovieLens, Amazon)</li>
<li>Review</li>
<li>Vote</li>
<li>Continuous scale</li>
<li>Pairwise preference (if you like one product X over another product Y)</li>
<li>Temporary (eg. Pandora 30-day suspend)</li>
</ul>
<p>(aka ratings) explicit input by users regarding their interest in product.</p>
<p>Regression problem.</p>
<ul>
<li>During or immediately after consumption</li>
<li>Some time after the experience</li>
</ul>
<p>Difficulties with ratings</p>
<ul>
<li>Ratings might not be reliable because users might not express their preference well on the scale. If you asked someone to re-rate, their rating will change.</li>
<li>Ever-changing users (helping to borrow book for another person).</li>
<li>User preference can change.</li>
<li>What does a rating mean?</li>
</ul>
<h2 id="train-test-split"><a class="header" href="#train-test-split"><strong>Train-test split</strong></a></h2>
<ul>
<li>Mask out some parts of entries in the feedback matrix</li>
<li>Leave-one-out
Hold out the most recent transaction of each user</li>
<li>Time series split:
Split the whole dataset according to time sequence, and hold out the newer transactions based. On a cut-off date</li>
<li>Split by user:
Hold our certain user’s transaction data</li>
<li>Sliding window</li>
</ul>
<h1 id="methods"><a class="header" href="#methods">Methods</a></h1>
<h2 id="content-based-filtering"><a class="header" href="#content-based-filtering">Content-based filtering</a></h2>
<p>My own alias: &quot;feature-based filtering&quot;</p>
<p>When recommending for a user, one can:</p>
<ul>
<li>compute the similarity between a user embedding and all other item embeddings</li>
<li>compute the similarity between an item embedding and all other item embeddings. These items can come from a user's history.</li>
</ul>
<p>and return the closest items.</p>
<h2 id="collaborative-filtering"><a class="header" href="#collaborative-filtering">Collaborative <strong>filtering</strong></a></h2>
<p>interaction-only filtering</p>
<p>My own alias: &quot;interaction-based filtering&quot;</p>
<p>Types:</p>
<ul>
<li>Neighbourhood-based methods (similarity based)
<ul>
<li>Item-based, user-based</li>
</ul>
</li>
<li>Latent factor models
<ul>
<li>Matrix factorisation</li>
<li>Supervised learning</li>
</ul>
</li>
</ul>
<p>Collaborative filtering uses similarities/interactions/feedback signals between users and items simultaneously to provide recommendations (in a more supervised manner). This requires</p>
<ul>
<li>Feedback signals (labels) that indicate if a user has interacted with an item.</li>
</ul>
<p>Collaborative here refers to interaction between user and item.</p>
<p><img src="./recsys-2.png" alt="Feedback matrix" /></p>
<p>During retrieval, an embedding of a user or item is obtained, which is then used to find similar users or items.</p>
<h2 id="matrix-factorisation"><a class="header" href="#matrix-factorisation"><strong>Matrix factorisation</strong></a></h2>
<p><img src="./recsys-3.png" alt="Matrix factorisation" /></p>
<p>MSE = rating - predicted rating,           where predictedrating = global avg + item bias + user-item interaction</p>
<p>Objective functions: MSE, Frobenius distance</p>
<p>Optimisers: ****SVD, PCA, NMF, SGD, ALS (alternating least squares)</p>
<p>Cons: Cold-start problem - during retrieval, a new item does not have an assigned embedding.</p>
<p>During retrieval, user embedding can be looked up from user embedding matrix.</p>
<p>..............</p>
<p><a href="https://developers.google.com/machine-learning/recommendation/collaborative/matrix">https://developers.google.com/machine-learning/recommendation/collaborative/matrix</a></p>
<p>Matrix factorisation is an embedding model where it learns <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span> such that the </p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8913em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span></p>
<p><img src="./recsys-4.png" alt="Matrix factorisation" /></p>
<p><strong>Objectives</strong></p>
<p>There are several objective functions (to be minimised) to choose from:</p>
<ul>
<li>
<p>Frobenius norm</p>
<p>For the first entry in the matrix, take the squared difference between true and predicted. Repeat the same for all other entries. Finally sum all these squared differences. Treat unobserved as zeros.</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4638em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1502em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
</li>
<li>
<p>Observed-only MF</p>
<p>Only consider observed values.</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4638em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">(observed)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.4578em;vertical-align:-0.413em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">(observed)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><img src="./recsys-5.png" alt="Observed only MF" /></p>
</li>
<li>
<p>Weighted MF</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.6em;vertical-align:-0.55em;"></span><span class="mop op-symbol large-op" style="position:relative;top:0em;">∑</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">(observed)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">(observed)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">(unobserved)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>Sometimes you also need to weight the observed pairs:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.6em;vertical-align:-0.55em;"></span><span class="mop op-symbol large-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">(observed)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">(observed)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">(observed)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">(unobserved)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">(unobserved)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><img src="./recsys-6.png" alt="Weighted MF" /></p>
</li>
</ul>
<p><strong>Optimisers</strong> </p>
<ul>
<li>
<p>SGD</p>
<ol>
<li>Initialise embeddings to <span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.2514em;vertical-align:-0.93em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord mathnormal">ni</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.1833em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9267em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span><span style="top:-2.8867em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702 c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14 c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54 c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10 s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429 c69,-144,104.5,-217.7,106.5,-221 l0 -0 c5.3,-9.3,12,-14,20,-14 H400000v40H845.2724 s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7 c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1133em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span> where K is no. of features</li>
</ol>
</li>
<li>
<p>Weighted ALS</p>
<ol>
<li>Initialise embeddings randomly.</li>
<li>Alternate between (i) fixing <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span> and solving <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span>, and (ii) fixing <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span> and solving <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span>. Each stage can be solved exactly via OLS. </li>
</ol>
<blockquote>
<p>⚠️ Only for objective functions that are squared loss.</p>
</blockquote>
</li>
<li>
<p>SVD</p>
<p>Not good if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> is very sparse. (Why?)</p>
</li>
<li>
<p>Coordinate descent</p>
</li>
<li>
<p>Conjugate gradient</p>
</li>
</ul>
<p>Embeddings (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span>) are initialised randomly.</p>
<h3 id="item-based-collaborative-filtering"><a class="header" href="#item-based-collaborative-filtering">Item-based collaborative filtering</a></h3>
<ol>
<li>
<p>Create interaction matrix</p>
<p><img src="./recsys-7.png" alt="Interaction matrix" /></p>
</li>
<li>
<p>Create item-item similarity based on interaction matrix.</p>
<p><img src="./recsys-8.png" alt="Item-item similarity" /></p>
</li>
<li>
<p>Recommend:</p>
<ul>
<li>Customer B: Item 3</li>
<li>Customer C: Item 4, Item 2. Item 5 is similar to Item 4 (similarity value: 0.82). Item 2 is similar to Item 3 (similarity value: 0.45).</li>
</ul>
</li>
</ol>
<h3 id="neighbourhood-methods-based-on-feedback-matrix"><a class="header" href="#neighbourhood-methods-based-on-feedback-matrix"><strong>Neighbourhood methods based on feedback matrix</strong></a></h3>
<p>Get k most similar users to the user, recommend new items.</p>
<h3 id="supervised-learning"><a class="header" href="#supervised-learning"><strong>Supervised learning</strong></a></h3>
<p>Neural collaborative filtering</p>
<p><img src="./recsys-9.png" alt="Neural collaborative filtering" /></p>
<h2 id="hybrid"><a class="header" href="#hybrid">Hybrid</a></h2>
<p>&quot;feature-and-interaction filtering&quot;</p>
<p>Combination of content-based and collaborative filtering</p>
<p>Uses both</p>
<ol>
<li>Features of
<ul>
<li>Users</li>
<li>Items</li>
</ul>
</li>
<li>Interactions between users and items</li>
</ol>
<h3 id="supervised-learning-1"><a class="header" href="#supervised-learning-1">S<strong>upervised learning</strong></a></h3>
<p>Can be framed as binary classification or multiclass classification.</p>
<p><img src="./recsys-10.png" alt="Recsys supervised learning" /></p>
<p>During retrieval, ???</p>
<h3 id="ltr"><a class="header" href="#ltr"><strong>LTR</strong></a></h3>
<p>LTR trains a model to directly predict the probability of a certain item ranking over another item.</p>
<h3 id="factorisation-machine"><a class="header" href="#factorisation-machine"><strong>Factorisation machine</strong></a></h3>
<p>A generalisation of matrix factorisation that allows use of item and user metadata, and feedback signals. It models the interaction between user and item with higher-order dimensions. This is in contrast to Matrix Factorisation, where interaction is modelled as dot-product.</p>
<p><img src="./recsys-11.png" alt="Factorisation machine" /></p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3.2316em;vertical-align:-1.4032em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4032em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3.2588em;vertical-align:-1.4304em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4032em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4304em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="retrieval"><a class="header" href="#retrieval"><strong>Retrieval</strong></a></h2>
<p>One can think of the embedding space as an abstract representation common to both users and items, in which we can measure the notion of closeness or relevance using similarity metric.</p>
<ul>
<li>Cosine</li>
<li>Euclidean</li>
<li>Dot product</li>
</ul>
<p>At inference time,</p>
<ol>
<li>Look up embedding of input
<ul>
<li>If input is a user/query, look up its embedding.</li>
<li>If input is an item, look up its embedding.</li>
</ul>
</li>
<li>Select top k nearest neighbours. One may consider using approximate nearest neighbours for large corpora.</li>
</ol>
<h1 id="metrics"><a class="header" href="#metrics"><strong>Metrics</strong></a></h1>
<p>Accuracy: How similar are the recommendations compared to previous interactions?</p>
<p>Diversity: How dissimilar are the recommendations?</p>
<p>Coverage: What % of the user-item space are recommended?</p>
<p>Serendipity: How surprising are the relevant recommendations?</p>
<p>Novelty: How surprising are the recommendations in general?</p>
<p>Relevancy: How relevant are the recommendations?</p>
<h1 id="tricks"><a class="header" href="#tricks">Tricks</a></h1>
<ul>
<li>2-stage:
<ul>
<li>Stage 1: Candidate generation</li>
<li>Stage 2: Ranking</li>
</ul>
</li>
</ul>
<p><img src="./recsys-12.png" alt="2-stage recsys" /></p>
<ul>
<li>
<p>Banding</p>
<p>The top predictions are what the user has already read. But we don't want that. Instead it is customary to use the 70% percentile onwards.</p>
</li>
</ul>
<h1 id="case-studies"><a class="header" href="#case-studies">Case studies</a></h1>
<ul>
<li><a href="https://research.google/pubs/pub45530/">YouTube</a></li>
<li><a href="https://instagram-engineering.com/powered-by-ai-instagrams-explore-recommender-system-7ca901d2a882">Instagram Explore</a></li>
<li><a href="https://medium.com/airbnb-engineering/machine-learning-powered-search-ranking-of-airbnb-experiences-110b4b1a0789">Airbnb Experiences</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="recsys-1"><a class="header" href="#recsys-1">Recsys</a></h1>
<ul>
<li><a href="recsys-ii.html#content-based">Content-based</a></li>
<li><a href="recsys-ii.html#collaborative-filtering">Collaborative filtering</a>
<ul>
<li><a href="recsys-ii.html#user-based-nearest-neighbour">User-based nearest neighbour</a></li>
<li><a href="recsys-ii.html#item-based-nearest-neighbour">Item-based nearest neighbour</a></li>
<li><a href="recsys-ii.html#predict">Predict</a></li>
<li><a href="recsys-ii.html#evaluating-prediction">Evaluating prediction</a></li>
</ul>
</li>
</ul>
<hr />
<h2 id="content-based"><a class="header" href="#content-based">Content-based</a></h2>
<p>Complexity: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span> where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> is the no. of users</p>
<ul>
<li>Item-based</li>
<li>User-based</li>
</ul>
<p>A user can be represented as the average of items they interacted. Can use <em>cosine similarity</em> to compare</p>
<p>Pros:</p>
<ul>
<li>Explainable (can explain via features)</li>
<li>Can recommend new items &amp; unpopular items</li>
<li>Does not depend on other user data (CF)</li>
</ul>
<p>Cons:</p>
<ul>
<li>Cold start for new users</li>
<li>Hard to find features for unstructured data like images</li>
<li>No variety — might not recommend items outside user's content profile</li>
</ul>
<h2 id="collaborative-filtering-1"><a class="header" href="#collaborative-filtering-1">Collaborative filtering</a></h2>
<p>Pros:</p>
<ul>
<li>No need feature selection</li>
</ul>
<p>Cons:</p>
<ul>
<li>Cold start</li>
<li>Sparse!!!</li>
<li>Cannot recommend an item that no one has rated</li>
<li>Tend to recommend popular items</li>
</ul>
<h3 id="user-based-nearest-neighbour"><a class="header" href="#user-based-nearest-neighbour">User-based nearest neighbour</a></h3>
<p>Complexity: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></p>
<p>where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> is the no. of users. Given a context user, find the similarity between the other <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> users.</p>
<p>In order to find <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> most similar users (in the predict state), we need to do a weighted sum over these users.</p>
<p>Similarity measures</p>
<ul>
<li>
<p>Jaccard</p>
<ul>
<li>
<p>cons</p>
<p>ignore value of ratings</p>
</li>
</ul>
</li>
<li>
<p>Cosine similarity</p>
<ul>
<li>
<p>cons</p>
<p>treats missing (0's) as negative</p>
</li>
</ul>
</li>
<li>
<p>Centered cosine similarity (pearson correlation)</p>
<p><img src="recsys-ii-g" alt="Untitled" /></p>
<ol>
<li>Normalise every row (user) by subtracting the mean (ignore nil values)</li>
<li>Do cosine similarity. Treat nil values as 0.</li>
</ol>
</li>
</ul>
<h3 id="item-based-nearest-neighbour"><a class="header" href="#item-based-nearest-neighbour">Item-based nearest neighbour</a></h3>
<p>(defined similarly)</p>
<blockquote>
<p>💡 Why is item-item better than user-user? Users have multiple tastes (cannot be captured by the average)</p>
</blockquote>
<h3 id="predict"><a class="header" href="#predict">Predict</a></h3>
<p>For a context user, their predicted rating for a particular item is</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">contextuser,item</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4254em;vertical-align:-0.9857em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4397em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0017em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">user</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">user</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.6897em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0017em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">user</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">contextuser &amp; user</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">user,item</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9857em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>where user <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">∈</span></span></span></span> {users who have rated this item before} and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> is the normalised rating</p>
<h3 id="evaluating-prediction"><a class="header" href="#evaluating-prediction">Evaluating prediction</a></h3>
<p><img src="recsys-ii-1.png" alt="Untitled" /></p>
<p><img src="recsys-ii-2.png" alt="Untitled" /></p>
<p><strong>replacement for error measure — use top k</strong></p>
<p>prediction diversity — maybe got other things i also like</p>
<p>prediction context — i interested in other things liao your prediction outdated</p>
<p>order of predictions</p>
<p><img src="recsys-ii-3.png" alt="Untitled" /></p>
<p><img src="recsys-ii-4.png" alt="Untitled" /></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="youtube"><a class="header" href="#youtube">YouTube</a></h1>
<ul>
<li><a href="recsys-youtube.html#motivation">Motivation</a></li>
<li><a href="recsys-youtube.html#data-size">Data size</a></li>
<li><a href="recsys-youtube.html#approach">Approach</a></li>
<li><a href="recsys-youtube.html#global-video-embedding">Global video embedding</a></li>
<li><a href="recsys-youtube.html#candidate-generation">Candidate generation</a></li>
<li><a href="recsys-youtube.html#metrics">Metrics</a></li>
<li><a href="recsys-youtube.html#learnings">Learnings</a></li>
</ul>
<hr />
<p><img src="./recsys-13.jpg" alt="YouTube recommender" /></p>
<h2 id="motivation"><a class="header" href="#motivation"><strong>Motivation</strong></a></h2>
<p>“Discover personalised content from an ever-growing corpus of videos”</p>
<h2 id="data-size"><a class="header" href="#data-size"><strong>Data size</strong></a></h2>
<p>“Hundreds of features”</p>
<ul>
<li>Users: 1B
<ul>
<li>ID</li>
<li>Metadata
<ul>
<li>Demographic features</li>
<li>Device</li>
<li>Geographic region</li>
<li>Device</li>
<li>Gender</li>
<li>Logged-in state</li>
<li>User language</li>
<li>Age</li>
</ul>
</li>
</ul>
</li>
<li>Videos: “million”
<ul>
<li>Video ID</li>
<li>Video metadata (“impression data”)
<ul>
<li>Video language</li>
<li>Thumbnail image</li>
<li>…</li>
</ul>
</li>
</ul>
</li>
<li>User profile
<ul>
<li>Watch history (aggregated from 50 recent videos)</li>
<li>Search history (aggregated from 50 recent searches)</li>
<li>Last search query</li>
<li>Time since last watch</li>
</ul>
</li>
<li>Feedback
<ul>
<li>Implicit
<ul>
<li>Watch (i.e. user completing a video; binary)</li>
</ul>
</li>
<li>Explicit (sparse)
<ul>
<li>Activity history</li>
<li>Thumbs up/down</li>
</ul>
</li>
</ul>
</li>
<li>Age of the training example as a feature*</li>
</ul>
<h2 id="approach"><a class="header" href="#approach"><strong>Approach</strong></a></h2>
<p>2-step approach allows them to make recommendations from a very large corpus of videos, while still being certain that the small number of videos appearing on the device are personalised and engaging for the user.</p>
<p>Predicting the next watched video.</p>
<h2 id="global-video-embedding"><a class="header" href="#global-video-embedding"><strong>Global video embedding</strong></a></h2>
<p>No. of videos to use for embedding is top N by clicked impressions.</p>
<h2 id="candidate-generation"><a class="header" href="#candidate-generation"><strong>Candidate generation</strong></a></h2>
<p>Hybrid though the paper labels it as collaborative filtering. Extreme multiclass classification.</p>
<p><img src="./recsys-14.png" alt="Candidate generation" /></p>
<p>Retrieval (under “tens of milliseconds”)</p>
<ul>
<li>Given a user as input, choose top N classes (videos)</li>
</ul>
<p><strong>Ranking</strong></p>
<p>Logistic regression. Uses “hundreds of features”.</p>
<p><img src="./recsys-15.jpg" alt="YouTube ranking" /></p>
<p>During retrieval, the list of videos is sorted by this score and returned to the user.</p>
<h2 id="metrics-1"><a class="header" href="#metrics-1"><strong>Metrics</strong></a></h2>
<p>Development</p>
<p>During development, precision, recall, ranking loss etc. were used to guide iterative improvements to the models.</p>
<p>Final evaluation</p>
<p>For the final evaluation, A/B testing was used, relying on CTR, watch time, etc. via live experiments.</p>
<h2 id="learnings"><a class="header" href="#learnings"><strong>Learnings</strong></a></h2>
<ul>
<li>Future leak</li>
<li>Surrogate problem
<ul>
<li>Next watched video</li>
</ul>
</li>
<li>Train-test split</li>
<li>Cold-start: demographic features as a prior</li>
<li>Representing a temporal sequence of user actions</li>
</ul>
<p><img src="./recsys-16.jpg" alt="YouTube embedding" /></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="survival-analysis"><a class="header" href="#survival-analysis">Survival analysis</a></h1>
<p>To measure any duration. Time-to-event analysis.</p>
<ul>
<li>How long does this population live for?</li>
<li>How long will a particular customer remain with your business? (After how much time will this customer churn?)</li>
<li>How long will this machine last, after successfully running for a year?</li>
</ul>
<p>Concepts</p>
<ul>
<li>Birth (= start)</li>
<li>Death (= end)</li>
<li>Survival probability</li>
</ul>
<p>At the time of inference, it is not</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="stream-processing"><a class="header" href="#stream-processing">Stream processing</a></h1>
<ul>
<li>Reservoir sampling
<ul>
<li>The first B items are inserted into the reservoir.</li>
<li>Choose one of these items. With probability <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">/</span><span class="mord mathnormal">t</span></span></span></span> where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> is the current time, replace it with the current item in the stream.</li>
</ul>
</li>
</ul>
<blockquote>
<p>💡 This maintains a uniform random sample</p>
</blockquote>
<ul>
<li>(optional material)</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="hyperparameter-optimisation"><a class="header" href="#hyperparameter-optimisation">Hyperparameter optimisation</a></h1>
<ol>
<li>HyperBand and ASHA (Asynchronous Successive ZHalving Algorithm): random + optimise model</li>
<li>Bayesian Optimisation
<ul>
<li>optimal, but public packages aren’t great</li>
</ul>
</li>
<li>Random forest</li>
<li>1cycle policy (learning rate for deep learning tasks)</li>
<li>Population-based training</li>
</ol>
<h2 id="grid-search"><a class="header" href="#grid-search">Grid search</a></h2>
<p>Inefficient</p>
<h2 id="random-search"><a class="header" href="#random-search">Random search</a></h2>
<p>Easy and near optimal</p>
<p>Libraries</p>
<ul>
<li>RayTune</li>
<li>Katib</li>
<li>Hyperas</li>
<li>SIGOPT</li>
<li>Sweeps</li>
<li>Keras Tuner</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="feature-transformation"><a class="header" href="#feature-transformation">Feature transformation</a></h1>
<ul>
<li><a href="feature-transformation.html#why-transform">Why transform?</a></li>
<li><a href="feature-transformation.html#type-transformation">Type transformation</a>
<ul>
<li><a href="feature-transformation.html#categorical-features">Categorical features</a></li>
<li><a href="feature-transformation.html#date-time-features">Date time features</a></li>
</ul>
</li>
<li><a href="feature-transformation.html#numerical-transformation">Numerical transformation</a>
<ul>
<li><a href="feature-transformation.html#min-max-scaling">Min-max scaling</a></li>
<li><a href="feature-transformation.html#standardisation">Standardisation</a></li>
<li><a href="feature-transformation.html#log-scaling">Log scaling</a></li>
<li><a href="feature-transformation.html#feature-clipping">Feature clipping</a></li>
<li><a href="feature-transformation.html#normalisation">Normalisation</a></li>
<li><a href="feature-transformation.html#regular-binning">Regular binning</a></li>
<li><a href="feature-transformation.html#quantile-binning">Quantile binning</a></li>
</ul>
</li>
<li><a href="feature-transformation.html#notes">Notes</a></li>
</ul>
<hr />
<h2 id="why-transform"><a class="header" href="#why-transform">Why transform?</a></h2>
<p>For scaling:</p>
<ul>
<li>The goal of applying feature scaling is to make sure features are on almost the same scale so that each feature is equally important and make it easier to process by most ML algorithms.</li>
<li>Scaling used used for neural networks and distance-based algorithms (eg. k-NN, SVM, NN). If an algorithm is not distance-based, feature scaling is unimportant (eg. Naive Bayes, LDA, tree-based models).</li>
</ul>
<h2 id="type-transformation"><a class="header" href="#type-transformation"><strong>Type transformation</strong></a></h2>
<h3 id="categorical-features"><a class="header" href="#categorical-features"><strong>Categorical features</strong></a></h3>
<ul>
<li>
<p>Ordinal</p>
</li>
<li>
<p>Nominal</p>
<ul>
<li>Drop</li>
</ul>
</li>
<li>
<p>Label encoding: for ordinal variable (with clear ordering)</p>
</li>
<li>
<p>Binary encoding</p>
</li>
<li>
<p>One-hot encoding: for nominal variables (without intrinsic ranking)</p>
<blockquote>
<p>💡 If cardinality is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>, resulting encoding does have to be <em>n</em> new features. It could be <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>, where the last cardinality encodes for absence.</p>
</blockquote>
</li>
<li>
<p>One to many</p>
</li>
<li>
<p>Interaction features (combine)</p>
</li>
<li>
<p>Categorical data: variable that can take a limited no. of values</p>
</li>
<li>
<p>High cardinality = index</p>
</li>
<li>
<p>Embedding</p>
</li>
</ul>
<p>Note on OOV (out-of-vocabulary) bucket: Having an “Others” group will ensure that the categorical transformation is robust to unseen data.</p>
<blockquote>
<p>💡 One-hot encoding categorical features is bad for tree-based models, especially because we create many binary sparse features and from the splitting algorithm’s point of view, they’re all independent. As a result, continuous variables are automatically given higher importance and chosen at the top of the tree to make a split. <a href="https://towardsdatascience.com/step-by-step-guide-to-explaining-your-ml-project-during-a-data-science-interview-81dfaaa408bf">https://towardsdatascience.com/step-by-step-guide-to-explaining-your-ml-project-during-a-data-science-interview-81dfaaa408bf</a></p>
</blockquote>
<h3 id="date-time-features"><a class="header" href="#date-time-features"><strong>Date time features</strong></a></h3>
<p>Inherently cyclic features. Can be treated as embeddings. Example to convert day (1-7) to 2 feature cols:</p>
<pre><code class="language-python">day_sin = np.sin((2*np.pi*col)/max(col))
day_cos = np.cos((2*np.pi*col)/max(col))
</code></pre>
<h2 id="numerical-transformation"><a class="header" href="#numerical-transformation"><strong>Numerical transformation</strong></a></h2>
<h3 id="min-max-scaling"><a class="header" href="#min-max-scaling">Min-max s<strong>caling</strong></a></h3>
<p>Max-Min Normalisation typically allows us to transform the data with varying scales so that no specific dimension will dominate the statistics, and it does not require making a very strong assumption about the distribution of the data</p>
<p><strong>How?</strong></p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8019em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0963em;vertical-align:-0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">a</span><span class="mtight">x</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">i</span><span class="mtight">n</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">i</span><span class="mtight">n</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p><strong>Why?</strong></p>
<p>So that we work with small numbers. The benefits are:</p>
<ul>
<li>Helps gradient descent converge more quickly.</li>
<li>Helps avoid the NaN trap. Certain optimisers might result in NaNs is gradient update is too large.</li>
<li>Helps the model learn appropriate weights for each feature. WIthout it, the model will pay too much attention to features having a wider range.</li>
<li>Certain functions are not stable when dealing with large numbers e.g. softmax</li>
</ul>
<p><strong>When?</strong></p>
<ol>
<li>When feature is approximately uniform</li>
<li>You know the approximate upper and lower bounds</li>
<li>Few outliers</li>
</ol>
<p><strong>Examples</strong></p>
<p>Age</p>
<p><strong>Counter examples</strong></p>
<p>Income</p>
<h3 id="standardisation"><a class="header" href="#standardisation">Standardisation</a></h3>
<p>aka Z-score normalisation, standard scaling</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.9463em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> is the mean of the sample, and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> is the standard deviation of the sample.</p>
<p>Standardization centers the features at mean 0 with a standard deviation 1.</p>
<p>Which is preferred by many algorithms.</p>
<p>Standardization keeps useful information from outliers.</p>
<div id="admonition-note" class="admonition note">
<div class="admonition-title">
<p>Note</p>
<p><a class="admonition-anchor-link" href="feature-transformation.html#admonition-note"></a></p>
</div>
<div>
<p>Standardisation may be used when data follows Gaussian Distribution.</p>
</div>
</div>
<p><strong>When?</strong></p>
<ol>
<li>When the feature distribution does not contain extreme outliers</li>
</ol>
<h3 id="log-scaling"><a class="header" href="#log-scaling"><strong>Log scaling</strong></a></h3>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8019em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span></p>
<p>Note that for small <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> (such that <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4831em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>), using <code>np.log(1+x)</code> means performing <code>np.log(1)</code> which is 0. Using a slightly different transformation below, using <code>np.log1p</code> is more accurate in floating-point accuracy.</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8019em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span></p>
<p><strong>When?</strong></p>
<ol>
<li>When data follows power law distribution</li>
</ol>
<p><strong>Examples</strong></p>
<p>Ratings per movie</p>
<h3 id="feature-clipping"><a class="header" href="#feature-clipping"><strong>Feature clipping</strong></a></h3>
<p><strong>How?</strong></p>
<ol>
<li>By z-score (within 3 standard deviations)</li>
<li>Set min and max</li>
</ol>
<p><strong>When?</strong></p>
<ol>
<li>When there are extreme outliers</li>
</ol>
<h3 id="normalisation"><a class="header" href="#normalisation"><strong>Normalisation</strong></a></h3>
<p>Normalization scales the features to a 0-1 range.</p>
<p>This is a special case of Min-max scaling.</p>
<p>It is useful when we need the data to be in a bounded interval.</p>
<ul>
<li>If Gaussian</li>
<li>Domain knowledge (eg. Height)</li>
</ul>
<div id="admonition-note-1" class="admonition note">
<div class="admonition-title">
<p>Note</p>
<p><a class="admonition-anchor-link" href="feature-transformation.html#admonition-note-1"></a></p>
</div>
<div>
<p>Normalization is great with Non-Gaussian Distribution</p>
</div>
</div>
<div id="admonition-warning" class="admonition warning">
<div class="admonition-title">
<p>Warning</p>
<p><a class="admonition-anchor-link" href="feature-transformation.html#admonition-warning"></a></p>
</div>
<div>
<p>Impact of Outliers is very high in Normalization</p>
</div>
</div>
<h3 id="regular-binning"><a class="header" href="#regular-binning"><strong>Regular binning</strong></a></h3>
<p>Equally spaced boundaries</p>
<p><img src="./feature-transformation-01.png" alt="Regular binning" /></p>
<h3 id="quantile-binning"><a class="header" href="#quantile-binning"><strong>Quantile binning</strong></a></h3>
<p>Each bin has same number of samples</p>
<p><strong>When?</strong></p>
<p>Bimodal / multimodal / uneven distribution</p>
<p><img src="./feature-transformation-02.png" alt="Quantile binning" /></p>
<h2 id="notes"><a class="header" href="#notes">Notes</a></h2>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="feature-selection"><a class="header" href="#feature-selection">Feature selection</a></h1>
<p>Benefits?</p>
<ul>
<li>Reduces overfitting. This allows the model to focus on important features of the data.</li>
<li>Improves the model’s predictions</li>
<li>Reduces computation time</li>
<li>Makes the model more explainable and interpretable</li>
</ul>
<h2 id="filter-methods"><a class="header" href="#filter-methods"><strong>Filter methods</strong></a></h2>
<p>These methods apply a statistical measure to assign a scoring to each feature. The methods are often univariate and consider the feature independently, or with regard to the dependent variable.</p>
<ul>
<li>Chi-squared test (between 2 categorical variables)
<ul>
<li>Measures dependence between stochastic variables</li>
<li>Weeds out features that are most likely to be independent of class and therefore irrelevant for classification</li>
</ul>
</li>
<li>ANOVA / F-test (between a categorical and numerical variable)
<ul>
<li>Estimates the degree of linear dependency between two random variables.</li>
</ul>
</li>
<li>Pearson’s correlation
<ul>
<li>Measures the similarity between two features. Pick the features that have the highest correlation with the response variable.</li>
</ul>
</li>
<li>Variance thresholding
<ul>
<li>The lower the variance, the less information is contained in the feature, the less value it has in predicting the response variable.</li>
</ul>
</li>
</ul>
<h2 id="wrapper-methods"><a class="header" href="#wrapper-methods"><strong>Wrapper methods</strong></a></h2>
<p>These methods compute models with a certain subset of features, and evaluate the importance of each feature.</p>
<ul>
<li>Recursive feature elimination</li>
<li>Forward selection</li>
<li>Backward selection</li>
<li>Stepwise selection</li>
</ul>
<h2 id="embedded-methods"><a class="header" href="#embedded-methods"><strong>Embedded methods</strong></a></h2>
<p>These methods learn which features best contribute to the accuracy of the model while while the model is being created.</p>
<ul>
<li>Lasso and ridge regression</li>
<li>Decision tree
<ul>
<li>The most important features are near the root of the tree</li>
<li>Sklearn’s implementation: feature importance is a function of no. of samples, no. of samples on left, no. of samples on the right, and their respective impurities</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="feature-engineering"><a class="header" href="#feature-engineering">Feature engineering</a></h1>
<p>Process of extracting features from raw data</p>
<ul>
<li>Examples:
<ul>
<li>Feature cross / synthetic feature (formed by crossing two or more features)
Allows one to learn a non-linearity within a linear model</li>
<li>Location vs. distance</li>
<li>Timestamp vs. period</li>
<li>Polynomial features</li>
<li>Unlucky numbers</li>
<li>Metadata</li>
<li>Domain knowledge</li>
</ul>
</li>
</ul>
<p><strong>Missing Values</strong></p>
<ol>
<li>
<p>Drop column/row</p>
</li>
<li>
<p>Impute using mean, median, etc.</p>
<p><img src="./feature-engineering-01.png" alt="Impute using statistic" /></p>
</li>
<li>
<p>Extend imputation</p>
<p><img src="./feature-engineering-02.png" alt="Extend imputation" /></p>
</li>
<li>
<p>Use algorithms that support missing values eg. k-NN</p>
</li>
</ol>
<blockquote>
<p>💡 Missing values can be filled in by looking at the other features that are highly correlated with that column. In pandas, this can be done using a combination of <code>groupby</code> and <code>fillna</code>. Eg. will be a column called Fare which has some missing values. This column is, say, highly correlated with PassengerClass. One would want to group the passengers into their respective PassengerClass first, then take the median as the fill value. Also, think about it from the perspective of an organisation who set the fare: how do you think they would price a ticket? Usually it's based on 1) age, 2) no. of people travelling with you and 3) the kind of service you chose.</p>
</blockquote>
<blockquote>
<p>⚠️ While dealing with missing values, combine both training and test set. Otherwise filled data may overfit to training or test set samples.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="train-test-split-1"><a class="header" href="#train-test-split-1">Train-test split</a></h1>
<p>Data Leakage</p>
<ul>
<li>Target leakage: some predictors are not available at inference time</li>
<li>Train-test contamination</li>
</ul>
<p><strong>Random</strong></p>
<p><strong>Okay when</strong></p>
<ul>
<li>Data doesn’t change much over time</li>
</ul>
<p><strong>Not when</strong></p>
<ul>
<li>Data with burstiness (data arriving in intermittent bursts).</li>
<li>Time series data. Train data will include a “sneak preview” to the test data.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="cross-validation"><a class="header" href="#cross-validation">Cross validation</a></h1>
<p>A way to evaluate the model performance.</p>
<p>Define no. of splits = 5 (5-fold)</p>
<pre><code class="language-python">skf = StratifiedKFold(n_splits=5) # 5-fold
folds = skf.split(X, y)

accuracies = []
for fold in folds:
	model.fit()
	acc = model.score()
	accuracies.append(acc)

mean(accuracies)
</code></pre>
<p><img src="./cross-validation-01.png" alt="Cross validation" /></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="ensembling"><a class="header" href="#ensembling">Ensembling</a></h1>
<p>“Ensemble” here is an umbrella term that trains several models</p>
<ul>
<li><a href="ensembling.html#ensemble-learning">Ensemble learning</a>
<ul>
<li><a href="ensembling.html#simple-bagging">Simple bagging</a></li>
<li><a href="ensembling.html#random-forest">Random forest</a></li>
<li><a href="ensembling.html#extratrees-extremely-randomised-trees">ExtraTrees (Extremely randomised trees)</a></li>
<li><a href="ensembling.html#adaboost">AdaBoost</a></li>
<li><a href="ensembling.html#gbm">GBM</a>
<ul>
<li><a href="ensembling.html#xgboost">XGBoost</a></li>
<li><a href="ensembling.html#lightgbm">LightGBM</a></li>
<li><a href="ensembling.html#histogram-based-gradient-boosting">Histogram-based gradient boosting</a></li>
<li><a href="ensembling.html#catboost">CatBoost</a></li>
<li><a href="ensembling.html#forest-inference-library-by-rapidsai">Forest Inference Library by rapids.ai</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="ensembling.html#simple-ensembling">Simple ensembling</a></li>
<li><a href="ensembling.html#stacking--blending">Stacking &amp; blending</a></li>
</ul>
<hr />
<p><a href="http://www.ccs.neu.edu/home/vip/teach/MLcourse/4_boosting/slides/gradient_boosting.pdf">http://www.ccs.neu.edu/home/vip/teach/MLcourse/4_boosting/slides/gradient_boosting.pdf</a></p>
<h1 id="ensemble-learning"><a class="header" href="#ensemble-learning"><strong>Ensemble learning</strong></a></h1>
<p>Ensemble methods (“bagging” and “boosting” are misnomers):</p>
<ul>
<li>Bagging (“create new models by bagging training sample”)</li>
<li>Boosting (“create new models by boosting a previous model”)</li>
</ul>
<p>Aggregating methods for predictions:</p>
<ul>
<li>Classification
<ul>
<li>Max / majority / hard voting</li>
<li>Soft voting</li>
</ul>
</li>
<li>Regression
<ul>
<li>Average</li>
<li>Weighted</li>
</ul>
</li>
</ul>
<p>“Bagging” = ensemble learning based on bootstrapping (“bootstrap aggregating”)</p>
<p>“Bootstrapping” = sampling technique</p>
<p>“Aggregating” = can mean “bagging” or “boosting” in this context</p>
<p>“Boosting” = a sequential process where each subsequent model attempts to correct the errors of the previous model</p>
<p>OR</p>
<p>ensemble method that seeks to create a strong classifier (model) based on “weak” classifiers</p>
<ul>
<li>How many trg examples to sample</li>
<li>How many features to select</li>
<li>How to select thresholds</li>
<li>When to stop splitting</li>
</ul>
<h2 id="simple-bagging"><a class="header" href="#simple-bagging"><strong>Simple bagging</strong></a></h2>
<p>Individual model: decision tree</p>
<ol>
<li>Sample with replacement 50 training examples (“bagging”)</li>
<li>Train a tree
<ul>
<li>Try a split for:
<ul>
<li>Every feature
<ul>
<li>Every possible threshold in every feature</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Repeat teps 1-2 for 1000 times</li>
<li>Aggregate predictions</li>
</ol>
<h2 id="random-forest"><a class="header" href="#random-forest"><strong>Random forest</strong></a></h2>
<p>Individual model: decision tree</p>
<ol>
<li>Sample with replacement 50 training examples (“bagging”)</li>
<li>Train a tree
<ul>
<li>Try a split for:
<ul>
<li>Every feature in sqrt(p) out of p features (“feature bagging”)
<ul>
<li>Every possible threshold in every feature</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Repeat steps 1-2 for 1000 times</li>
<li>Aggregate predictions</li>
</ol>
<h2 id="extratrees-extremely-randomised-trees"><a class="header" href="#extratrees-extremely-randomised-trees"><strong>ExtraTrees (Extremely randomised trees)</strong></a></h2>
<p>Individual model: decision tree</p>
<ol>
<li>Take all training examples</li>
<li>Train a tree
<ul>
<li>Try a split for:
<ul>
<li>Every feature in sqrt(p) out of p features (“feature bagging”)
<ul>
<li>A random point (uniform distribution) in every feature</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Repeat steps 1-2 1000 times</li>
<li>Aggregate predictions</li>
</ol>
<h2 id="adaboost"><a class="header" href="#adaboost"><strong>AdaBoost</strong></a></h2>
<p>AKA Adaptive Boosting</p>
<p>Individual model: decision tree</p>
<p>Quasi gradient boost with weights</p>
<ul>
<li>Depth</li>
<li>Weight of datapoint</li>
<li>Amount_of_say</li>
</ul>
<p>The idea is to set weights to classifiers and samples in a way that forces classifiers to concentrate on observations that are too difficult to correctly classify</p>
<ol>
<li>Initialise weights of each data point. If there are 100 data points, each point is 0.01</li>
<li>Sample with replacement all training examples (same size)
<ul>
<li>Using the weights as categorical distribution of choosing data</li>
<li>Then reset weights</li>
</ul>
</li>
<li>Train a tree with depth=2</li>
<li>Calculate this tree’s final say during aggregation
<ul>
<li>Error rate, e = ???</li>
<li>Say = 1/2 log ((1-e)/e)</li>
</ul>
</li>
<li>Update weights
<ul>
<li>If correct, (almost) no change</li>
<li>if wrong, new weight = old weight * exp(say)</li>
</ul>
</li>
<li>Normalise weights</li>
<li>Repeat 1000 times (from step 2)</li>
<li>Aggregate predictions using amount_of_say (do weighted sum)</li>
</ol>
<h2 id="gbm"><a class="header" href="#gbm"><strong>GBM</strong></a></h2>
<p>Gradient Boosting</p>
<p>Individual model: decision tree</p>
<ol>
<li>
<p>Sample with replacement (&quot;bagging&quot;)</p>
</li>
<li>
<p>Train a tree</p>
<ul>
<li>Try a split for:
<ul>
<li>Every feature ?
<ul>
<li>Every point?</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>by fitting model</p>
<ol>
<li>pred_y = tree1.predict(data)</li>
<li>residual_error_1 = actual_y - pred_y</li>
<li>tree2.fit(residual_error_1)</li>
</ol>
</li>
<li>
<p>Repeat steps 1-2 for 1000 times.</p>
</li>
</ol>
<p>Boosting trees sequentially add predictors and corrects previous models. This method fits the new model to new residuals of the previous prediction and then minimises the loss when adding the latest prediction.</p>
<h3 id="xgboost"><a class="header" href="#xgboost"><strong>XGBoost</strong></a></h3>
<p>Optimisations</p>
<ol>
<li>To find thresholds, they use pre-sort-based algorithm
<ul>
<li>Using a subset of data available the node, bin features into histograms</li>
</ul>
</li>
</ol>
<h3 id="lightgbm"><a class="header" href="#lightgbm"><strong>LightGBM</strong></a></h3>
<p>Optimisations</p>
<ol>
<li>To find thresholds, they use histogram-based algorithm which buckets continuous features.</li>
<li>Build tree in depth-first.</li>
<li>Improved split strategy.</li>
<li>Improved splitting for categorical features.</li>
<li>Supports NaNs.</li>
</ol>
<h3 id="histogram-based-gradient-boosting"><a class="header" href="#histogram-based-gradient-boosting"><strong>Histogram-based gradient boosting</strong></a></h3>
<p>Optimisations</p>
<ol>
<li>To find thresholds, they use histogram-based algorithm which buckets continuous features. Faster than normal for n_samples &gt; 10,000.</li>
<li>Native support for NaNs.</li>
</ol>
<h3 id="catboost"><a class="header" href="#catboost"><strong>CatBoost</strong></a></h3>
<p>Optimisations</p>
<ol>
<li>To find thresholds, they use histogram-based algorithm which buckets continuous features.</li>
</ol>
<h3 id="forest-inference-library-by-rapidsai"><a class="header" href="#forest-inference-library-by-rapidsai">Forest Inference Library by rapids.ai</a></h3>
<h1 id="simple-ensembling"><a class="header" href="#simple-ensembling"><strong>Simple ensembling</strong></a></h1>
<p>Aggregate predictions of different models</p>
<h1 id="stacking--blending"><a class="header" href="#stacking--blending"><strong>Stacking &amp; blending</strong></a></h1>
<p>Everyone says different things.</p>
<p><strong>Meta-meta-estimator</strong></p>
<p><strong>Blending</strong></p>
<p>Linear combination of predictors</p>
<p><strong>Neural network estimator ish</strong></p>
<p><img src="./ensembling-01.png" alt="Estimator" /></p>
<p>Stacking and blending differ by the type of folds in the cross validation used during training of each layer</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="eda-1"><a class="header" href="#eda-1">EDA++</a></h1>
<h2 id="skewness"><a class="header" href="#skewness">Skewness</a></h2>
<p>Measures symmetry of distribution</p>
<pre><code class="language-python">df[col].skew()
</code></pre>
<ul>
<li>Skewness = 0: symmetric</li>
<li>Skewness &gt; 0: longer right tail</li>
<li>Skewness &lt; 0: longer left tail</li>
</ul>
<h2 id="kurtosis"><a class="header" href="#kurtosis">Kurtosis</a></h2>
<p>Measures heaviness of distribution tails. </p>
<p><strong>Excess kurtosis</strong> is a metric that compares the kurtosis of a distribution against the kurtosis of a normal distribution (kurtosis=3).</p>
<pre><code class="language-python">df[col].kurtosis()
</code></pre>
<p>Excess kurtosis = Kurtosis - 3</p>
<ul>
<li>
<p>Excess kurtosis close to 0 (normal)</p>
<p><img src="./eda-plus-plus-01.png" alt="Excess kurtosis close to 0" /></p>
</li>
<li>
<p>Excess kurtosis &gt;&gt; 0</p>
<p><img src="./eda-plus-plus-02.png" alt="Excess kurtosis more than 0" /></p>
</li>
<li>
<p>Excess kurtosis &lt;&lt; 0</p>
<p><img src="./eda-plus-plus-03.png" alt="Excess kurtosis smaller than 0" /></p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="tests"><a class="header" href="#tests">Tests</a></h1>
<ul>
<li><a href="tests.html#correlation">Correlation</a>
<ul>
<li><a href="tests.html#categorical-vs-categorical">Categorical vs. categorical</a></li>
<li><a href="tests.html#categorical-vs-numerical">Categorical vs. numerical</a></li>
<li><a href="tests.html#numerical-vs-numerical">Numerical vs. numerical</a></li>
</ul>
</li>
<li><a href="tests.html#pps">PPS</a></li>
<li><a href="tests.html#distribution">Distribution</a></li>
<li><a href="tests.html#normality">Normality</a></li>
<li><a href="tests.html#multicollinearity">Multicollinearity</a>
<ul>
<li><a href="tests.html#variance-inflation-factor">Variance inflation factor</a></li>
</ul>
</li>
</ul>
<hr />
<h2 id="correlation"><a class="header" href="#correlation">Correlation</a></h2>
<blockquote>
<p>💡 Information about features with high correlation can be useful when filling missing values.</p>
</blockquote>
<h3 id="categorical-vs-categorical"><a class="header" href="#categorical-vs-categorical">Categorical vs. categorical</a></h3>
<ul>
<li>
<p>Cramér's V</p>
<p>A measure of association between two nominal variables (0 to 1). It is based on Pearson's chi-squared statistic.</p>
<p><a href="https://datascience.stackexchange.com/questions/893/how-to-get-correlation-between-two-categorical-variable-and-a-categorical-variab">https://datascience.stackexchange.com/questions/893/how-to-get-correlation-between-two-categorical-variable-and-a-categorical-variab</a></p>
</li>
<li>
<p>Chi-square test / Pearson's chi-square test</p>
<p>Assume two variables are independent and follows the uniform distribution.</p>
</li>
</ul>
<h3 id="categorical-vs-numerical"><a class="header" href="#categorical-vs-numerical">Categorical vs. numerical</a></h3>
<ul>
<li>Correlation Ratio</li>
<li>One-way ANOVA test</li>
</ul>
<h3 id="numerical-vs-numerical"><a class="header" href="#numerical-vs-numerical">Numerical vs. numerical</a></h3>
<p>Pearson's correlation</p>
<p><code>df.corr()</code></p>
<h2 id="pps"><a class="header" href="#pps">PPS</a></h2>
<p>Predictive Power Score.</p>
<p>Score 0 = no linear/nonlinear predictive relationship</p>
<p>Score 1 = strong linear/nonlinear predictive relationship</p>
<p>Expect to find:</p>
<ul>
<li>Best univariate predictor</li>
<li>Linear or nonlinear relationships</li>
</ul>
<h2 id="distribution"><a class="header" href="#distribution">Distribution</a></h2>
<p>Distribution across features between train and test set!</p>
<p><img src="./tests-01.png" alt="Distribution" /></p>
<p>One potential problem for both features is, the distribution has more spikes and bumps in training set, but it is smoother in test set. Model may not be able to generalize to test set because of this reason.</p>
<h2 id="normality"><a class="header" href="#normality">Normality</a></h2>
<ul>
<li>Histogram (eyeball)</li>
<li>QQ plot (eyeball)</li>
<li>Shapiro-Wilk</li>
<li>Kolmogorov-Smirnov</li>
</ul>
<pre><code class="language-python">from scipy.stats import kstest, norm
my_data = norm.rvs(size=1000)
ks_statistic, p_value = kstest(my_data, 'norm')
print(ks_statistic, p_value)
</code></pre>
<h2 id="multicollinearity"><a class="header" href="#multicollinearity">Multicollinearity</a></h2>
<p>Multicollinearity occurs when there is a high correlation between the independent variables.</p>
<h3 id="variance-inflation-factor"><a class="header" href="#variance-inflation-factor">Variance inflation factor</a></h3>
<p>This metric quantifies the severity of multicollinearity in an ordinary least squares regression analysis.</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="ml-system-design"><a class="header" href="#ml-system-design">ML system design</a></h1>
<ul>
<li><a href="ml-system-design.html#0-overview">0. Overview</a></li>
<li><a href="ml-system-design.html#1-project-setup--problem-framing">1. Project setup / problem framing</a></li>
<li><a href="ml-system-design.html#2-data-collection">2. Data collection</a></li>
<li><a href="ml-system-design.html#3-exploration">3. Exploration</a></li>
<li><a href="ml-system-design.html#4-preprocessing">4. Preprocessing</a></li>
<li><a href="ml-system-design.html#5-modelling">5. Modelling</a></li>
<li><a href="ml-system-design.html#6-reporting--documentation">6. Reporting / documentation</a></li>
<li><a href="ml-system-design.html#7-production--code">7. Production &amp; code</a></li>
<li><a href="ml-system-design.html#client-speak">Client speak</a></li>
<li><a href="ml-system-design.html#resources">Resources</a></li>
</ul>
<hr />
<h2 id="0-overview"><a class="header" href="#0-overview">0. <strong>Overview</strong></a></h2>
<p>Intelligence = can process information, and inform future decisions</p>
<ul>
<li>AI: Make machines solve problems associated with human intelligence. Anything that can make computers mimic human behaviour</li>
<li>Machine Learning: Make machines learn (from experience) instead of explicit programming</li>
<li>Deep Learning: Make machines extract information / patterns using neural networks</li>
</ul>
<p>From chiphuyen:</p>
<ol>
<li>project setup</li>
<li>data pipeline</li>
<li>modelling and training</li>
<li>serving</li>
</ol>
<p><a href="https://docs.google.com/spreadsheets/d/1OV0cMh2lmXMU9bK8qv1Kk0oWdc_Odmu2K5sOULS9hHQ/edit#gid=0">list of mlops tools</a> by chip huynr</p>
<h2 id="1-project-setup--problem-framing"><a class="header" href="#1-project-setup--problem-framing"><strong>1. Project setup / problem framing</strong></a></h2>
<ul>
<li>Motivation
<ul>
<li>What is the current pain point?</li>
</ul>
</li>
<li>Goals
<ul>
<li>What do you want to achieve with this problem?</li>
</ul>
</li>
<li>Background information</li>
<li>Definitions</li>
<li>End-user experience
<ul>
<li>A walkthrough of how end users are supposed to use the system.</li>
</ul>
</li>
<li>Performance constraints (speed &amp; accuracy)
<ul>
<li>How good &amp; fast must the prediction be?
<ul>
<li>High-frequency trading requires very fast predictions</li>
<li>What’s more important - precision or recall?</li>
<li>What’s more costly: FN or FP?</li>
</ul>
</li>
</ul>
</li>
<li>Evaluation
<ul>
<li>What metrics do you use to evaluate your system during training and inference?</li>
</ul>
</li>
<li>Project constraints
<ul>
<li>Hardware</li>
<li>Working environment</li>
</ul>
</li>
<li>Developer tools
<ul>
<li>Workflow orchestration
<ul>
<li>Luigi</li>
<li>Airflow</li>
</ul>
</li>
<li>Experiment management
<ul>
<li>Tensorboard</li>
<li>MLFlow</li>
<li>Weights &amp; Biases</li>
</ul>
</li>
</ul>
</li>
<li>Foresight
<ul>
<li>What is the final environment in which the code will be run?</li>
<li>Where would you see the model in 5 years?</li>
</ul>
</li>
</ul>
<h2 id="2-data-collection"><a class="header" href="#2-data-collection"><strong>2. Data collection</strong></a></h2>
<ul>
<li>Data sources
<ul>
<li>Open source</li>
<li>Data augmentation (CV)</li>
<li>Synthetic data (esp. NLP)</li>
</ul>
</li>
<li>Data collection
<ul>
<li>Data okay? Is the data noisy? Need to go back to client? Limitations? Features you think you can get from client?</li>
<li>Questions you might ask the client</li>
<li>Interesting things you did not find</li>
<li>Potential bias?</li>
</ul>
</li>
<li>Data storage
<ul>
<li>Database (eg. Postgres)</li>
<li>Object store. Stores binary data (eg. S3)</li>
<li>Data lake. Aggregates features not obtainable from database like logs</li>
<li>Feature store. Stores ML features (eg. FEAST, Michaelangelo)</li>
</ul>
</li>
<li>Representation</li>
<li>Challenges
<ul>
<li>Distribution</li>
<li>Privacy</li>
<li>Biases</li>
</ul>
</li>
</ul>
<h2 id="3-exploration"><a class="header" href="#3-exploration"><strong>3. Exploration</strong></a></h2>
<p><a href="https://www.notion.so/Data-visualisation-1db4e8e621844ea2a73a521ff3379393">Data visualisation</a></p>
<ul>
<li>Clustering</li>
<li>Dimensionality reduction</li>
</ul>
<h2 id="4-preprocessing"><a class="header" href="#4-preprocessing"><strong>4. Preprocessing</strong></a></h2>
<p>Feature engineering</p>
<p>Feature transformation</p>
<p>Feature selection</p>
<p>Train-test split</p>
<p>Synthetic data augmentation*</p>
<h2 id="5-modelling"><a class="header" href="#5-modelling"><strong>5. Modelling</strong></a></h2>
<ul>
<li>Model selection
<ul>
<li>Baselines: random, human, simple heuristic</li>
<li>Assumptions and considerations</li>
<li><strong>Transfer learning</strong> 📦</li>
<li><strong>Weight initialisation</strong> 📦</li>
<li><strong>Layers</strong> 📦</li>
</ul>
</li>
<li><strong>Improving predictive power</strong>🧪
<ul>
<li>Regularisation</li>
<li><strong>Hyperparameter tuning</strong>🧪, <strong>Hyperparameter tuning</strong> 📦</li>
<li><strong>Ensemble learning</strong>🧪</li>
<li>Loss function</li>
<li>Correcting datapoints^</li>
</ul>
</li>
<li><strong>Improving speed</strong> 📦</li>
<li>Scaling*
<ul>
<li>Model parallelism</li>
<li>Data parallelism</li>
</ul>
</li>
<li>Model evaluation
<ul>
<li>Cross validation^</li>
<li><strong>Bias and variance</strong>🧪^</li>
</ul>
</li>
</ul>
<h2 id="6-reporting--documentation"><a class="header" href="#6-reporting--documentation"><strong>6. Reporting / documentation</strong></a></h2>
<ul>
<li><strong>Explainability, interpretability &amp; biasness</strong>🧪
<ul>
<li>Feature importance</li>
</ul>
</li>
<li>Evaluation metrics</li>
<li>Inference speed</li>
<li>Model confidence</li>
<li>Misuses</li>
<li>Ablation studies</li>
<li>Visualisations</li>
</ul>
<h2 id="7-production--code"><a class="header" href="#7-production--code"><strong>7. Production &amp; code</strong></a></h2>
<ul>
<li>
<p>Data</p>
<ul>
<li>Continual collection</li>
<li>Versioning
<ul>
<li>DVC</li>
<li>Pachyderm</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Software</p>
<ul>
<li>Correctness of code</li>
</ul>
</li>
<li>
<p>Production environment</p>
</li>
<li>
<p>Model</p>
<ul>
<li>Outdated - retrain</li>
<li>Biased - need to train with data privacy</li>
</ul>
</li>
<li>
<p>Tests</p>
<ul>
<li><a href="https://eugeneyan.com/writing/testing-ml/">https://eugeneyan.com/writing/testing-ml/</a></li>
</ul>
</li>
</ul>
<h2 id="client-speak"><a class="header" href="#client-speak"><strong>Client speak</strong></a></h2>
<p>I want 5% more accuracy</p>
<ul>
<li>Maybe we can look at a different metric</li>
<li>What does 5% mean to the business?</li>
<li>“I want 100% accuracy.”</li>
<li>“I want to increase accuracy.”</li>
</ul>
<h2 id="resources-1"><a class="header" href="#resources-1">Resources</a></h2>
<p>Chip Huyen’s Machine Learning Systems Design</p>
<p>Production Level Tech Stack</p>
<p>Google’s Machine Learning Crash Course Problem Framing</p>
<p>Machine Learning in Python: Main developments and technology trends in data science, machine learning, and artificial intelligence</p>
<p><a href="https://github.com/eugeneyan/applied-ml">https://github.com/eugeneyan/applied-ml</a></p>
<p><a href="https://github.com/ahkarami/Deep-Learning-in-Production">https://github.com/ahkarami/Deep-Learning-in-Production</a></p>
<p><a href="https://course.fullstackdeeplearning.com/">https://course.fullstackdeeplearning.com</a></p>
<p><a href="https://huyenchip.com/machine-learning-systems-design/toc.html">https://huyenchip.com/machine-learning-systems-design/toc.html</a></p>
<p><a href="https://towardsdatascience.com/architecting-a-machine-learning-pipeline-a847f094d1c7">https://towardsdatascience.com/architecting-a-machine-learning-pipeline-a847f094d1c7</a></p>
<p><a href="https://becominghuman.ai/machine-learning-system-design-f2f4018f2f8">https://becominghuman.ai/machine-learning-system-design-f2f4018f2f8</a></p>
<p><a href="https://www.theinsaneapp.com/2021/03/system-design-and-recommendation-algorithms.html?m=1">https://www.theinsaneapp.com/2021/03/system-design-and-recommendation-algorithms.html?m=1</a></p>
<p><a href="https://towardsdatascience.com/how-to-answer-any-machine-learning-system-design-interview-question-a98656bb7ff0">https://towardsdatascience.com/how-to-answer-any-machine-learning-system-design-interview-question-a98656bb7ff0</a></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="metrics-2"><a class="header" href="#metrics-2">Metrics</a></h1>
<h2 id="auc"><a class="header" href="#auc">AUC</a></h2>
<p><a href="https://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5">https://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5</a></p>
<p><a href="https://towardsdatascience.com/an-interesting-and-intuitive-view-of-auc-5f6498d87328">https://towardsdatascience.com/an-interesting-and-intuitive-view-of-auc-5f6498d87328</a></p>
<p>AUC is a ranking metric. What matters is the score order, not the score value itself.</p>
<ul>
<li>How much a model is capable of distinguishing between classes. 
AUC 1 means it has good measure of separability
AUC 0 means it is predicting cats as dogs and dogs as cats. 
AUC 0.5 means it is not capable of distinguishing between classes.</li>
</ul>
<blockquote>
<p>💡 <strong>AUC = 0.7</strong>
There is a 70% chance that the model will be able to distinguish between positive and negative class.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="bonus-questions"><a class="header" href="#bonus-questions">Bonus questions</a></h1>
<Inherits from ML systems design>
<p><a href="https://medium.com/@ProfessorF/visualizing-the-solution-to-the-monty-hall-problem-bf4a08c8ed8f">https://medium.com/@ProfessorF/visualizing-the-solution-to-the-monty-hall-problem-bf4a08c8ed8f</a></p>
<p>Even though there’s a science bit in data science theres still a gap between what is</p>
<p>taught and what is practised.</p>
<p>It is important for us to have practical knowledge to see the gaps in our theoretical understanding.</p>
<p>Sparsity? Consumes more memory</p>
<p><a href="https://www.linkedin.com/posts/activity-6675719025265381376-8lSN/">Hariz Liew posted on LinkedIn</a></p>
<ul>
<li>
<p>I observed 20 cloudy days. I also observed 5 rainy days. What's the probability of rain given that it is cloudy?</p>
<p>1/4. Can also use Bayes' rule.</p>
</li>
</ul>
<h2 id="1-project-setup"><a class="header" href="#1-project-setup"><strong>1. Project setup</strong></a></h2>
<h2 id="2-data-collection-1"><a class="header" href="#2-data-collection-1"><strong>2. Data collection</strong></a></h2>
<p>If you had to prioritise improving one of the areas below in your machine learning project, which would have the most impact?</p>
<p>Quality and size of data</p>
<p>A deeper network</p>
<p>Using the latest optimisation algorithm</p>
<p>A more clever loss function</p>
<h2 id="3-exploration-1"><a class="header" href="#3-exploration-1"><strong>3. Exploration</strong></a></h2>
<p>Why must we continually visualise?</p>
<h2 id="4-preprocessing-1"><a class="header" href="#4-preprocessing-1"><strong>4. Preprocessing</strong></a></h2>
<p>Transforming time data</p>
<p>What do you do with long-tailed</p>
<p>How to split train and test? Stratify</p>
<p>why do we do feature selection?</p>
<p>Why must we transform?</p>
<p>The pros and cons of one-hot encoding</p>
<p>One-hot encoding: LightGBM</p>
<p>It is common to represent categorical features with one-hot encoding, but this approach is suboptimal for tree learners. Particularly for high-cardinality categorical features, a tree built on one-hot features tends to be unbalanced and needs to grow very deep to achieve good accuracy.</p>
<p>One-hot encoding: CatBoost</p>
<p>Do not use one-hot encoding during preprocessing. This affects both the training speed and the resulting quality.</p>
<p>What if I have high cardinality category?</p>
<p>Look at the cardinality. If it’s 80% of the training examples, then this is probably not a feature but indexes the examples.</p>
<p>Why do we bootstrap samples???</p>
<h2 id="5-modelling-1"><a class="header" href="#5-modelling-1"><strong>5. Modelling</strong></a></h2>
<ul>
<li>
<p>Why do a forest of weak learners learn well?</p>
</li>
<li>
<p>Can loss decomposition be used to compare models?</p>
</li>
<li>
<p>When to choose L1 and L2?</p>
</li>
<li>
<p>Why not use linear regression in place of logistic regression?</p>
<p>It is not robust to outliers in the data.</p>
</li>
<li>
<p>What is the perceptron in MLP? What is an MLP?</p>
<p><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/26f3a50d-5027-429a-9845-fed35827d64b/Untitled.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/26f3a50d-5027-429a-9845-fed35827d64b/Untitled.png" /></p>
<p>A perception is a simple binary classification algorithm. It takes in a few inputs, each of which has a weight, and generates an output decision of &quot;0&quot; or &quot;1&quot;.</p>
<p>An MLP is a perceptron that teams up with additional perceptrons.</p>
</li>
<li>
<p>What is decision boundary?</p>
<p>Decision boundary helps to differentiate probabilities into positive and negative class.</p>
</li>
<li>
<p>Why is cross validation not done on DL models?</p>
<p>Expensive</p>
</li>
<li>
<p>What is overfitting?</p>
<p>Overfitting = The model approximates the data/observation, which is true model and noise</p>
<p>Good fit = The model approximates true model</p>
<p>Underfitting = The model does not approximate true model</p>
</li>
<li>
<p>What happens if I have class imbalance for the test set? What should I use?</p>
<p>Use a confusion matrix because it lets you see the overall performance.</p>
</li>
<li>
<p>Accuracy for train set is higher than test set. Why?</p>
<p>Overfitting. This is due to </p>
<ol>
<li>different distributions of data between the train and test. </li>
<li>model is too powerful</li>
</ol>
</li>
</ul>
<h2 id="6-reporting"><a class="header" href="#6-reporting"><strong>6. Reporting</strong></a></h2>
<h2 id="7-production"><a class="header" href="#7-production"><strong>7. Production</strong></a></h2>
<ul>
<li>What do you know about A/B testing in the context of streaming?</li>
<li>What are the differences between L1 and L2 regularization, why don’t people use L0.5 regularization for instance?</li>
<li>What is the difference between online and batch gradient descent?</li>
<li>What is the best way to communicate ML results to stakeholders?</li>
<li>Write the equation for building a classifier using Logistic Regression.</li>
<li>Given a month’s worth of login data from Netflix such as account_id, device_id, and metadata concerning payments, how would you detect payment fraud?</li>
<li>How would you design an experiment for a new content recommendation model we’re thinking of rolling out? What metrics would matter?</li>
<li>Write SQL queries to find a time difference between two events.</li>
<li>How would you build and test a metric to compare two users’s ranked lists of movie/tv show preferences?</li>
<li>How would you select a representative sample of search queries from five million?</li>
<li>Why is Rectified Linear Unit a good activation function?</li>
<li>If Netflix is looking to expand its presence in Asia, what are some factors that you can use to evaluate the size of the Asia market, and what can Netflix do to capture this market?</li>
<li>How would we approach to attribution modeling to measure marketing effectiveness?</li>
<li>How would you determine if the price of a Netflix subscription is truly the deciding factor for a consumer?</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="bias-variance-decomposition"><a class="header" href="#bias-variance-decomposition">Bias-variance decomposition</a></h1>
<p><img src="./bias-variance-decomposition-01.png" alt="High/low bias variance" /></p>
<p><a href="https://scikit-learn.org/stable/auto_examples/ensemble/plot_bias_variance.html#sphx-glr-auto-examples-ensemble-plot-bias-variance-py">https://scikit-learn.org/stable/auto_examples/ensemble/plot_bias_variance.html#sphx-glr-auto-examples-ensemble-plot-bias-variance-py</a></p>
<p><a href="http://rasbt.github.io/mlxtend/user_guide/evaluate/bias_variance_decomp/">http://rasbt.github.io/mlxtend/user_guide/evaluate/bias_variance_decomp/</a></p>
<p><strong>Should use comparative adjectives like “larger bias”</strong></p>
<h1 id="why-learn-about-bias-and-variance-decomposition"><a class="header" href="#why-learn-about-bias-and-variance-decomposition"><strong>Why learn about bias and variance decomposition?</strong></a></h1>
<p>A useful property of the mean squared error is that its expectation can be easily decomposed into bias and variance, which can be used to explain underfitting and overfitting. These values, although requiring true values, can be estimated, and give meaning to “closeness to true model” and “generalisability“.</p>
<h1 id="what-is"><a class="header" href="#what-is"><strong>What is?</strong></a></h1>
<p>Expected MSE = Bias^2 + Variance + Var(noise)</p>
<h1 id="bias"><a class="header" href="#bias"><strong>Bias</strong></a></h1>
<p>How different is our prediction and the real prediction, on average over bootstrap samples?</p>
<p>“Closeness to true model”</p>
<p>“Predictive power”</p>
<p>What we want is to see that these predictions are close to the true prediction across subsamples (“unseen data”) and different x inputs.</p>
<h1 id="variance"><a class="header" href="#variance"><strong>Variance</strong></a></h1>
<p>How varied are our predictions, on average over bootstrap samples?</p>
<p>“Varying predictions across different subsamples“</p>
<p>“Generalisability”</p>
<p>“Consistency”</p>
<p>If this value is high, it means that, on the extreme case, all samples are very different from one another. One most plausible reason for this is that the model is overfitted to the dataset. What we want is to see that these predictions are consistently different (from the mean) across subsamples (“unseen data”) and different x inputs.</p>
<h1 id="variance-of-noise"><a class="header" href="#variance-of-noise"><strong>Variance of noise</strong></a></h1>
<p>Irreducible part of the error, due to the variability in the data. Errors in measurement (“data collection”) can be tolerated, but inconsistent measurement errors cannot (?).</p>
<h1 id="case-study-single-vs-bagging"><a class="header" href="#case-study-single-vs-bagging"><strong>Case study: Single vs. Bagging</strong></a></h1>
<p>Dark blue = model</p>
<p>Dark blue dotted = data = model + noise</p>
<p>Dark red = one fitted tree, trained over a training sample</p>
<p>Light red = other trees, trained over other and different randomly drawn instances of training samples</p>
<p>Cyan = Average of the estimators</p>
<ol>
<li>Variance: How varied are the vertical width of light red (see x=2.4)</li>
<li>Bias: Difference between cyan and dark blue.</li>
</ol>
<p>Top left:</p>
<p>Cyan ≈ dark blue -&gt; low bias</p>
<p>Tall vertical shaded light reds -&gt; large variance</p>
<p>Top right:</p>
<p>Cyan further from dark blue -&gt; larger bias, see x=2.4</p>
<p>Shorter vertical shaded light reds -&gt; lower variance</p>
<p>Workflow:</p>
<ol>
<li>Calculate MSE to confirm intuition.</li>
<li>Conclusion: <strong>The tradeoff is better for bagging</strong> because averaging several decision trees fit on bootstrap copies
<ol>
<li>Slightly increases the bias term, but</li>
<li>Allows for a larger reduction of variance</li>
</ol>
</li>
<li>Which results in a lower overall mean squared error.</li>
</ol>
<h1 id="libraries-1"><a class="header" href="#libraries-1"><strong>Libraries</strong></a></h1>
<p>from mlxtend.evaluate import bias_variance_decomp</p>
<p><img src="./bias-variance-decomposition-02.png" alt="Bias variance decomposition" /></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="rare-event-classification--anomaly-detection"><a class="header" href="#rare-event-classification--anomaly-detection">Rare event classification / anomaly detection</a></h1>
<p>Severe class imbalance (1% positive)</p>
<h2 id="methods-1"><a class="header" href="#methods-1"><strong>Methods</strong></a></h2>
<h3 id="at-the-data-level"><a class="header" href="#at-the-data-level"><strong>At the data level</strong></a></h3>
<ol>
<li>Over-sampling of minority class
<ul>
<li><strong>Naive random oversampling</strong> (with replacement). The augmented data should be used instead of the original data.</li>
<li><strong>SMOTE</strong> (Synthetic Minority Oversampling Technique). Generate new samples by interpolation. No major benefits (Andreas Muller, empirical data).</li>
<li>Overfitting</li>
</ul>
</li>
<li>Under-sampling of majority class
<ul>
<li>Naive discarding</li>
<li>Prototype generation</li>
<li>Prototype selection
<ul>
<li>Controlled techniques</li>
<li>Cleaning techniques</li>
</ul>
</li>
</ul>
</li>
<li>Over-sampling + cleaning under-sampling that removes extreme outliers in majority class</li>
<li>Ensemble of samplers
<ul>
<li>Random forest, each tree given a balanced bootstrap sample</li>
<li>etc.</li>
</ul>
</li>
</ol>
<h3 id="at-the-classifier-level"><a class="header" href="#at-the-classifier-level"><strong>At the classifier level</strong></a></h3>
<ul>
<li>Weight balancing in loss function. Take inverse of no. of samples for each class.</li>
<li>Thresholding / threshold moving / post scaling</li>
<li>Cost sensitive learning</li>
<li>One-class classification / one-class random forest</li>
<li>Focal loss</li>
<li>Gaussian Mixture Model</li>
<li>Auto-encoder</li>
</ul>
<h3 id="adaptive"><a class="header" href="#adaptive"><strong>Adaptive</strong></a></h3>
<ul>
<li><strong>ADASYN</strong> <strong>sampling</strong> (Adaptive Synthetic). Generate new samples by next to original samples which are wrongly classified using a k-NN classifier.</li>
</ul>
<h2 id="commonly-used-metrics"><a class="header" href="#commonly-used-metrics"><strong>Commonly used metrics</strong></a></h2>
<ul>
<li>NOT ACCURACY (Andreas Muller)</li>
<li>NOT AUC ROC (Andreas Muller)</li>
</ul>
<h2 id="libraries-2"><a class="header" href="#libraries-2"><strong>Libraries</strong></a></h2>
<p>imbalanced-learn from scikit-contrib</p>
<p>sheet-breaks and machine failure in manufacturing, clicks or purchase in an online industry..</p>
<p>Similar to anomaly detection. In anomaly detection, we learn the pattern of a normal process. Anything that does not follow this pattern is classified as an anomaly. For a binary classification of rare events, we can use a similar approach using autoencoders</p>
<p>Use dense autoencoder or LSTM autoencoder.</p>
<h2 id="how-to-use-an-autoencoder-rare-event-classification"><a class="header" href="#how-to-use-an-autoencoder-rare-event-classification"><strong>How to use an Autoencoder rare-event classification?</strong></a></h2>
<ul>
<li>We will divide the data into two parts: positively labeled and negatively labeled.</li>
<li>The negatively labeled data is treated as normal state of the process. A normal state is when the process is eventless.</li>
<li>We will ignore the positively labeled data, and train an Autoencoder on only negatively labeled data.</li>
<li>This Autoencoder has now learned the features of the normal process.</li>
<li>A well-trained Autoencoder will predict any new data that is coming from the normal state of the process (as it will have the same pattern or distribution).</li>
<li>Therefore, the reconstruction error will be small.</li>
<li>However, if we try to reconstruct a data from a rare-event, the Autoencoder will struggle.</li>
<li>This will make the reconstruction error high during the rare-event.</li>
<li>We can catch such high reconstruction errors and label them as a rare-event prediction.</li>
<li>This procedure is similar to anomaly detection methods.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="blas"><a class="header" href="#blas">BLAS</a></h1>
<p>Basic Linear Algebra Subprograms</p>
<p>The low-level part of the computer’s system that is responsible for efficiently performing numerical linear algebra</p>
<p>Implementations</p>
<p>⁃	Intel MKL (Math Kernel Library)</p>
<p>⁃	OpenBLAS</p>
<p>⁃	ATLAS (Automatically Tuned Linear Algebra Software)</p>
<p>⁃	AMD Core Math Library (ACML)</p>
<p>LAPACK (Linear Algebra Package)</p>
<p>NumPy</p>
<p>MATLAB</p>
<p>R</p>
<p>S - short-precision real (float32)</p>
<p>D - double-precision real (float64/double)</p>
<p>C - short-precision complex</p>
<p>Z - long-precision complex</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="coursera"><a class="header" href="#coursera">Coursera</a></h1>
<p><img src="./coursera-01.png" alt="Overview" /></p>
<h1 id="bonus-questions-1"><a class="header" href="#bonus-questions-1">Bonus questions</a></h1>
<ul>
<li>
<p>What is convergence?</p>
<p>The process of getting close to an answer</p>
</li>
<li>
<p>What is a loss function?</p>
<p>Measures how far you are from the current guess</p>
</li>
<li>
<p>What does the optimiser do?</p>
<p>Generates a new and improved guess</p>
</li>
<li>
<p>Why split data into training and test?</p>
<p>To test a model with previously unseen data</p>
</li>
<li>
<p>Why is overfitting more likely to occur on smaller datasets?</p>
<p>Because there's less likelihood of all possible features being encountered in the training process.</p>
</li>
<li>
<p>Why is the validation accuracy a better indicator of model performance than training accuracy?</p>
<p>The validation accuracy is based on images that the model hasn't been trained with, and thus a better indicator of how the model will perform with new images.</p>
</li>
<li>
<p>What does a slow decline of validation accuracy and incline in train accuracy on the plot indicate?</p>
<p>Overfitting.</p>
</li>
<li>
<p>Why do dropouts help overfitting?</p>
<p>Because neighbour neurons can have similar weights and thus can skew the final training</p>
</li>
<li>
<p>What could be the reason behind jaggedness and sudden dips in accuracy graph?</p>
<p><img src="./coursera-02.png" alt="Jaggedness" /></p>
<p>The model needs improvement (need it to be more complex).</p>
</li>
</ul>
<h1 id="computer-vision"><a class="header" href="#computer-vision">Computer vision</a></h1>
<p>Computer vision is the field of having a computer understand and label what is present in an image.</p>
<ul>
<li>
<p>What is convolution?</p>
<p>A technique to isolate features in images.</p>
</li>
<li>
<p>What is pooling?</p>
<p>A technique to reduce information in an image while maintaining features.</p>
</li>
<li>
<p>How do convolutions improve image recognition?</p>
<p>They isolate features in images.</p>
</li>
<li>
<p>Why is transferring learning useful?</p>
<p>Because I can use the features that were learned from large data sets that I may not have access to</p>
</li>
</ul>
<h2 id="improving-speed-of-training"><a class="header" href="#improving-speed-of-training">Improving speed of training</a></h2>
<p>Reduce image size by half</p>
<h2 id="improving-accuracy"><a class="header" href="#improving-accuracy">Improving accuracy</a></h2>
<h3 id="visual"><a class="header" href="#visual">Visual</a></h3>
<p>Visually inspect images that are wrongly classified, and use these and include them in the training. The model is not exposed to that kind of image so just add it to the training set.</p>
<h3 id="cropping-the-wrong-images"><a class="header" href="#cropping-the-wrong-images">Cropping the wrong images.</a></h3>
<h3 id="augmentation"><a class="header" href="#augmentation">Augmentation</a></h3>
<p>Image augmentation introduces a random element to the training images. But if the validation set doesn't have the same randomness, that the validation accuracy can fluctuate.</p>
<h2 id="overfitting"><a class="header" href="#overfitting">Overfitting</a></h2>
<ul>
<li>Augmentation</li>
<li>Dropout</li>
<li>! Validation data should not be augmented</li>
</ul>
<h1 id="nlp"><a class="header" href="#nlp">NLP</a></h1>
<ul>
<li>
<p>Subwords must be used with recurrent neural networks. Why?</p>
<p>Sequence becomes much more important when dealing with subwords, but we're ignoring word positions.</p>
</li>
<li>
<p>Why would you get more overfitting in NLP?</p>
<p>Because you always always have OOV in the validation data set (the training data has never seen them). </p>
</li>
<li>
<p>Why does sequence make a large difference when determining semantics of language?</p>
<p>Because the order in which words appear dictate their impact on the meaning of the sentence.</p>
</li>
<li>
<p>In a generative text model, why and what would you do if the word keeps repeating itself?</p>
<p>The RNN only carries the context forward. Change the RNN to be bidirectional.</p>
</li>
<li>
<p>When predicting word to generate poetry, the more words predicted the more likely it will end up gibberish. Why?</p>
<p>Because the probability that each word matches an existing phrase goes down the more words you create.</p>
</li>
</ul>
<p><img src="./coursera-03.png" alt="NLP workflow" /></p>
<h2 id="prepare-data"><a class="header" href="#prepare-data">Prepare data</a></h2>
<pre><code class="language-python">corpus = [
	&quot;I love my dog&quot;, 
	&quot;I love my cat&quot;, 
	&quot;You love my dog!&quot;
]
</code></pre>
<ul>
<li>tokenising</li>
<li>OOV</li>
<li>convert a text to numbers</li>
<li>padding</li>
<li>sequences</li>
</ul>
<pre><code class="language-python">from tf.keras.preprocessing.text import Tokenizer
t = Tokenizer(num_words=100, oov_token=&quot;&lt;OOV&gt;&quot;)
t.fit_on_texts(corpus)
</code></pre>
<aside>
⚠️ The resulting `word_index` is not affected by the `num_words` parameter. This parameter will only take effect when calling `texts_to_sequences`.
</aside>
<pre><code class="language-python">&gt;&gt;&gt; t.word_index
{'&lt;OOV&gt;': 1,
 'twinkle': 2,
 'little': 3,
 ...
</code></pre>
<pre><code class="language-python">&gt;&gt;&gt; t.texts_to_sequences([&quot;i love manatees&quot;])
[[4, 2, 1]]
</code></pre>
<pre><code class="language-python">&gt;&gt;&gt; pad_sequences(
			t.texts_to_sequences([&quot;i&quot;, &quot;i you you you&quot;]),
			padding='pre', # post
			maxlen=None)
array([[0, 0, 0, 4],
       [4, 7, 7, 7]], dtype=int32)
</code></pre>
<h2 id="prepare-for-text-classification"><a class="header" href="#prepare-for-text-classification">Prepare for text classification</a></h2>
<p>Prepare X and y</p>
<h2 id="prepare-for-next-word-prediction"><a class="header" href="#prepare-for-next-word-prediction">Prepare for next-word prediction</a></h2>
<p>Get ngram sequence</p>
<pre><code class="language-python">input_sequences = []
for line in corpus:
	token_list = t.texts_to_sequences([line])[0]
	for i in range(1, len(token_list)):
		ngram_sequence = token_list[:i+1]
		input_sequences.append(ngram_sequence)
</code></pre>
<pre><code class="language-python">&gt;&gt;&gt; input_sequences
[[1, 1],
 [1, 1, 2],
 [1, 1, 2, 3],
 ...
</code></pre>
<pre><code class="language-python">max_sequence_len = max([len(x) for x in input_sequences])
input_sequences = np.array(pad_sequences(
	input_sequences, maxlen=max_sequence_len))
</code></pre>
<pre><code class="language-python">&gt;&gt;&gt; input_sequences
array([[ 0,  0,  0,  0,  1,  1],
       [ 0,  0,  0,  1,  1,  2],
       [ 0,  0,  1,  1,  2,  3],
			 ...
</code></pre>
<pre><code class="language-python">X, y = input_sequences[:,:-1], input_sequences[:,-1]
y = tf.keras.utils.to_categorical(y, num_classes=total_words)
</code></pre>
<h2 id="modelling"><a class="header" href="#modelling">Modelling</a></h2>
<ul>
<li>
<p>CNN. Can use Conv1D then GlobalAveragePooling1D</p>
</li>
<li>
<p>Sequence modelling</p>
<p>Cell state in RNNs is akin to context. Context should be updated and retained throughout the sequence of words.</p>
</li>
</ul>
<h1 id="time-series"><a class="header" href="#time-series">Time series</a></h1>
<ol>
<li>Prediction</li>
<li>Imputation</li>
<li>Detect anomalies</li>
</ol>
<h2 id="common-patterns-in-time-series"><a class="header" href="#common-patterns-in-time-series">Common patterns in time series</a></h2>
<ul>
<li>Trends</li>
<li>Seasonality</li>
<li>Autocorrelation</li>
</ul>
<p><img src="./coursera-04.png" alt="Fixed partitioning" /></p>
<h2 id="method-moving-average"><a class="header" href="#method-moving-average">Method: Moving average</a></h2>
<p>eliminates noise, but does not anticipate trend or seasonality</p>
<h2 id="method-differencing"><a class="header" href="#method-differencing">Method: Differencing</a></h2>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">ser</span><span class="mord mathnormal">i</span><span class="mord mathnormal">es</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">ser</span><span class="mord mathnormal">i</span><span class="mord mathnormal">es</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">365</span><span class="mclose">)</span></span></span></span></span></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="improve-generalisation"><a class="header" href="#improve-generalisation">Improve generalisation</a></h1>
<p><img src="./improve-generalisation-01.png" alt="Improve generalisation" /></p>
<p><a href="https://twitter.com/rasbt/status/1369045968738476035?s=12">https://twitter.com/rasbt/status/1369045968738476035?s=12</a></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="course-history"><a class="header" href="#course-history">Course history</a></h1>
<ul>
<li>
<p>TensorFlow in Practice on Coursera by deeplearning.ai</p>
<ul>
<li><input disabled="" type="checkbox"/>
Intro to TensorFlow for Artificial Intelligence, Machine Learning and Deep Learning</li>
<li><input disabled="" type="checkbox"/>
Convolutional Neural Networks in TensorFlow</li>
<li><input disabled="" type="checkbox"/>
Natural Language Processing in TensorFlow</li>
<li><input disabled="" type="checkbox"/>
Sequences, Time Seres and Prediction</li>
</ul>
</li>
<li><input disabled="" type="checkbox" checked=""/>
<p>Data visualisation book</p>
</li>
<li><input disabled="" type="checkbox" checked=""/>
<p>Machine Learning in Python: Main developments and technology trends in data science, machine learning, and artificial intelligence</p>
</li>
<li>
<p><a href="https://developers.google.com/machine-learning/">Google Developer Machine Learning</a></p>
<ul>
<li><input disabled="" type="checkbox"/>
Crash course
<ul>
<li><input disabled="" type="checkbox" checked=""/>
Introduction to ML</li>
<li><input disabled="" type="checkbox" checked=""/>
Framing</li>
<li><input disabled="" type="checkbox" checked=""/>
Descending into ML</li>
<li><input disabled="" type="checkbox" checked=""/>
Reducing loss</li>
<li><input disabled="" type="checkbox" checked=""/>
First steps with TF</li>
<li><input disabled="" type="checkbox" checked=""/>
Generalisation</li>
<li><input disabled="" type="checkbox" checked=""/>
Training and test sets</li>
<li><input disabled="" type="checkbox" checked=""/>
Validation set</li>
<li><input disabled="" type="checkbox" checked=""/>
Representation</li>
<li><input disabled="" type="checkbox" checked=""/>
Feature crosses</li>
<li><input disabled="" type="checkbox"/>
Regularisation: Simplicity</li>
<li><input disabled="" type="checkbox"/>
Regularisation: Sparsity</li>
<li><input disabled="" type="checkbox" checked=""/>
Logistic regression</li>
<li><input disabled="" type="checkbox"/>
Classification</li>
<li><input disabled="" type="checkbox" checked=""/>
Neural networks</li>
<li><input disabled="" type="checkbox" checked=""/>
Training neural nets</li>
<li><input disabled="" type="checkbox" checked=""/>
Multi-class neural nets</li>
<li><input disabled="" type="checkbox"/>
Embeddings</li>
<li><input disabled="" type="checkbox"/>
Static vs dynamic training and inference</li>
<li><input disabled="" type="checkbox"/>
Data dependencies</li>
<li><input disabled="" type="checkbox"/>
Fairness</li>
<li><input disabled="" type="checkbox"/>
ML systems in the real world</li>
</ul>
</li>
<li><input disabled="" type="checkbox" checked=""/>
<a href="https://developers.google.com/machine-learning/problem-framing">Problem framing</a></li>
<li><input disabled="" type="checkbox" checked=""/>
<a href="https://developers.google.com/machine-learning/data-prep">Data preparation and feature engineering</a></li>
<li><input disabled="" type="checkbox" checked=""/>
<a href="https://developers.google.com/machine-learning/clustering">Clustering</a></li>
<li><input disabled="" type="checkbox" checked=""/>
<a href="https://developers.google.com/machine-learning/recommendation">Google developer recommendation system</a></li>
<li><input disabled="" type="checkbox"/>
<a href="https://developers.google.com/machine-learning/gan">GANs</a></li>
<li><input disabled="" type="checkbox"/>
<a href="https://developers.google.com/machine-learning/testing-debugging">Testing and debugging</a></li>
</ul>
</li>
<li><input disabled="" type="checkbox"/>
<p><a href="http://www.deeplearningbook.org/">Deep Learning by Ian Goodfellow, Joshua Bengio and Aron Courville</a></p>
</li>
<li>
<p><a href="https://www.youtube.com/watch?v=njKP3FqW3Sk&amp;list=PLtBw6njQRU-rwp5__7C0oIVt26ZgjG9NI&amp;index=1">MIT 6.S191 (2020)</a></p>
<ul>
<li><input disabled="" type="checkbox" checked=""/>
Introduction to deep learning</li>
<li><input disabled="" type="checkbox" checked=""/>
Deep sequence modelling</li>
<li><input disabled="" type="checkbox" checked=""/>
Deep computer vision</li>
<li><input disabled="" type="checkbox" checked=""/>
Deep generative modelling</li>
<li><input disabled="" type="checkbox" checked=""/>
Deep reinforcement learning</li>
<li><input disabled="" type="checkbox" checked=""/>
Limitations and new frontiers</li>
<li><input disabled="" type="checkbox" checked=""/>
Neurosymbolic hybrid AI</li>
<li><input disabled="" type="checkbox" checked=""/>
Generalizable autonomy in robotics</li>
<li><input disabled="" type="checkbox" checked=""/>
Neural rendering</li>
<li><input disabled="" type="checkbox" checked=""/>
ML for scent</li>
<li><input disabled="" type="checkbox" checked=""/>
Visualisation for machine learning, MIT 6.S191 (2019)</li>
</ul>
</li>
<li><input disabled="" type="checkbox" checked=""/>
<p>Fast.ai v3</p>
</li>
<li><input disabled="" type="checkbox" checked=""/>
<p><a href="https://github.com/alirezadir/Production-Level-Deep-Learning/">Production-level Tech Stack</a></p>
</li>
<li><input disabled="" type="checkbox" checked=""/>
<p><a href="https://github.com/chiphuyen/machine-learning-systems-design">Chip Huyen’s Machine Learning Systems Design</a></p>
</li>
<li>
<p><a href="http://cs231n.github.io/">CS231n: Convolutional Neural Networks for Visual Recognition</a></p>
<ul>
<li><input disabled="" type="checkbox"/>
<p>Neural Networks</p>
<ul>
<li><input disabled="" type="checkbox" checked=""/>
Image classification: Data-driven approach, k-NN, train-val-test</li>
<li><input disabled="" type="checkbox"/>
Linear classification: SVM, softmax</li>
<li><input disabled="" type="checkbox" checked=""/>
Optimisation: Stochastic gradient descent</li>
<li><input disabled="" type="checkbox" checked=""/>
Backpropagation, intuitions</li>
<li><input disabled="" type="checkbox"/>
NN Part 1: Setting up</li>
<li><input disabled="" type="checkbox"/>
NN Part 2: Setting up data and loss</li>
<li><input disabled="" type="checkbox"/>
NN Part 3: Learning and evaluation</li>
<li><input disabled="" type="checkbox"/>
Case study</li>
</ul>
</li>
<li><input disabled="" type="checkbox"/>
<p>Convolutional Neural Networks</p>
<ul>
<li><input disabled="" type="checkbox"/>
Architectures, convolution, pooling layers</li>
<li><input disabled="" type="checkbox"/>
Understanding and visualising convolutional neural networks</li>
<li><input disabled="" type="checkbox"/>
Transfer learning and fine-tuning convolutional neural networks</li>
</ul>
</li>
</ul>
</li>
<li><input disabled="" type="checkbox"/>
<p>Deep Learning Yearning by Andrew Ng</p>
</li>
<li><input disabled="" type="checkbox"/>
<p><a href="http://web.stanford.edu/class/cs224n/">CS224n: Natural Language Processing with Deep Learning</a></p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="eda-2"><a class="header" href="#eda-2">EDA</a></h1>
<p>Image</p>
<ul>
<li>Google Facets</li>
<li>Flatten image to a vector, project to t-SNE</li>
<li>Calculate md5 hash to find duplicates</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="image-processing"><a class="header" href="#image-processing">Image processing</a></h1>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="image-frameworks"><a class="header" href="#image-frameworks">Image frameworks</a></h1>
<p>opencv reads in BGR not rgb</p>
<p>channels_last in Keras</p>
<p>Using scipy.ndimage.imread('img.jpg', mode='RGB'), the resulting array will always have this order: (H, W, D) i.e. (height, width, depth) because of the terminology that numpy uses for ndarrays (axis=0, axis=1, axis=2) or analogously (Y, X, Z) if one would like to visualize in 3 dimensions.</p>
<pre><code class="language-python">myImage = cv2.imread(“path”)
</code></pre>
<p>myImage is in the format HEIGHT, WIDTH, CHANNEL</p>
<pre><code class="language-python">import matplotlib.pyplot as plt
plt.imshow(a)
</code></pre>
<pre><code class="language-python">from PIL import Image
img = Image.open(&quot;lena.jpg&quot;)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="techniques"><a class="header" href="#techniques">Techniques</a></h1>
<blockquote>
<p>💡 Reducing dimensionality helps with computational efficiency</p>
</blockquote>
<ul>
<li>
<p>(Make deeper)</p>
</li>
<li>
<p>Convolution</p>
<ul>
<li>
<p>Feature learning</p>
</li>
<li>
<p>Complex gradient</p>
</li>
<li>
<p>Output</p>
<p>padding = &quot;valid&quot;</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="delimsizing size2">⌊</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">s</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">ze</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size2">⌋</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span></p>
<p>padding = &quot;same&quot; (output size is the same as input size), where s &gt; 1</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.7936em;vertical-align:-0.686em;"></span><span class="mopen">⌈</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">s</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">⌉</span></span></span></span></span></p>
</li>
</ul>
</li>
<li>
<p>Nonlinearity (tanh)</p>
</li>
<li>
<p>Max-pooling</p>
<ul>
<li>
<p>Reduce feature map size (needed to aggregate information); derive higher levels of abstraction.</p>
</li>
<li>
<p>No. of strides is usually more than 1 to reduce dimensionality. <strong>Pooling is applied to each channel separately.</strong></p>
</li>
<li>
<p>Forward</p>
</li>
<li>
<p>Backward</p>
<p>Gradients only flow back to the unit that was used</p>
</li>
</ul>
</li>
<li>
<p>Nonlinearity: ReLU</p>
</li>
<li>
<p>Dropout</p>
<ul>
<li>
<p>Regularisation; &quot;ensembling&quot;</p>
</li>
<li>
<p>Forward</p>
<p>Drop <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> of the neurons.</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Dropout</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.32em;vertical-align:-1.91em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-2.2em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.192em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.8889em' height='0.316em' style='width:0.8889em' viewBox='0 0 888.89 316' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V316 H384z M384 0 H504 V316 H384z'/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.8889em' height='0.316em' style='width:0.8889em' viewBox='0 0 888.89 316' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V316 H384z M384 0 H504 V316 H384z'/></svg></span></span><span style="top:-4.6em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">sc</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if dropped</span></span></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">else</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">sc</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3262em;vertical-align:-0.4811em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">p</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>.</p>
</li>
<li>
<p>Backward</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.2074em;vertical-align:-0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.32em;vertical-align:-1.91em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-2.2em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.192em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.8889em' height='0.316em' style='width:0.8889em' viewBox='0 0 888.89 316' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V316 H384z M384 0 H504 V316 H384z'/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.8889em' height='0.316em' style='width:0.8889em' viewBox='0 0 888.89 316' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V316 H384z M384 0 H504 V316 H384z'/></svg></span></span><span style="top:-4.6em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">sc</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if dropped previously</span></span></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">else</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
</li>
<li>
<p>Gradients flow back to the unit that didn't experience dropout</p>
</li>
</ul>
</li>
<li>
<p>Stacking uniform convolutional layers</p>
<ul>
<li>Stacking consecutive <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span> convolutional layers is equivalent to a <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span> convolutional layer in <em>terms of receptive field size</em>. Computationally cheaper.</li>
</ul>
</li>
<li>
<p>[Modular] (concat)</p>
<ul>
<li>&quot;Ensembling&quot; of different kernels; different information can be captured at different levels</li>
</ul>
</li>
<li>
<p>1x1 convolution</p>
<ul>
<li>Used before a convolutional layer to first reduce dimension; cross information learning (duh?)</li>
</ul>
</li>
<li>
<p>Average-pooling</p>
<ul>
<li>Reduce feature map size (needed to aggregate information)</li>
<li>Forward
...</li>
<li>Backward
Gradients flow back to all units</li>
</ul>
</li>
<li>
<p>Batch norm</p>
<ul>
<li>
<p>Note that mean and std are <em>accumulated</em> during training.</p>
<p>No. of samples is usually the no. of samples in the batch.</p>
<p>(See table below)</p>
<p>mean = 0.9<em>old_mean + 0.1</em>current_mean
std  = 0.9<em>old_std  + 0.1</em>current_std</p>
</li>
<li>
<p>Normalisation improves loss contour (hence faster convergence); helps with covariate shift (distribution keeps changing at every layer); helps with regularisation because it is more robust to distribution changes</p>
</li>
</ul>
<blockquote>
<p>💡 For CNN batch norm, every channel will have a mean and std. (Replace &quot;neuron1&quot;, &quot;neuron2&quot;, etc. with &quot;channel1&quot;, &quot;channel2&quot;, ...</p>
</blockquote>
</li>
<li>
<p>Kernel factorisation (spatially separable convolution)</p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">7</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">7</span></span></span></span> is equivalent to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">7</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">7</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> in terms of receptive field (how?).Cos of computation is reduced.</li>
</ul>
</li>
<li>
<p>Skip connections</p>
<ul>
<li>Gradient does not vanish → faster convergence; &quot;ensembling&quot;</li>
</ul>
</li>
<li>
<p>Kernel factorisation (depthwise separable convolution)</p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span> filter is equivalent to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span> followed by <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>. Cost of computation is reduced.</li>
<li>Depthwise = no. of kernels determined by input channels 
Pointwise = 1x1 convolution</li>
</ul>
</li>
<li>
<p>Zero convolution</p>
</li>
</ul>
<div class="table-wrapper"><table><thead><tr><th>d</th><th>sample1 sample2</th><th>mean* std*</th><th>sample1 sample2</th></tr></thead><tbody>
<tr><td>neuron1</td><td>4 5</td><td>4.5 1</td><td>w1*(4-4.5)/1+b1 w1*(5-4.5)/1+b1</td></tr>
<tr><td>neuron2</td><td>3 0</td><td>1.5 2</td><td>w2*(3-1.5)/2+b2 w2*(0-1.5)/2+b2</td></tr>
<tr><td>neuron3</td><td>2 8</td><td>5.0 1</td><td>w3*(2-5.0)/1+b3 w3*(8-5.0)/1+b3</td></tr>
<tr><td>neuron4</td><td>1 2</td><td>1.5 1</td><td>w4*(1-1.5)/1+b4 w4*(2-2.0)/1+b4</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="regularisation"><a class="header" href="#regularisation">Regularisation</a></h1>
<h2 id="regularisation-1"><a class="header" href="#regularisation-1">Regularisation</a></h2>
<ul>
<li>Adjusting data: data augmentation, noise injection, batch normalisation</li>
<li><strong>Parameter norm penalties</strong></li>
<li>Reduce model capacity: early stopping, weight sharing (convolutions), dropout</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="basic-cnn-architectures"><a class="header" href="#basic-cnn-architectures">Basic CNN architectures</a></h1>
<p><img src="./basic-cnn-architectures-01.png" alt="Timeline" /></p>
<p><img src="./basic-cnn-architectures-02.png" alt="GOPS vs Accuracy" /></p>
<p><img src="./basic-cnn-architectures-03.png" alt="RegNet" /></p>
<p><img src="./basic-cnn-architectures-04.png" alt="" /></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Params</th><th></th></tr></thead><tbody>
<tr><td>LeNet</td><td>60K</td><td></td></tr>
<tr><td>AlexNet</td><td>60M</td><td>~LeNet</td></tr>
<tr><td>VGG-16,19</td><td>140M</td><td>Uniform architecture</td></tr>
<tr><td>Inception v1, v2, v3, v4</td><td>4M</td><td>1x1 convolutions in inception module</td></tr>
<tr><td>Xception</td><td></td><td>~Inception. depthwise separable</td></tr>
<tr><td>ResNet-50,101,152</td><td></td><td>Skip connections, batch normalisation</td></tr>
<tr><td>MobileNet v1, v2, v3</td><td></td><td>For mobile phones</td></tr>
<tr><td>EfficientNet B1-B7</td><td></td><td>Found from NAS</td></tr>
<tr><td>NFNets</td><td></td><td></td></tr>
<tr><td></td><td></td><td></td></tr>
</tbody></table>
</div>
<p><img src="./basic-cnn-architectures-05.png" alt="Detection system evolution" /></p>
<h2 id="network-in-network-nin"><a class="header" href="#network-in-network-nin"><strong>Network-in-Network (NiN)</strong></a></h2>
<p>Introduced ‘mlpconv”, global average pooling</p>
<p>Global average pooling sums out the spatial information, thus it is more robust to spatial translations of the input.</p>
<h2 id="fcn---fully-convolutional-neural-network"><a class="header" href="#fcn---fully-convolutional-neural-network"><strong>FCN - Fully convolutional neural network</strong></a></h2>
<p>Skip connections.</p>
<p>no concat unlike in U-Net</p>
<h2 id="mobilenet"><a class="header" href="#mobilenet"><strong>MobileNet</strong></a></h2>
<p>Consists of depthwise + pointwise convolutions (depthwise separable)</p>
<p>Streamlined version of Xception.</p>
<p>2 global hyper parameters:</p>
<ul>
<li>width multiplier (no. of channels): thin the network uniformly at each layer (alpha X input channel)</li>
<li>resolution multiplier (input image)</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="image-classification"><a class="header" href="#image-classification">Image classification</a></h1>
<p>Datasets</p>
<ul>
<li>MNIST (Modified National Institute of Standards and Technology) — 10 classes; 28x28 grayscale</li>
<li>CIFAR-10 (Canadian Institute For Advanced Research) — 10 classes; 6000 32x32 RGB examples per class</li>
<li>SVHN (Street View House Numbers)</li>
<li>ImageNet — 1000 classes; 299x299</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="object-detection"><a class="header" href="#object-detection">Object detection</a></h1>
<ul>
<li>COCO (Common Objects in Context)</li>
<li>PASCAL VOC</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="instance-segmentation"><a class="header" href="#instance-segmentation">Instance segmentation</a></h1>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>?</th></tr></thead><tbody>
<tr><td>ENet</td><td>~ResNet + Inception</td></tr>
<tr><td>SegNet</td><td>Upsampling, subsampling</td></tr>
<tr><td>SqueezeNet</td><td></td></tr>
<tr><td>DeepLab v1, v2, v3</td><td>Atrous/dilated convolutions</td></tr>
<tr><td>FCN</td><td></td></tr>
<tr><td>U-Net</td><td>Upsampling, Copy and crop</td></tr>
</tbody></table>
</div>
<ul>
<li>VOC11, VOC12</li>
<li>Cityscapes</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="reidentification"><a class="header" href="#reidentification">Reidentification</a></h1>
<p>Biometrics</p>
<p>Face recognition</p>
<p>Person ReID (Person Reidentification)</p>
<p>Deep learning</p>
<ul>
<li>Siamese network</li>
</ul>
<p>Traditional</p>
<ul>
<li>Perceptual Image Hashing + Hamming Distance</li>
<li>Keypoint matching</li>
</ul>
<p>Feature matching</p>
<ul>
<li>Hamming distance
<ul>
<li>the no. of different individual bits</li>
<li>0110 and 0111 = 1</li>
</ul>
</li>
</ul>
<h1 id="metricdistance-based-loss-functions"><a class="header" href="#metricdistance-based-loss-functions"><strong>Metric/Distance-based loss functions</strong></a></h1>
<ul>
<li>Contrastive loss</li>
<li>Contrastive loss + softmax loss</li>
<li>Triplet loss</li>
<li>Improved triplet loss</li>
<li>Quadruplet loss</li>
<li>Triplet hard loss</li>
</ul>
<p>Alignment</p>
<ul>
<li>AlignDlib</li>
</ul>
<h1 id="datasets"><a class="header" href="#datasets"><strong>Datasets</strong></a></h1>
<p><strong>Face ReID</strong></p>
<p>Architecture</p>
<p>Facenet</p>
<p>LFW dataset (labeled faces in the wild)</p>
<p>FaceScrub</p>
<p>CASIA webface</p>
<p><strong>Person ReID</strong></p>
<p>AlignedReID</p>
<p>Market1501 (person reid)</p>
<p>CUHK</p>
<p><img src="./reidentification-01.png" alt="Person reidentification methods" /></p>
<p>Contextual methods are where we use external information such as position, angle etc. of cameras to aid Reid</p>
<h1 id="hand-biometrics-verification-and-identification"><a class="header" href="#hand-biometrics-verification-and-identification"><strong>Hand Biometrics: Verification and Identification</strong></a></h1>
<p>Every human hand is unique. Most of hand geometry systems/techniques is based and 2D hand images.</p>
<h2 id="biometric-speak"><a class="header" href="#biometric-speak"><strong>Biometric speak</strong></a></h2>
<p>“Enrolment hand”</p>
<h2 id="hand-biometrics-processing-pipeline-2d"><a class="header" href="#hand-biometrics-processing-pipeline-2d"><strong>Hand biometrics processing pipeline (2D)</strong></a></h2>
<ol>
<li>Imaging techniques
<ol>
<li>Devices
<ol>
<li>Special device with pegs</li>
<li>Special device without pegs</li>
<li>Static image</li>
<li>Video</li>
</ol>
</li>
<li>Modality
<ol>
<li>2D</li>
<li>3D</li>
</ol>
</li>
</ol>
</li>
<li>Preprocessing
<ol>
<li>Segmentation</li>
<li>Binary image</li>
<li>Voronoi diagram</li>
</ol>
</li>
<li>Feature extraction
<ol>
<li>Hand geometry (30 global features)</li>
<li>Palmprint</li>
<li>Palm texture</li>
<li>Key points (valleys, finger tips) for alignment</li>
</ol>
</li>
<li>Feature matching
<ol>
<li>Feature Vector
<ol>
<li>Euclidean distance</li>
<li>Absolute distance</li>
<li>Hamming distance</li>
<li>Normalised correlation</li>
<li>Cosine similarity</li>
<li>Mahalanobis distance</li>
</ol>
</li>
<li>Alignment-based
<ol>
<li>Mean alignment error</li>
<li>Goodness of alignment</li>
<li>Others eg. hand geometry, palm texture etc.</li>
</ol>
</li>
</ol>
</li>
<li>Classification
<ol>
<li>RBF</li>
<li>SVM</li>
<li>GMM</li>
<li>Neural network classifier [1]</li>
<li>k-NN</li>
<li>‘SurfaceCode’</li>
<li>Template distances matching</li>
</ol>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="autoaugment"><a class="header" href="#autoaugment">AutoAugment</a></h1>
<p><img src="./autoaugment-01.jpg" alt="AutoAugment" /></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="style-transfer"><a class="header" href="#style-transfer">Style transfer</a></h1>
<p><img src="./style-transfer-01.png" alt="Style transfer workflow" /></p>
<ul>
<li>“Content image”</li>
<li>“Style reference image” or “style image”</li>
<li>“Output image”</li>
<li>“Targets”</li>
</ul>
<p>“High frequency component”</p>
<p>Use the intermediate layers of the CNN to get the content and style representations.</p>
<p>Calculate style = Gram matrix</p>
<p>Calculate content = Pixel values</p>
<p>Get style_targets tensors</p>
<p>Get content_targets tensors</p>
<h1 id="method-1-naive-loss"><a class="header" href="#method-1-naive-loss"><strong>Method 1: Naive loss</strong></a></h1>
<p>a = MSE(output_tensor - style_tensors[0])</p>
<p>b = MSE(output_tensor - style_tensors[1])</p>
<p>c = MSE(output_tensor - content_tensors[0])</p>
<p>d = MSE(output_tensor - content_tensors[1])</p>
<p>Weighted loss = (a+b+c+d)/4</p>
<h1 id="method-2-with-total-variation-loss"><a class="header" href="#method-2-with-total-variation-loss"><strong>Method 2: With total variation loss</strong></a></h1>
<p>Loss = naive loss + total variation loss</p>
<p>Total variation loss implements an explicit regularisation term on the “high frequency components of image”</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="obj-det--instance-seg"><a class="header" href="#obj-det--instance-seg">Obj det / instance seg</a></h1>
<ul>
<li>R-CNN</li>
<li>Fast R-CNN</li>
<li>Faster RCNN</li>
<li>Mask RCNN</li>
<li>Feature Pyramid Network</li>
<li>SSD</li>
<li>YOLO</li>
<li>RetinaNet</li>
<li>FCOS</li>
<li>Focal loss for Dense Object Detection</li>
<li>EfficientDet</li>
<li>CenterNet</li>
<li>DETR</li>
</ul>
<p><img src="./obj-inst-seg-01.png" alt="Faster RCNN" /></p>
<p><img src="./obj-inst-seg-02.png" alt="YOLO" /></p>
<p><img src="./obj-inst-seg-03.png" alt="FCOS" /></p>
<p><img src="./obj-inst-seg-04.png" alt="Detectron2" /></p>
<div class="table-wrapper"><table><thead><tr><th>R-CNN</th><th></th><th>1</th></tr></thead><tbody>
<tr><td>Fast R-CNN</td><td></td><td></td></tr>
<tr><td>Faster R-CNN</td><td></td><td></td></tr>
<tr><td>YOLO v1, v2, v3</td><td></td><td></td></tr>
<tr><td>EfficientDet-D1D7</td><td>CVPR 2020</td><td>EfficientNet backbone</td></tr>
<tr><td>SSD</td><td></td><td></td></tr>
<tr><td>RetinaNet</td><td></td><td></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="ocr"><a class="header" href="#ocr">OCR</a></h1>
<p>Optical character recognition</p>
<p>Libraries / SaaS</p>
<ul>
<li>Tesseract</li>
<li>EAST (Efficient and Accurate Scene Text Detection)</li>
<li>Ocular</li>
<li>Ocrad</li>
<li>Mathpix</li>
<li>gocr</li>
<li>OpenCV</li>
<li>Google OCR API</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="ui"><a class="header" href="#ui">UI</a></h1>
<ul>
<li>Widget captioning</li>
<li>Screen summarisation</li>
<li>Command grounding</li>
</ul>
<p>https://ai.googleblog.com/2023/02/a-vision-language-approach-for.html</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="others"><a class="header" href="#others">Others</a></h1>
<ul>
<li>Pose estimation --- 18 landmarks</li>
<li>Hand pose estimation --- 21 landmarks</li>
<li>Image inpainting</li>
<li>Crowd counting</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="pretraining-tasks"><a class="header" href="#pretraining-tasks">Pretraining tasks</a></h1>
<ul>
<li>Image classification</li>
<li>Data Generation Task - Eg. GANs</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="models"><a class="header" href="#models">Models</a></h1>
<div class="table-wrapper"><table><thead><tr><th>Year</th><th>Model</th><th>Modes</th><th>Architecture</th><th>Params</th></tr></thead><tbody>
<tr><td>2022</td><td>Mid Journey</td><td></td><td></td><td></td></tr>
<tr><td>2021</td><td>Latent Diffusion</td><td></td><td></td><td></td></tr>
<tr><td>2020</td><td>StyleGAN</td><td>Image</td><td>GAN</td><td></td></tr>
<tr><td></td><td>ViT</td><td>Image?</td><td>Transformer</td><td></td></tr>
<tr><td>?</td><td>DeiT</td><td>Image?</td><td>Transformer</td><td></td></tr>
<tr><td>2018</td><td>EfficientNet</td><td>Image</td><td></td><td></td></tr>
<tr><td></td><td>BigGAN</td><td></td><td>GAN</td><td></td></tr>
<tr><td>2017</td><td>ResNeXt-50</td><td>Image</td><td></td><td></td></tr>
<tr><td></td><td>Mask R-CNN</td><td>Image</td><td>Object detection</td><td></td></tr>
<tr><td>2016</td><td>Xception</td><td>Image</td><td></td><td></td></tr>
<tr><td></td><td>Inception-v4</td><td>Image</td><td></td><td></td></tr>
<tr><td></td><td>Inception-ResNet-V2</td><td>Image</td><td></td><td></td></tr>
<tr><td></td><td>DenseNet</td><td>Image</td><td></td><td></td></tr>
<tr><td>2015</td><td>Inception-v3</td><td>Image</td><td></td><td></td></tr>
<tr><td></td><td>ResNet-50</td><td>Image</td><td></td><td></td></tr>
<tr><td></td><td>U-Net</td><td>Image</td><td>Encoder-decoder</td><td></td></tr>
<tr><td></td><td>DCGAN</td><td>Image</td><td>GAN</td><td></td></tr>
<tr><td>2014</td><td>VGG-16</td><td>Image</td><td></td><td>138M</td></tr>
<tr><td></td><td>Inception-v1</td><td>Image</td><td></td><td></td></tr>
<tr><td></td><td>GAN</td><td>Image</td><td></td><td></td></tr>
<tr><td>2012</td><td>AlexNet</td><td>Image</td><td></td><td>60M</td></tr>
<tr><td>1998</td><td>LeNet-5</td><td>Image</td><td></td><td>60K</td></tr>
<tr><td>?</td><td>Fast R-CNN</td><td></td><td>Object detection</td><td></td></tr>
<tr><td>?</td><td>Faster R-CNN</td><td></td><td>Object detection</td><td></td></tr>
<tr><td>?</td><td>CycleGAN</td><td></td><td>GAN</td><td></td></tr>
<tr><td>?</td><td>GauGAN</td><td></td><td>GAN</td><td></td></tr>
<tr><td>?</td><td>YOLO</td><td></td><td>Object detection</td><td></td></tr>
</tbody></table>
</div>
<p>Architectures</p>
<ul>
<li>LeNet-5
<ul>
<li>[Conv-Tanh-Pooling]</li>
</ul>
</li>
<li>AlexNet
<ul>
<li>[Conv-ReLU-Pooling]</li>
<li>Dropout</li>
</ul>
</li>
<li>VGG
<ul>
<li>[Conv-ReLU-Pooling]; more uniform conv</li>
<li>Stacking uniform convolutional layers</li>
</ul>
</li>
<li>Inception-v1
<ul>
<li>[Modular] (concat)</li>
<li>1x1</li>
<li>Average-pooling</li>
</ul>
</li>
<li>Inception-v2
<ul>
<li>Batch norm</li>
</ul>
</li>
<li>Inception-v3
<ul>
<li>Kernel factorisation</li>
<li>(label smoothing)</li>
</ul>
</li>
<li>ResNet
<ul>
<li>Skip connections (add)</li>
</ul>
</li>
<li>Xception
<ul>
<li>Depthwise separable</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="trending"><a class="header" href="#trending">Trending</a></h1>
<ul>
<li><a href="https://arxiv.org/abs/2302.05543">Adding Conditional Control to Text-to-Image Diffusion Models</a>]</li>
<li></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="language"><a class="header" href="#language">Language</a></h1>
<ul>
<li><a href="language/language.html#vocabulary">Vocabulary</a></li>
<li><a href="language/language.html#concepts">Concepts</a></li>
<li><a href="language/language.html#tasks--applications">Tasks / applications</a></li>
<li><a href="language/language.html#frameworks">Frameworks</a></li>
<li><a href="language/language.html#benchmarks">Benchmarks</a></li>
</ul>
<hr />
<p><a href="http://nlpprogress.com/">http://nlpprogress.com/</a></p>
<p>The field of designing methods and algorithms that take as input or produce as output unstructured human language.</p>
<p>Some characteristics of natural language are</p>
<ul>
<li>discrete / symbolic</li>
<li>compositional
<ul>
<li>letters form words, words form phrases and sentences, sentences form documents</li>
</ul>
</li>
</ul>
<h1 id="vocabulary"><a class="header" href="#vocabulary">Vocabulary</a></h1>
<p><strong>Zero-shot</strong> — follow instructions</p>
<p><strong>Few-shot</strong> — learn in-context; in-context learning</p>
<p>Context = neighbouring words</p>
<p>Semantic = what this set of letters mean</p>
<p>Syntax = where does a word occur in a sentence, in relation to other words, related to grammar (conjugation, pluralise)</p>
<p>Vocabulary size = no. of unique words</p>
<p>Tokens = no. of words</p>
<p>Pivot word = current word</p>
<p>Context-dependent aspects of word meaning</p>
<p>Downstream task = supervised learning tasks that utilise a pre-trained model or component</p>
<p>Vocabulary size</p>
<p>Sequence length</p>
<p>Semantic questions:</p>
<ul>
<li>capital &amp; country</li>
<li>currency &amp; country</li>
<li>city &amp; state</li>
<li>man &amp; woman</li>
</ul>
<p>Syntax questions:</p>
<ul>
<li>adjective to adverb</li>
<li>opposite &gt;???</li>
<li>comparative</li>
<li>superlative</li>
<li>present participle</li>
<li>nationality adjective</li>
<li>past tense</li>
<li>plural nouns</li>
<li>plural verbs</li>
</ul>
<h1 id="concepts"><a class="header" href="#concepts">Concepts</a></h1>
<p>Ideas</p>
<ul>
<li>Language modelling
<ul>
<li>predict-the-next-word (vanilla)</li>
<li>cloze task (masked language modelling)</li>
<li>next-sentence prediction (next sentence prediction)</li>
<li>?? cloze task with permutations ?? (permutation language modelling)</li>
</ul>
</li>
<li>Modelling: architecture
<ul>
<li>RNN</li>
<li>Transformer</li>
<li>Autoregressive (sequential)</li>
<li>Decoder + encoder (autoencoder)</li>
<li>Bidirection</li>
<li>Sequence-to-sequence</li>
</ul>
</li>
<li>Modelling: components
<ul>
<li>Self-attention</li>
</ul>
</li>
<li>Modelling: algorithms (?)
<ul>
<li>
<p>Teacher forcing</p>
<p><img src="language/./teacher-forcing.jpg" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e9da026d-77dc-4e37-b5c1-413f2578f75a/Pasted_Graphic.jpg" /></p>
</li>
</ul>
</li>
</ul>
<h1 id="tasks--applications"><a class="header" href="#tasks--applications"><strong>Tasks / applications</strong></a></h1>
<ul>
<li>Level 1
<ul>
<li>
<p>POS tagging</p>
<p><img src="language/./pos-tagging.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ee861fec-710e-4134-bd32-28ce5958f065/Untitled.png" /></p>
</li>
<li>
<p>Constituency parsing</p>
<p>Break down a text into sub-phrases</p>
<p><img src="language/./constituency-parsing.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5ba43d9e-34ac-4351-b5b9-662edfe8902d/Untitled.png" /></p>
</li>
<li>
<p>Dependency parsing</p>
<p>Analyses the grammatical structure of a sentence, starting with the root. The word that has no dependency is called the root of the sentence. The verb is taken as the root of the sentence in most cases.</p>
<p><img src="language/./dependency-parsing.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8d157875-ccd7-476f-a2ac-1242aadb8317/Untitled.png" /></p>
</li>
<li>
<p>Semantic role labeling</p>
<p>Semantic role labelling assigns labels to words/phrases to indicate their semantic role in the sentence. Eg. &quot;agent&quot;, &quot;patient&quot;, &quot;instrument&quot;, &quot;manner&quot;.</p>
<p><img src="language/./semantic-role-labelling.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d8ec6b0c-bc88-4fe1-bf9a-e70feed5cc21/Untitled.png" /></p>
</li>
<li>
<p>Coreference resolution</p>
<p>Keep track of entities</p>
</li>
</ul>
</li>
</ul>
<hr />
<ul>
<li>Level 2
<ul>
<li>
<p>Text classification</p>
</li>
<li>
<p>Sentiment analysis</p>
<p>Classify emotions (positive or negative)</p>
</li>
<li>
<p>NER</p>
<p>Identify <em>named</em> entities (eg. people, location, organisation, number, product)</p>
</li>
<li>
<p><strong>Language modelling</strong></p>
</li>
<li>
<p>Semantic similarity</p>
</li>
<li>
<p>Text generation</p>
</li>
<li>
<p>Topic modelling</p>
</li>
<li>
<p>Keyword extraction</p>
</li>
<li>
<p>Event extraction</p>
</li>
<li>
<p>Relation extraction</p>
</li>
<li>
<p>Information extraction</p>
<p>Extracting structured information from unstructured data. Over the years, this task has been broken down into NER, coreference resolution, entity linking, relation extraction, even extraction etc.</p>
</li>
</ul>
</li>
</ul>
<hr />
<ul>
<li>Level 3
<ul>
<li>
<p>Summarisation</p>
</li>
<li>
<p>Machine translation</p>
</li>
<li>
<p>Open IE</p>
<p><a href="https://openie.allenai.org/">https://openie.allenai.org</a></p>
<p>Open Information Extraction. &quot;Open&quot; means any kind of relationships. This is in contrast to relation extraction where the relations do not need to be specified in advance.</p>
<pre><code>Born in a small town, she took the midnight train going anywhere.
</code></pre>
<ul>
<li>(<strong>born</strong>, she, in a small town)</li>
<li>(<strong>took</strong>, she, the midnight train going anywhere)</li>
<li>(<strong>going</strong>, the might train, anywhere)</li>
</ul>
<blockquote>
<p>💡 Why do we need this? The ability to glean facts and opinions from sentences.</p>
</blockquote>
</li>
<li>
<p>Textual entailment</p>
<p>aka NLI (natural language inference)</p>
<p>Whether Sentence A (“<strong>premise</strong>”) can be implied or contradicted by Sentence B (“<strong>hypothesis</strong>”)</p>
<p>(SentenceA, SentenceB) → Entailment | Contradiction | Neutral</p>
<blockquote>
<p>💡 This problem is often considered an important test for the reasoning skills of ML systems</p>
</blockquote>
</li>
<li>
<p>QA</p>
<p>AKA machine comprehension. QA answers natural language questions by selecting an answer span within an evidence text.</p>
<p><strong>Types of machine comprehension</strong></p>
<ul>
<li>Open-domain vs. closed-domain</li>
<li>Abstractive vs. Extractive</li>
<li>Factoid vs. Non-Factoid</li>
</ul>
</li>
<li>
<p>VQA</p>
<p>Visual question answering</p>
<p><a href="https://visualqa.org/">https://visualqa.org</a></p>
</li>
<li>
<p>Image captioning</p>
</li>
<li>
<p>Chitchat dialogue</p>
</li>
<li>
<p>Paraphrasing</p>
</li>
</ul>
</li>
</ul>
<hr />
<p><img src="language/./nlp-task-spectrum.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/dd6f8e6a-90e2-485e-9e90-d81e98967e29/Untitled.png" /></p>
<h1 id="frameworks"><a class="header" href="#frameworks"><strong>Frameworks</strong></a></h1>
<ul>
<li>
<p>fairseq</p>
</li>
<li>
<p><a href="https://nlp.stanford.edu/software/lex-parser.shtml#Download">Stanford</a></p>
</li>
<li>
<p>spacy.io</p>
</li>
<li>
<p><a href="https://explosion.ai/demos/displacy-ent">https://explosion.ai/demos/displacy-ent</a></p>
</li>
<li>
<p>Neuralcoref</p>
</li>
<li>
<p><a href="https://fasttext.cc/">https://fasttext.cc</a></p>
</li>
<li>
<p><a href="http://allennlp.org/">allennlp.org</a></p>
</li>
<li>
<p>NLTK</p>
</li>
<li>
<p>gensim</p>
</li>
<li>
<p>TensorFlow</p>
</li>
<li>
<p>Universal Language Model Fine-tuning (ULMFiT) for trf learning</p>
</li>
<li>
<p><a href="https://github.com/deepset-ai/FARM">https://github.com/deepset-ai/FARM</a></p>
</li>
<li>
<p><a href="https://github.com/OpenNMT/OpenNMT-tf">https://github.com/OpenNMT/OpenNMT-tf</a></p>
</li>
<li>
<p><a href="https://github.com/huggingface/transformers">https://github.com/huggingface/transformers</a></p>
</li>
<li>
<p><a href="https://github.com/huggingface/transformers">huggingface / transformers</a></p>
</li>
<li>
<p>compromise.cool</p>
</li>
<li>
<p><a href="https://github.com/abelriboulot/onnxt5">ONNXT5</a> inference-ready</p>
<p><code>question: ... ? context: ...</code></p>
<p><code>summarize: ...</code></p>
<p><code>translate english to french: ...</code></p>
</li>
<li>
<p><a href="https://www.sbert.net/index.html">https://www.sbert.net/index.html</a></p>
</li>
</ul>
<h1 id="benchmarks"><a class="header" href="#benchmarks"><strong>Benchmarks</strong></a></h1>
<p>GLUE score (General Language Understanding Evaluation)</p>
<p>ROUGE (recall-oriented understudy for gisting evaluation)</p>
<p>SuperGLUE</p>
<p>XGLUE</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="processing"><a class="header" href="#processing">Processing</a></h1>
<h1 id="preprocessing-i"><a class="header" href="#preprocessing-i"><strong>Preprocessing I</strong></a></h1>
<ul>
<li>n-gram</li>
<li>Remove stop words</li>
<li>Lowercase the text</li>
<li>Strip punctuations</li>
</ul>
<h1 id="preprocessing-ii"><a class="header" href="#preprocessing-ii"><strong>Preprocessing II</strong></a></h1>
<ul>
<li>Word tokenisation</li>
<li>Lemmatisation</li>
<li>Stemming</li>
<li>Sentence segmentation</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="tokenisation"><a class="header" href="#tokenisation">Tokenisation</a></h1>
<p>Tokenisation is the <em>splitting</em> of text into smaller units.</p>
<h3 id="algorithms"><a class="header" href="#algorithms">Algorithms</a></h3>
<ul>
<li>Character</li>
<li>Subword
<ul>
<li>BPE (Byte-Pair Encoding). By frequency. Implementations:
<ul>
<li><a href="https://github.com/google/sentencepiece">SentencePiece</a></li>
<li><a href="https://github.com/glample/fastBPE">fastBPE</a></li>
<li><a href="https://github.com/VKCOM/YouTokenToMe">YouTokenToMe</a></li>
<li><a href="https://github.com/rsennrich/subword-nmt">rsennrich / subword-nmt</a></li>
</ul>
</li>
<li>WordPiece. By likelihood</li>
<li>Unigram Language Model</li>
<li>Syllable tokenisation</li>
<li>Character n-grams (by fasttext)</li>
</ul>
</li>
<li>Word
<ul>
<li><a href="https://spacy.io/">spaCy</a></li>
<li><a href="http://www.statmt.org/moses/?n=Development.GetStarted">Moses</a></li>
</ul>
</li>
</ul>
<h3 id="libraries-3"><a class="header" href="#libraries-3">Libraries</a></h3>
<ul>
<li>Moses</li>
<li>Whitespace</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="embeddings"><a class="header" href="#embeddings">Embeddings</a></h1>
<p>“Representation Learning”</p>
<p>Represent how something functions syntactically (position) and semantically (meaning) + relationships</p>
<p>How to generate a numerical representation of the tokens? Need to train with some data so that model understands the world</p>
<h2 id="subword"><a class="header" href="#subword">Subword</a></h2>
<ul>
<li>Unigram Language Model</li>
<li><del>MOE (Misspelling Oblivious Embeddings)</del> (deprecated)</li>
</ul>
<h2 id="word"><a class="header" href="#word">Word</a></h2>
<ul>
<li>Bag-of-words</li>
<li>TF-IDF</li>
<li>Gensim’s Word2Vec</li>
<li>NNLM (Neural Network Language Model)</li>
<li>Word2Vec
<ul>
<li>Skip-Gram. word and phrase representations learned by Skip-gram model exhibits a linear structure that makes it possible to perform precise analogical reasoning using simple vector arithmetics</li>
<li>CBOW</li>
</ul>
</li>
<li>GLoVe</li>
<li>ELMo
<ul>
<li>Contextual: The representation for each word depends on the entire context in which it is used.</li>
<li>Deep: The word representations combine all layers of a deep pre-trained neural network.</li>
<li>Character based: ELMo representations are purely character based, allowing the network to use morphological clues to form robust representations for out-of-vocabulary tokens unseen in training.</li>
</ul>
</li>
<li>LDA</li>
<li>fastText</li>
<li>MUSE (Multilingual Unsupervised or Supervised word Embeddings)</li>
</ul>
<h2 id="sentence"><a class="header" href="#sentence">Sentence</a></h2>
<ul>
<li>USE (multilingual)</li>
<li>InferSent</li>
<li>SentenceBERT</li>
<li><a href="https://github.com/facebookresearch/LASER">LASER</a> (Language-Agnostic SEntence Representations) — Trained on 90+ languages. Model has the ability to accept code-switching!</li>
<li>LaBSE</li>
</ul>
<h2 id="document"><a class="header" href="#document">Document</a></h2>
<ul>
<li>Doc2Vec</li>
<li>Bag-of-words</li>
<li>TF-IDF</li>
</ul>
<h2 id="summary"><a class="header" href="#summary">Summary</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Model</th><th>Encoding</th><th>Characteristics</th><th>Optimiser</th><th>Word-to-embedding</th><th>Available modules trained on</th><th>Getting embeddings</th></tr></thead><tbody>
<tr><td>NNLM</td><td></td><td>MLP with projection layer and hidden layer</td><td></td><td></td><td></td><td></td></tr>
<tr><td>Skip-gram</td><td>One-hot encoding of words</td><td>MLP with projection layer</td><td>Gradient descent</td><td>1-to-1</td><td>Wikipedia English</td><td>Output</td></tr>
<tr><td>GloVe</td><td>Co-occurrence matrix</td><td>SVD-like</td><td>Gradient descent</td><td>1-to-1</td><td></td><td>Output</td></tr>
<tr><td>fastText</td><td>Character-level (subword).Character n-grams</td><td></td><td></td><td></td><td></td><td>?</td></tr>
<tr><td>ELMo</td><td>Character-level CNN (subword)</td><td>Bi-directional, LM</td><td>Gradient descent</td><td>1-to-many</td><td>5.5B tokens from Wikipedia 1.9B</td><td>Aggregate output layers</td></tr>
<tr><td>Transformer</td><td></td><td>Self-attention, seq2seq</td><td></td><td></td><td></td><td>?</td></tr>
<tr><td>BERT</td><td></td><td>LM, transformer</td><td></td><td></td><td></td><td>Aggregate encoder stack layers</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="encoding"><a class="header" href="#encoding">Encoding</a></h1>
<h3 id="how-to-encode-a"><a class="header" href="#how-to-encode-a">How to encode a...?</a></h3>
<ul>
<li>
<p>Token</p>
<ul>
<li>One-hot</li>
<li>Bag-of-x</li>
<li>Aggregate of x (concat, sum)</li>
</ul>
</li>
<li>
<p>Position</p>
<ul>
<li>absolute positional encoding</li>
<li>relative position encoding</li>
<li>RoPE -- Rotary positional encoding</li>
<li>sinusoidal positional encoding</li>
</ul>
<p><img src="language/./positional-encoding.jpg" alt="Positional encoding" /></p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="representation"><a class="header" href="#representation">Representation</a></h1>
<p>(Numerical representation)</p>
<ul>
<li><a href="language/representation.html#sparse-representations">Sparse representations</a></li>
<li><a href="language/representation.html#dense-representations-embeddings">Dense representations: Embeddings</a>
<ul>
<li><a href="language/representation.html#frequency-based">Frequency-based</a></li>
<li><a href="language/representation.html#prediction-based">Prediction-based</a></li>
</ul>
</li>
</ul>
<hr />
<h2 id="sparse-representations"><a class="header" href="#sparse-representations">Sparse representations</a></h2>
<p>sparsity problem</p>
<p>no similarity</p>
<ul>
<li>One-hot encoding (1-of-V coding)</li>
<li>Multi-hot encoding</li>
<li>Bag-of-words</li>
</ul>
<h2 id="dense-representations-embeddings"><a class="header" href="#dense-representations-embeddings">Dense representations: Embeddings</a></h2>
<p>learned lookup table</p>
<p>idea: every word is represented by a vector</p>
<h3 id="frequency-based"><a class="header" href="#frequency-based">Frequency-based</a></h3>
<ul>
<li><strong>Count Vectors</strong></li>
<li><strong>TF-IDF</strong> (term frequency - inverse document frequency)</li>
<li><strong>Co-occurence matrix</strong></li>
</ul>
<h3 id="prediction-based"><a class="header" href="#prediction-based">Prediction-based</a></h3>
<ul>
<li><strong>Skip-gram</strong>: learning embeddings by predicting word contexts</li>
<li><strong>CBOW</strong></li>
<li><strong>fastText</strong>: robust embeddings using subword information</li>
<li><strong>GloVe</strong>: learning embeddings of size 100 from word co-occurrence (Global Vectors for Word Representation)</li>
<li><strong>ELMo</strong>: Embeddings from Language Models (pre-trained)</li>
<li>PPMI matrix decomposition (using SVD) to get word embeddings</li>
<li>Skip-Thought Vectors</li>
<li>Doc2Vec</li>
<li>USE (universal sentence encoder)</li>
<li>NNLM (neural network language model)</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="language-modelling"><a class="header" href="#language-modelling">Language modelling</a></h1>
<p>Difference between encoder and language model is that encoders output a vector whereas LMs output a sequence of tokens. </p>
<p><a href="https://web.stanford.edu/class/cs124/lec/languagemodeling.pdf">https://web.stanford.edu/class/cs124/lec/languagemodeling.pdf</a></p>
<p><a href="https://lilianweng.github.io/lil-log/2019/01/31/generalized-language-models.html#gpt-2">https://lilianweng.github.io/lil-log/2019/01/31/generalized-language-models.html</a></p>
<p><a href="https://syncedreview.com/2017/09/10/language-model-a-survey-of-the-state-of-the-art-technology/">https://syncedreview.com/2017/09/10/language-model-a-survey-of-the-state-of-the-art-technology/</a></p>
<hr />
<ul>
<li><a href="language/language-modelling.html#why-model-language">Why model language?</a></li>
<li><a href="language/language-modelling.html#types-of-language-models">Types of language models</a></li>
<li><a href="language/language-modelling.html#statistical-language-model">Statistical language model</a>
<ul>
<li><a href="language/language-modelling.html#model">Model</a></li>
<li><a href="language/language-modelling.html#markov-assumption-as-approximation">Markov assumption as approximation</a></li>
<li><a href="language/language-modelling.html#solution-to-optimisation-problem">Solution to optimisation problem</a></li>
<li><a href="language/language-modelling.html#tweaks">Tweaks</a></li>
<li><a href="language/language-modelling.html#problems">Problems</a></li>
</ul>
</li>
<li><a href="language/language-modelling.html#neural-language-models">Neural language models</a>
<ul>
<li><a href="language/language-modelling.html#model-1">Model</a></li>
<li><a href="language/language-modelling.html#architectures">Architectures</a></li>
</ul>
</li>
<li><a href="language/language-modelling.html#how">How?</a>
<ul>
<li><a href="language/language-modelling.html#1-teach-the-model-the-world-pre-training">1. Teach the model the world (&quot;pre-training&quot;)</a></li>
<li><a href="language/language-modelling.html#2-applying--fine-tune--datasets--downstream-tasks--see-how-well-you-trained-the-model">2. Applying / Fine-tune / datasets / downstream tasks / see how well you trained the model</a></li>
</ul>
</li>
<li><a href="language/language-modelling.html#types-of-fine-tuning">Types of fine-tuning</a></li>
<li><a href="language/language-modelling.html#what-did-we-learn">What did we learn?</a></li>
</ul>
<hr />
<h1 id="why-model-language"><a class="header" href="#why-model-language">Why model language?</a></h1>
<p>Natural language is not deterministic unlike programming language. This randomness in the sequence of words can be modelled probabilistically. </p>
<h1 id="types-of-language-models"><a class="header" href="#types-of-language-models">Types of language models</a></h1>
<ul>
<li>Statistical language model (count-based)</li>
<li>Neural language model (continuous-based)</li>
</ul>
<h1 id="statistical-language-model"><a class="header" href="#statistical-language-model">Statistical language model</a></h1>
<h2 id="model"><a class="header" href="#model">Model</a></h2>
<p>We first fix <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> to be the length of this sequence of words. A language model is the (joint) probability distribution over a sequence of words</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span> is any word available in the language's vocabulary and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span> are the parameters of the model and which can be conveniently broken down into</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">...</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3277em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>or (for better readability)</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">...</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>The way we model language is that the choice of the next word (&quot;<strong>next-word prediction</strong>&quot;) depends on the previous words which have said (&quot;realise&quot;).</p>
<p>Now let's compute the joint probability </p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord text"><span class="mord">its</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">water</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">is</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">so</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">transparent</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">that</span></span><span class="mclose">)</span></span></span></span></span></p>
<p>or rather let's try to predict the next word, say finding out if the next word is the:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord text"><span class="mord">the</span></span><span class="mord">∣</span><span class="mord text"><span class="mord">its</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">water</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">is</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">so</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">transparent</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">that</span></span><span class="mclose">)</span></span></span></span></span></p>
<p>which equals to (by Bayes):</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord text"><span class="mord">its</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">water</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">is</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">so</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">transparent</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">that</span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord text"><span class="mord">its</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">water</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">is</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">so</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">transparent</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">that</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">the</span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>We could take the counts based on our data:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">o</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord text"><span class="mord">its</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">water</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">is</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">so</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">transparent</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">that</span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">o</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord text"><span class="mord">its</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">water</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">is</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">so</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">transparent</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">that</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">the</span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>But this is impossible</p>
<blockquote>
<p>💡 Why ah? Because if they don't exist in our data, doesn't mean they don't occur naturally.</p>
</blockquote>
<h2 id="markov-assumption-as-approximation"><a class="header" href="#markov-assumption-as-approximation">Markov assumption as approximation</a></h2>
<p>In the <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>-th order Markovian assumption, we assume the next word depends on the last <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> words.</p>
<p>We simplify the problem to instead find (&quot;<strong>bigram model</strong>&quot;)</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord text"><span class="mord">the</span></span><span class="mord">∣</span><span class="mord text"><span class="mord">that</span></span><span class="mclose">)</span></span></span></span></span></p>
<p>or (&quot;<strong>trigram model</strong>&quot;)</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord text"><span class="mord">the</span></span><span class="mord">∣</span><span class="mord text"><span class="mord">transparent</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">that</span></span><span class="mclose">)</span></span></span></span></span></p>
<p>or</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord text"><span class="mord">the</span></span><span class="mord">∣</span><span class="mord text"><span class="mord">so</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">transparent</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">that</span></span><span class="mclose">)</span></span></span></span></span></p>
<p>or to generalise, we simplify the problem to be</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3277em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> is the number of preceding words before <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>. Another way to look at this is:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3277em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>The value <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> then represents if its a unigram model (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>), bigram (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>) or <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>-gram.</p>
<h2 id="solution-to-optimisation-problem"><a class="header" href="#solution-to-optimisation-problem">Solution to optimisation problem</a></h2>
<p>A common solution is to use MLE. Below is for a bigram model.</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<h2 id="tweaks"><a class="header" href="#tweaks">Tweaks</a></h2>
<ul>
<li>Laplace smoothing (for unseen words)</li>
</ul>
<h2 id="problems"><a class="header" href="#problems">Problems</a></h2>
<ul>
<li>Sparsity</li>
<li>Curse of dimensionality</li>
</ul>
<h1 id="neural-language-models"><a class="header" href="#neural-language-models">Neural language models</a></h1>
<h2 id="model-1"><a class="header" href="#model-1">Model</a></h2>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord text"><span class="mord">word</span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord text"><span class="mord"> previous words</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<h2 id="architectures"><a class="header" href="#architectures">Architectures</a></h2>
<ul>
<li>
<p>FFNN</p>
</li>
<li>
<p>RNN</p>
</li>
<li>
<p>Transformers</p>
<p>The key/value/query concepts come from retrieval systems. For example, when you type a query to search for some video on Youtube, the search engine will map your query against a set of keys (video title, description etc.) associated with candidate videos in the database, then present you the best matched videos (values). <a href="https://stats.stackexchange.com/questions/421935/what-exactly-are-keys-queries-and-values-in-attention-mechanisms/424127#424127">Source</a></p>
</li>
</ul>
<h1 id="how"><a class="header" href="#how">How?</a></h1>
<ol>
<li>
<p>Pre-train, framed as a language modelling</p>
<p>Pretraining is usually down on a huge corpus.</p>
</li>
<li>
<p>Applying to downstream tasks:</p>
<ol>
<li>Fine-tune (specialise), framed as predicting conditional probabilities
<ul>
<li>Discriminative tasks</li>
<li>Generative tasks</li>
<li>Abstractive tasks</li>
</ul>
</li>
<li>Feature-based tasks</li>
</ol>
</li>
</ol>
<h2 id="1-teach-the-model-the-world-pre-training"><a class="header" href="#1-teach-the-model-the-world-pre-training">1. Teach the model the world (&quot;pre-training&quot;)</a></h2>
<p>A language model is the statistical model that...</p>
<ul>
<li>
<p>Native language</p>
<ul>
<li>
<p>What's the next word? What are the next words? (&quot;<strong>causal language modelling</strong>&quot; / &quot;<strong>next-token prediction</strong>&quot;)</p>
<p>GPT, GPT2, GPT3, CTRL, Transformer-XL, Reformer, XLNet, ProphetNet</p>
</li>
<li>
<p>Cloze (&quot;<strong>masked language modelling</strong>&quot;). Predict only the masked words.</p>
<p>BERT</p>
</li>
<li>
<p>Can this be the next sentence? What could be the next sentence? (&quot;<strong>next sentence prediction</strong>&quot;) (CLM?)</p>
<p>BERT</p>
</li>
</ul>
<hr />
<ul>
<li>
<p>Were these 2 sentences swapped? If swapped, can I still figure out the context? (&quot;<strong>sentence ordering prediction</strong>&quot;)</p>
</li>
<li>
<p>Define what task I want to do, then work on it (&quot;<strong>instructional language modelling</strong>&quot;)</p>
<p>CTRL, T5, GPT3?</p>
</li>
<li>
<p>Correct my sentence. Which words did I miss out? (&quot;<strong>correctional language modelling</strong>&quot;)</p>
</li>
<li>
<p>Summarise the content (&quot;<strong>summarisational</strong>&quot;)</p>
<ul>
<li>Mask a span of tokens as a single mask token</li>
<li>GSG (Pegasus)</li>
</ul>
</li>
<li>
<p>Downstream tasks (&quot;<strong>fine-tuning</strong>&quot;)</p>
</li>
</ul>
<hr />
<ul>
<li>
<p>Which words were replaced? Which words are &quot;natural&quot; to you? (&quot;<strong>adversarial language modelling</strong>&quot;)</p>
</li>
<li>
<p>Learning with images and sounds etc. (&quot;<strong>multimodal</strong>&quot;)</p>
</li>
<li>
<p>Understanding the context</p>
<p>XLNet</p>
</li>
<li>
<p>Reading / understanding <em>long</em> texts (&quot;<strong>high attention</strong>&quot;)</p>
<p>Transformer-XL, Longformer</p>
</li>
<li>
<p>Factual language modelling</p>
</li>
</ul>
</li>
<li>
<p>Learning a new language (&quot;<strong>cross-language modelling</strong>&quot; / &quot;<strong>translation language modelling</strong>&quot;)</p>
<ul>
<li>(SentenceInLanguageA, SentenceInLanguageB)</li>
</ul>
</li>
</ul>
<p>What is the model built for?</p>
<ul>
<li>Generate only (decoder? only, autoregressive). Eg. generate text</li>
<li>Understand (autoencoder) and possibly use it for something useful next time. Eg. Sentence classification.</li>
<li>Understand and generate (sequence-to-sequence). Eg. translation, summarisation</li>
</ul>
<p>Data sources:</p>
<p>Common sources are Wikipedia, web news, web question-answer pages and discussion forums.</p>
<h2 id="2-applying--fine-tune--datasets--downstream-tasks--see-how-well-you-trained-the-model"><a class="header" href="#2-applying--fine-tune--datasets--downstream-tasks--see-how-well-you-trained-the-model">2. Applying / Fine-tune / datasets / downstream tasks / see how well you trained the model</a></h2>
<p>(SuperGLUE tasks)</p>
<ul>
<li>
<p>Discriminative tasks</p>
<p>Grammar</p>
<ul>
<li>CoLA (GLUE)</li>
</ul>
<p>Sentiment analysis</p>
<ul>
<li>SST-2 (GLUE)</li>
</ul>
</li>
<li>
<p>Generative tasks</p>
<ul>
<li>Summarisation
<ul>
<li>ELI5</li>
<li>XSum</li>
<li>ConvAI2</li>
<li>CNN/DM</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Unclassified</p>
<ul>
<li>Sentence similarity / paraphrase
<ul>
<li>STS-B (GLUE)</li>
<li>QQP (GLUE)</li>
</ul>
</li>
<li>Question answering
<ul>
<li>SQuAD</li>
<li>QNLI (GLUE)</li>
</ul>
</li>
<li>Textual entailment
<ul>
<li>MNLI (GLUE)</li>
</ul>
</li>
<li>Translation
<ul>
<li>WMT</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Speed</p>
<p>Reformer</p>
<ul>
<li>
<p>Continual learning</p>
</li>
<li>
<p>Understanding the context first (dual encoder, one decoder)</p>
</li>
<li>
<p>Lack of information (data)</p>
</li>
<li>
<p>Causal language modelling</p>
<p>AKA next-word prediction, next-token prediction</p>
</li>
<li>
<p>Mask language modelling</p>
<ol>
<li>Randomly mask 15% of input tokens</li>
<li>Model to predict the masked tokens</li>
</ol>
</li>
<li>
<p>Next-sentence prediction</p>
<p>Ever example is a tuple of</p>
<p>((Sentence A, Sentence B), B is next | B is not next)</p>
</li>
</ul>
<p><img src="language/./model-summary.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b18fe357-dd96-4941-b867-704842736e52/Untitled.png" /></p>
<p><a href="https://huggingface.co/transformers/model_summary.html">https://huggingface.co/transformers/model_summary.html</a></p>
<p>This categorisation is based on the question &quot;how do you train/teach these models?&quot; Note that it does not mean that they do not share the same architecture.</p>
<h1 id="types-of-fine-tuning"><a class="header" href="#types-of-fine-tuning">Types of fine-tuning</a></h1>
<p><a href="https://ruder.io/recent-advances-lm-fine-tuning/">https://ruder.io/recent-advances-lm-fine-tuning/</a></p>
<ul>
<li><strong>Adaptive fine-tuning</strong> — specialise to target domain
<ol>
<li>Pre-training</li>
<li>Adaptive fine-tuning on target data</li>
<li>Fine-tuning on task labels</li>
</ol>
</li>
<li><strong>Behavioural fine-tuning</strong> — specialise to target task
<ol>
<li>Pre-training</li>
<li>Behavioural fine-tuning on relevant tasks</li>
<li>Fine-tuning on task labels</li>
</ol>
</li>
<li><strong>Parameter-efficient fine-tuning</strong> — reduce model size</li>
<li><strong>Text-to-text fine-tuning</strong> — ?</li>
</ul>
<h1 id="what-did-we-learn"><a class="header" href="#what-did-we-learn">What did we learn?</a></h1>
<ul>
<li>Pretraining, then fine-tuning</li>
<li>MLM</li>
<li>More data is good</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="topic-modelling"><a class="header" href="#topic-modelling">Topic modelling</a></h1>
<p>Resources</p>
<p>BERT-based: <a href="https://github.com/MaartenGr/KeyBERT/">https://github.com/MaartenGr/KeyBERT/</a></p>
<p><a href="https://github.com/boudinfl/pke">https://github.com/boudinfl/pke</a></p>
<div class="table-wrapper"><table><thead><tr><th>Method</th><th>Need more than 1 doc</th><th>Algorithm</th><th>Output: Doc-Topic</th><th>Output: Term-Doc</th><th>Output: Term-Topic</th><th>Output: similarity matrix</th></tr></thead><tbody>
<tr><td>TF-IDF</td><td>✓</td><td>Frequency-based</td><td></td><td>✓</td><td></td><td></td></tr>
<tr><td>NMF</td><td>✓</td><td>SVD of term-docV = WH</td><td>✓</td><td></td><td>✓</td><td></td></tr>
<tr><td>LDA</td><td>✓</td><td>Probabilistic generative modelling</td><td>✓</td><td></td><td>✓</td><td></td></tr>
<tr><td>LSA</td><td>✓</td><td>SVD of term-docX = UΣVT</td><td></td><td>✓</td><td>✓</td><td></td></tr>
<tr><td>RAKE</td><td></td><td>Word co-occurrences, scoring system</td><td></td><td></td><td></td><td></td></tr>
<tr><td>TextRank</td><td></td><td>Similarity (word co-occurrences)</td><td></td><td></td><td></td><td>✓</td></tr>
<tr><td>Bag of words</td><td></td><td>Word frequency</td><td></td><td></td><td></td><td></td></tr>
<tr><td>POS tagging</td><td></td><td>Linguistic approach</td><td></td><td></td><td></td><td></td></tr>
<tr><td>NER tagging</td><td></td><td>Linguistic approach</td><td></td><td></td><td></td><td></td></tr>
<tr><td>Random Projections</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
</tbody></table>
</div>
<p><strong>Theory</strong></p>
<p>Distributional hypothesis - The <strong>distributional hypothesis</strong> in linguistics is derived from the semantic theory of language usage, i.e. words that are used and occur in the same contexts tend to purport similar meanings</p>
<p>Semantic similarity</p>
<p>Vector space model - representing text documents as vectors</p>
<hr />
<h1 id="tf-idf"><a class="header" href="#tf-idf"><strong>TF-IDF</strong></a></h1>
<p>(Term Frequency - Inverse Document Frequency)</p>
<p>words which are rare are the ones that actually help in distinguishing between the data, and carry more weight</p>
<ol>
<li>Get a list of unique words.</li>
<li>For every word in every document, calculate
<ul>
<li><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">total no. of words</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">count of this term</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></li>
<li><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">df</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">no. of docs with this term</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">total no. of docs</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></li>
<li><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">df</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">df</span></span></span></span></span></li>
</ul>
</li>
</ol>
<p>Document A: The car is driven on the road.</p>
<p>Document B: The truck is driven on the highway.</p>
<p><img src="language/./tf-idf.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b1103cc7-0688-4750-912d-d811e7e8de31/log(22)__0.png" /></p>
<h1 id="nmf"><a class="header" href="#nmf"><strong>NMF</strong></a></h1>
<p>(Nonnegative Matrix Factorisation)</p>
<h1 id="glove"><a class="header" href="#glove"><strong>GloVe</strong></a></h1>
<ul>
<li>svd</li>
</ul>
<h1 id="rake"><a class="header" href="#rake"><strong>RAKE</strong></a></h1>
<p>(Rapid Automation Keyword Extraction)</p>
<ol>
<li>Get tokens by partitioning using stop words and punctuation marks</li>
<li>Get co-occurrence matrix</li>
<li>Simple scoring
Degree(“keyword”) = sum of no. of co-occurrences = 3+3+1+1
Frequency(“keyword”) = cell entry in co-occurrence = 3
Score(“keyword”) = degree/frequency
<img src="language/./rake.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/73abfb6b-f8c5-44fc-b26d-05d44bcc111f/keyword.png" /></li>
</ol>
<h1 id="lda"><a class="header" href="#lda"><strong>LDA</strong></a></h1>
<p>(Latent Dirichlet Allocation)</p>
<ul>
<li>Model the data as observations that arise from a generative probabilistic process that includes hidden variables (topics/themes)</li>
<li>Infer the hidden structure using posterior inference</li>
</ul>
<h1 id="textrank"><a class="header" href="#textrank"><strong>TextRank</strong></a></h1>
<p>Inspired from PageRank</p>
<p>Construct a (cosine) similarity matrix by comparing their <strong>vector representations</strong> (summing/average of all word embeddings in every sentence).</p>
<div class="table-wrapper"><table><thead><tr><th></th><th>Sentence1</th><th>Sentence2</th><th>Sentence3</th></tr></thead><tbody>
<tr><td>Sentence1</td><td></td><td></td><td></td></tr>
<tr><td>Sentence2</td><td></td><td></td><td></td></tr>
<tr><td>Sentence3</td><td></td><td></td><td></td></tr>
</tbody></table>
</div>
<p>Construct a (cosine) similarity matrix by comparing their <strong>vector representations</strong> or other word occurrences methods.</p>
<div class="table-wrapper"><table><thead><tr><th></th><th>Word1</th><th>Word2</th><th>Word3</th></tr></thead><tbody>
<tr><td>Word1</td><td></td><td></td><td></td></tr>
<tr><td>Word2</td><td></td><td></td><td></td></tr>
<tr><td>Word3</td><td></td><td></td><td></td></tr>
</tbody></table>
</div>
<p>Lastly, rank.</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="sequence-modelling"><a class="header" href="#sequence-modelling">Sequence modelling</a></h1>
<ul>
<li><a href="language/sequence-modelling.html#motivation">Motivation</a></li>
<li><a href="language/sequence-modelling.html#sequence-modelling-design-criteria">Sequence modelling design criteria</a></li>
<li><a href="language/sequence-modelling.html#backpropagation-through-time">Backpropagation through time</a></li>
<li><a href="language/sequence-modelling.html#lstms-and-grus">LSTMs and GRUs</a></li>
<li><a href="language/sequence-modelling.html#attention">Attention</a></li>
</ul>
<h2 id="motivation-1"><a class="header" href="#motivation-1">Motivation</a></h2>
<p>Bag-of-words has no order</p>
<h2 id="sequence-modelling-design-criteria"><a class="header" href="#sequence-modelling-design-criteria">Sequence modelling design criteria</a></h2>
<p>The model must be able to</p>
<ul>
<li>Handle variable-length sequence</li>
<li>Maintain information about the order</li>
<li>Share parameters across the sequence</li>
<li>Track long-term dependencies</li>
</ul>
<h2 id="backpropagation-through-time"><a class="header" href="#backpropagation-through-time">Backpropagation through time</a></h2>
<p>Backpropagation through time involves many multiplication of the weight matrices and gradient such that</p>
<ul>
<li>Many values &gt; 1: exploding gradients</li>
</ul>
<p>Gradient clipping</p>
<ul>
<li>Many values &lt; 1: vanishing gradients</li>
</ul>
<p>Activation function - use ReLU</p>
<p>Weight initialisation - weights to Identity matrix ?, bias to zero</p>
<p>Network architecture - gates cells</p>
<h2 id="lstms-and-grus"><a class="header" href="#lstms-and-grus">LSTMs and GRUs</a></h2>
<p>Information is added or removed through structures called gates.</p>
<ol>
<li>Forget</li>
<li>Store</li>
<li>Update</li>
<li>Output</li>
</ol>
<p><img src="language/./rnn-gru-lstm.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/93cae719-3dcc-4f3b-9b3d-b9504524e787/Untitled.png" /></p>
<h2 id="attention"><a class="header" href="#attention">Attention</a></h2>
<p>Decoder has access to all the states in the encoder. Network places attention on different parts of the input sentence.</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="ner"><a class="header" href="#ner">NER</a></h1>
<p>Named Entity Recognition</p>
<ul>
<li>CoNLL</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="sentiment-analysis"><a class="header" href="#sentiment-analysis">Sentiment analysis</a></h1>
<ul>
<li>SST (Stanford sentiment treebank)</li>
<li>IMDB</li>
<li>Yelp</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="qa"><a class="header" href="#qa">QA</a></h1>
<ul>
<li>Stanford Question Answering Dataset (SQuAD)</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="summarisation"><a class="header" href="#summarisation">Summarisation</a></h1>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="machine-translation"><a class="header" href="#machine-translation">Machine translation</a></h1>
<h1 id="terminologies"><a class="header" href="#terminologies">Terminologies</a></h1>
<p>Source language</p>
<p>Target language</p>
<p>parallel corpus / bi texts - a pair of texts such that one is a translation of the other</p>
<p>Deceptive cognates</p>
<p>Syntactic duplicates</p>
<p>Morphology - analysis of structure of words</p>
<p>Syntax - analysis of structure of sentence</p>
<p>Syntactic analysis - an analysis of the relative grammatical function of different words in the sentence</p>
<p>Lemma - dictionary form</p>
<p>Word sense - no of meanings per word</p>
<p>“Stemming” - get pseudo roots (Porter stemming, 1980)</p>
<p>pivot language - an intermediate natural language</p>
<p>interlingua - an artificial language with abstract representation</p>
<p>polysemy - coexistence of many possible meanings for a word/phrase</p>
<p>sentence alignment</p>
<p><img src="language/./machine-translation-1.jpg" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c5e95722-0bab-474c-b5ed-90637c16914d/8_13_12_7_1.jpg" /></p>
<h1 id="theories"><a class="header" href="#theories">Theories</a></h1>
<ul>
<li>Meaning is not formally defined but corresponds to the way words are used</li>
<li>It should respect the main characteristics of the original text, the tone and style, details of its ideas, overall structure</li>
</ul>
<h1 id="examples"><a class="header" href="#examples">Examples</a></h1>
<p>The chicken is ready to eat</p>
<p>There was not a single man at the party</p>
<h1 id="history"><a class="header" href="#history">History</a></h1>
<p>Rule-Based</p>
<ul>
<li>direct translation system</li>
<li>transfer system</li>
<li>interlingua</li>
</ul>
<p>1940s - idea of autatic translation</p>
<p>1940s-1960s - advent of computers. naive approaches</p>
<p>1965-1990 nothing afterv alpac report</p>
<p>1990s - Statistical Machine Translation</p>
<p>2014 - Neural Machine Translation</p>
<h1 id="example-based-translation"><a class="header" href="#example-based-translation"><strong>Example-based translation</strong></a></h1>
<p>translation by analogy</p>
<p>translate: training is not the solution to every problem</p>
<p><img src="language/./machine-translation-2.jpg" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/73eb64d5-41fa-41ba-bffd-300eb2d8211c/The_system_tries_to_find_translational_equivalents.jpg" /></p>
<h1 id="statistical-machine-translation"><a class="header" href="#statistical-machine-translation"><strong>Statistical machine translation</strong></a></h1>
<p>using word alignment</p>
<ol>
<li>Word-based translation</li>
<li>Phrase-based translation</li>
<li>Syntax-based translation</li>
<li>Hierarchical phrase-based translation</li>
</ol>
<p><strong>IBM Model 1</strong></p>
<p>all initial alignments have equal probability</p>
<p><strong>IBM Model 2</strong></p>
<p>take into account relative positions</p>
<p><strong>IBM Model 3</strong></p>
<p>take into account 1-n correspondences</p>
<p><strong>IBM Model 4</strong></p>
<p>consider moveable parts of a sentence</p>
<p><strong>IBM Model 5</strong></p>
<p>higher accuracy due to more complex calculations</p>
<h1 id="segment-based-machine-translation"><a class="header" href="#segment-based-machine-translation">Segment-based machine translation</a></h1>
<h1 id="neural-machine-translation"><a class="header" href="#neural-machine-translation">Neural machine t<strong>ranslation</strong></a></h1>
<p>Back translation</p>
<p>Translate from target language to source language</p>
<p>Sentence alignment:</p>
<p>two documents. Align the sentence so that we have sentence-level training examples</p>
<h2 id="models-1"><a class="header" href="#models-1"><strong>Models</strong></a></h2>
<ul>
<li>Translation language modelling: MLM pre-training has been extended to the multilingual setting by modifying MLM training to include concatenated translation pairs</li>
</ul>
<ol>
<li>Seq2seq with attention</li>
<li>Transformer</li>
<li>Conv Seq2Seq</li>
<li>Unsupervised MT</li>
<li>LASER, from facebook (multilingual sentence embedding)</li>
<li><a href="https://huggingface.co/transformers/model_doc/marian.html">MarianMT</a> (1000 models)</li>
<li><a href="https://github.com/facebookresearch/XLM">XLM</a></li>
</ol>
<h2 id="metrics-3"><a class="header" href="#metrics-3"><strong>Metrics</strong></a></h2>
<p>BLEU - Bilingual Evaluation Understudy Score: metric for evaluating a generated sentence to a reference sentence.</p>
<h1 id="datasets-1"><a class="header" href="#datasets-1"><strong>Datasets</strong></a></h1>
<ul>
<li>WMT (Workshop on Statistical Machine Translation)</li>
<li>OPUS <a href="http://opus.nlpl.eu/">http://opus.nlpl.eu</a></li>
<li>CCMatrix</li>
<li>CCAligned</li>
<li>ParaCrawl</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="coreference"><a class="header" href="#coreference">Coreference</a></h1>
<p>Datasets:</p>
<ul>
<li>Winogrande</li>
<li>DPR</li>
<li>WSC273</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="reading-comprehension"><a class="header" href="#reading-comprehension">Reading comprehension</a></h1>
<ul>
<li>SQuAD</li>
<li>DROP</li>
<li>OBQA</li>
<li>BoolQ</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="paraphrase"><a class="header" href="#paraphrase">Paraphrase</a></h1>
<ul>
<li>MRPC</li>
<li>QQP</li>
<li>PAWS</li>
<li>STS-B</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="commonsense"><a class="header" href="#commonsense">Commonsense</a></h1>
<p>Datasets:</p>
<ul>
<li>CoPA</li>
<li>HellaSwag</li>
<li>PiQA</li>
<li>StoryCloze</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="nli"><a class="header" href="#nli">NLI</a></h1>
<p>Datasets:</p>
<ul>
<li>MNLI</li>
<li>ANLI</li>
<li>CB</li>
<li>RTE</li>
<li>SNLI</li>
<li>WNLI</li>
<li>QNLI</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="language-models"><a class="header" href="#language-models">Language models</a></h1>
<h2 id="autoregressive-lm"><a class="header" href="#autoregressive-lm">Autoregressive LM</a></h2>
<p>In this language model, every possible word is dependent on the previous word.</p>
<p>The joint probability of a sequence of words <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is given by:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.406em;vertical-align:-2.953em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.453em;"><span style="top:-6.4413em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-4.9413em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"></span></span><span style="top:-2.453em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.953em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.453em;"><span style="top:-6.4413em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-2.453em;"><span class="pstrut" style="height:3.8283em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.953em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<blockquote>
<p>The Bidirectional LM is also based on autoregressive LM.</p>
</blockquote>
<h2 id="contextual-lm"><a class="header" href="#contextual-lm">Contextual LM</a></h2>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.106em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="pretraining-tasks-1"><a class="header" href="#pretraining-tasks-1">Pretraining tasks</a></h1>
<p><code>[MASK]</code> tokens are tokens to predict</p>
<p><strong>(Traditional) Language modeling (LM)</strong></p>
<p>Given a word, predict the next word.</p>
<p>Egs: GPT-X, Transformer XL</p>
<p><strong>Masked language modeling (MLM)</strong></p>
<p>Erase some words randomly in the input, then predict the erased words during pretraining.</p>
<p>Egs: BERT, SpanBERT</p>
<p><strong>Next Sentence Prediction (NSP)</strong></p>
<p>??? (how is this different from SOP?)</p>
<p>Egs: BERT</p>
<p><strong>Sentence Order Prediction (SOP)</strong></p>
<p>Predict if two sentences are contiguous. Positive samples are contiguous fragments from a document; negative samples are the reverse order.</p>
<p>Egs: ALBERT</p>
<p><strong>Denoising autoencoder (DAE)</strong></p>
<p>Add noise to the input, reconstruct the input containing the noise. Noise includes erasing words, shuffling.</p>
<p>Egs: BART, Pegasus</p>
<p><strong>Permuted language modeling (PLM)</strong></p>
<p>??</p>
<p>Egs: XLNet</p>
<p><a href="https://arxiv.org/abs/2302.07730">Transformer models: an introduction and catalog</a></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="fine-tuning"><a class="header" href="#fine-tuning">Fine-tuning</a></h1>
<ul>
<li>
<p>Task-specific</p>
</li>
<li>
<p>Instruction-tuning / instruction fine-tuning <sup class="footnote-reference"><a href="#instructgpt">1</a></sup></p>
<p>Creating a dataset of instructions from scratch to fine-tune the model would take a considerable amount of resources. Therefore, we instead make use of templates to transform existing datasets into an instructional format.<sup class="footnote-reference"><a href="#flan">2</a></sup></p>
<p>Instruction-tuned language models demonstrate a remarkable ability to generalise zero-shot to new tasks.</p>
<p>Example: FLAN — Fine-tuned LAnguage Net</p>
</li>
<li>
<p>Though process fine-tuning <sup class="footnote-reference"><a href="#thoughtprocess">3</a></sup></p>
<p>Decompose the problem into steps</p>
</li>
<li>
<p>PaL (Program-aided Language) <sup class="footnote-reference"><a href="#pal">4</a></sup></p>
<p>Decompose the problem into <em>programmatic</em> steps</p>
</li>
<li>
<p>RLHF (Reinforcement Learning from Human Feedback)</p>
</li>
</ul>
<hr />
<div class="footnote-definition" id="instructgpt"><sup class="footnote-definition-label">1</sup>
<p><a href="https://arxiv.org/pdf/2203.02155.pdf">Training language models to follow instructions with human feedback</a></p>
</div>
<div class="footnote-definition" id="flan"><sup class="footnote-definition-label">2</sup>
<p><a href="https://ai.googleblog.com/2021/10/introducing-flan-more-generalizable.html">Flan</a></p>
</div>
<div class="footnote-definition" id="thoughtprocess"><sup class="footnote-definition-label">3</sup>
<p><a href="https://arxiv.org/abs/2006.06609">Leap-Of-Thought: Teaching Pre-Trained Models to Systematically Reason Over Implicit Knowledge</a></p>
</div>
<div class="footnote-definition" id="pal"><sup class="footnote-definition-label">4</sup>
<p><a href="https://arxiv.org/abs/2211.10435">PAL: Program-aided Language Models</a></p>
</div>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="models-2"><a class="header" href="#models-2">Models</a></h1>
<p>&quot;Foundation language models&quot; / PFM (Pretrained Foundation Models) / LLMs (Large Language Models)</p>
<div class="table-wrapper"><table><thead><tr><th>Year</th><th>Model</th><th>Arch</th><th>Pretraining</th><th>Params</th><th>Applications</th></tr></thead><tbody>
<tr><td>2023</td><td>GPT-4</td><td>?</td><td>?</td><td></td><td></td></tr>
<tr><td></td><td>Alpaca</td><td>?</td><td>?</td><td></td><td>Instruction-following</td></tr>
<tr><td></td><td>LLaMA</td><td>?</td><td>?</td><td>7B,13B,65B</td><td>?</td></tr>
<tr><td></td><td>OpenChatKit</td><td>?</td><td>?</td><td>?</td><td>?</td></tr>
<tr><td>2022</td><td>GPT-3.5</td><td>Decoder</td><td>LM</td><td>175B</td><td>Code generation, dialog</td></tr>
<tr><td></td><td>GPT-NeoX-20B <sup class="footnote-reference"><a href="#gptneox">1</a></sup></td><td>?</td><td></td><td></td><td></td></tr>
<tr><td></td><td>OPT</td><td>?</td><td></td><td></td><td></td></tr>
<tr><td></td><td>LAMDA</td><td>Decoder</td><td>LM</td><td>137B</td><td>General language modelling</td></tr>
<tr><td></td><td>ChatGPT</td><td>Decoder</td><td>LM</td><td>175B</td><td>Dialog</td></tr>
<tr><td></td><td>BLOOM</td><td>Decoder</td><td>LM</td><td>176B</td><td>Code generation</td></tr>
<tr><td></td><td>Minerva</td><td>Decoder</td><td>LM</td><td>540B</td><td>Mathematical reasoning</td></tr>
<tr><td></td><td>Chinchilla</td><td>Decoder</td><td>LM</td><td>70B</td><td>Dialog</td></tr>
<tr><td></td><td>PaLM <sup class="footnote-reference"><a href="#palm">2</a></sup></td><td>Decoder</td><td>LM</td><td>62B,540B</td><td>(general language tasks)</td></tr>
<tr><td>2021</td><td>HTML</td><td>Encoder/Decoder</td><td>DAE</td><td>400M</td><td>HTML prompting</td></tr>
<tr><td></td><td>Gopher <sup class="footnote-reference"><a href="#gopher">3</a></sup></td><td>Decoder</td><td>LM</td><td>280B</td><td>General language modelling</td></tr>
<tr><td>2020</td><td>GPT-3<sup class="footnote-reference"><a href="#gpt3">4</a></sup></td><td>Decoder</td><td>LM</td><td>175B</td><td>Code generation, audio generation</td></tr>
<tr><td></td><td>Big Bird</td><td>Encoder</td><td>MLM</td><td>-</td><td>Longer sequence</td></tr>
<tr><td></td><td>ELECTRA</td><td>Encoder</td><td>RTD</td><td>110M-330M</td><td>Longer sequence</td></tr>
<tr><td></td><td>mBART</td><td>Encoder/Decoder</td><td>DAE</td><td>110M</td><td>Translation</td></tr>
<tr><td>2019</td><td>XLM-RoBERTa</td><td>Encoder</td><td>MLM</td><td>270M-550M</td><td>Translation, cross-lingual tasks</td></tr>
<tr><td></td><td>BART</td><td>Encoder/Decoder</td><td>DAE</td><td>110M</td><td>Text generation</td></tr>
<tr><td></td><td>ERNIE</td><td>Encoder</td><td>MLM</td><td>114M</td><td>Entity recognition</td></tr>
<tr><td></td><td>GPT-2</td><td>Decoder</td><td>LM</td><td>1.5B</td><td>Text generation, (general language tasks)</td></tr>
<tr><td></td><td>Transformer XL</td><td>Decoder</td><td>LM</td><td>151M</td><td>(general language tasks)</td></tr>
<tr><td></td><td>RoBERTA</td><td>Encoder</td><td>MLM</td><td>356M</td><td>Language understading, QA</td></tr>
<tr><td></td><td>T5</td><td>Encoder/Decoder</td><td>DAE</td><td>11B</td><td>MT, QA, abstractive summarisation</td></tr>
<tr><td></td><td>Pegasus</td><td>Encoder/Decoder</td><td>DAE,MLM</td><td>223M-568M</td><td>Summarisation</td></tr>
<tr><td></td><td>ALBERT</td><td>Encoder</td><td>MLM/NSP</td><td>12M-60M</td><td>Language understading, QA</td></tr>
<tr><td></td><td>DistilBERT</td><td>Encoder</td><td>MLM/NSP</td><td>66M</td><td>Language understading, QA</td></tr>
<tr><td></td><td>XLNet</td><td>Decoder</td><td>PLM</td><td>117-360M</td><td>(general language tasks)</td></tr>
<tr><td>2018</td><td>BERT</td><td>Encoder</td><td>MLM/NSP</td><td>110M</td><td>Language understading, QA</td></tr>
<tr><td></td><td>GPT</td><td>Decoder</td><td>LM</td><td>117M</td><td>Text generation</td></tr>
<tr><td>2017</td><td>Transformer</td><td>Encoder+Decoder</td><td></td><td></td><td></td></tr>
<tr><td>?</td><td>ELMO</td><td>RNN</td><td>LM</td><td></td><td></td></tr>
<tr><td>?</td><td>seq2seq</td><td>RNN</td><td></td><td></td><td></td></tr>
<tr><td>?</td><td>UniLM</td><td>?</td><td></td><td></td><td></td></tr>
<tr><td>?</td><td>ERNIE</td><td>?</td><td></td><td></td><td></td></tr>
</tbody></table>
</div>
<p>Encoder or Decoder refers to the Transformer encoder or decoder.</p>
<hr />
<div class="footnote-definition" id="gptneox"><sup class="footnote-definition-label">1</sup>
<p><a href="https://arxiv.org/abs/2204.06745">GPT-NeoX-20B: An Open-Source Autoregressive Language Model</a>
<sup class="footnote-reference"><a href="#palm">2</a></sup>: <a href="https://arxiv.org/abs/2204.02311">PaLM: Scaling Language Modeling with Pathways</a>
<sup class="footnote-reference"><a href="#gopher">3</a></sup>: <a href="https://arxiv.org/abs/2112.11446">Scaling Language Models: Methods, Analysis &amp; Insights from Training Gopher</a>
<sup class="footnote-reference"><a href="#gpt3">4</a></sup>: <a href="https://arxiv.org/abs/2005.14165">Language Models are Few-Shot Learners</a></p>
</div>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="prompting"><a class="header" href="#prompting">Prompting</a></h1>
<p>Pre-trained language models can solve tasks using zero-shot or few-shot prompting as in the paper <a href="https://arxiv.org/abs/2005.14165">Language Models are Few-Shot Learners</a>.</p>
<p>This technique requires <em>prompt engineering</em> — designing tasks that look like the data the model has seen during training.</p>
<ul>
<li>Chain-of-Thought <sup class="footnote-reference"><a href="#cot">1</a></sup></li>
<li>Retrieval-Augemented QA</li>
<li>Self-Ask - (<a href="https://ofir.io/self-ask.pdf">Press et al 2022</a>)</li>
</ul>
<hr />
<div class="footnote-definition" id="cot"><sup class="footnote-definition-label">1</sup>
<p><a href="https://arxiv.org/abs/2201.11903">Chain-of-Thought Prompting Elicits Reasoning in Large Language Models</a></p>
</div>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="digital-signal-processing"><a class="header" href="#digital-signal-processing">Digital signal processing</a></h1>
<p>Terminologies</p>
<ul>
<li>
<p>Bit depth</p>
<p>How many different values that can be recorded. 8/16/32/64-bit</p>
</li>
<li>
<p>Sampling rate = sample frequency</p>
<p>No of readings per second. 44.1kHz (CD Quality audio), 48, 96kHz</p>
</li>
<li>
<p>Bit rate</p>
<p>No. Of bits encoded per sample per second. Bits per second. 64-128 kbps</p>
<p>Bits per sample x samples per second x no. of channels</p>
</li>
<li>
<p>Bandwidth</p>
<p>Speed at which you can transmit data.</p>
</li>
<li>
<p>Channels</p>
<p>1 = mono. 2 = stereo.</p>
<p>librosa automatically combines into mono</p>
</li>
<li>
<p>File size</p>
<p>Bit rate x duration / 8</p>
<p>Formats</p>
<p>Aac</p>
<p>Mo3</p>
<p>Wav - uncompressed</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="models-3"><a class="header" href="#models-3">Models</a></h1>
<div class="table-wrapper"><table><thead><tr><th>Year</th><th>Model</th><th>Arch</th><th>Pretraining</th><th>Params</th><th>Applications</th></tr></thead><tbody>
<tr><td>2022</td><td>Whisper</td><td>Transformer</td><td>?</td><td>?</td><td>?</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="graph-analysis"><a class="header" href="#graph-analysis">Graph analysis</a></h1>
<ul>
<li><a href="graph-analysis.html#community-detection">Community detection</a>
<ul>
<li><a href="graph-analysis.html#hierarchical-clustering">Hierarchical clustering</a></li>
<li><a href="graph-analysis.html#girvan-newman-algorithm">Girvan-Newman algorithm</a></li>
</ul>
</li>
<li><a href="graph-analysis.html#ranking">Ranking</a>
<ul>
<li><a href="graph-analysis.html#pagerank">PageRank</a></li>
</ul>
</li>
</ul>
<hr />
<h2 id="community-detection"><a class="header" href="#community-detection">Community detection</a></h2>
<p>Note that data is a tuple of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mclose">)</span></span></span></span> (undirected?). (In usual clustering task with no edges, these graphs are called &quot;trivial graphs&quot;)</p>
<p>Partition network such that</p>
<ol>
<li>inter-group edges are sparse</li>
<li>intra-group edges are dense</li>
</ol>
<p><img src="./graph-analysis-1.png" alt="Graph analysis" /></p>
<h3 id="hierarchical-clustering"><a class="header" href="#hierarchical-clustering">Hierarchical clustering</a></h3>
<p>Define similarity between nodes</p>
<ul>
<li>no. of node disjoint paths ???</li>
<li>no. of edge disjoint paths ???</li>
<li>...</li>
</ul>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>?</p>
<p>Problem</p>
<h3 id="girvan-newman-algorithm"><a class="header" href="#girvan-newman-algorithm">Girvan-Newman algorithm</a></h3>
<p>Hierarchical divisive method. </p>
<ol>
<li>Start with whole graph</li>
<li>Find edge whose removal will partition the graph. Use edge betweenness.</li>
<li>Repeat until single nodes</li>
</ol>
<p>Edge betweenness </p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2519em;vertical-align:-0.8804em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">no. of shortest paths</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">no. of shortest paths that pass through a and b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>is a measure of edge importance, i.e. how important an edge is in keeping the graph connected such that if we cut this edge, it makes a lot of difference and will create more meaningful partitions. </p>
<aside>
💡 An inter-community edge has a higher betweenness than an intra-community edge.
</aside>
<p>Algorithm to compute edge betweenness</p>
<p>Time complexity <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord">∣</span><span class="mclose">)</span></span></span></span></p>
<ol>
<li>For a vertex, calculate betweenness of every edge <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord">∣</span><span class="mclose">)</span></span></span></span>.</li>
<li>Final score <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord">∣</span><span class="mclose">)</span></span></span></span>.</li>
<li>Remove the edge with the highest betweenness.</li>
<li>Repeat for the other edges. <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord">∣</span><span class="mclose">)</span></span></span></span>.</li>
</ol>
<h2 id="ranking"><a class="header" href="#ranking">Ranking</a></h2>
<p>Goal is to rank the nodes in a directed graph <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mclose">)</span></span></span></span>.</p>
<h3 id="pagerank"><a class="header" href="#pagerank">PageRank</a></h3>
<p>Limitations</p>
<ul>
<li>
<p>Dead end → Jump to a random page</p>
<p>from</p>
<pre><code class="language-python">0.5 0.5 0  
0.5   0 0
  0 0.5 0
</code></pre>
<p>to</p>
<pre><code class="language-python">0.5 0.5 0.33
0.5   0 0.33
  0 0.5 0.33
</code></pre>
</li>
<li>
<p>Spider trap → Teleport</p>
</li>
<li>
<p>Measures generic popularity of a page → <strong>Topic-specific PageRank</strong></p>
</li>
<li>
<p>Only 1 measure of importance → <strong>Hubs-and-Authorities</strong></p>
</li>
<li>
<p>Susceptible to link spam → <strong>TrustRank</strong></p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="models-4"><a class="header" href="#models-4">Models</a></h1>
<h1 id="models-5"><a class="header" href="#models-5">Models</a></h1>
<div class="table-wrapper"><table><thead><tr><th>Year</th><th>Model</th><th>Modes</th><th>Architecture</th><th>Params</th></tr></thead><tbody>
<tr><td></td><td>Graph Transformer Network</td><td></td><td></td><td></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="pretraining-tasks-2"><a class="header" href="#pretraining-tasks-2">Pretraining tasks</a></h1>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="models-6"><a class="header" href="#models-6">Models</a></h1>
<p>Keywords: MLLM (Multimodal Large Language Model)</p>
<div class="table-wrapper"><table><thead><tr><th>Year</th><th>Model</th><th>Modes</th><th>Architecture</th><th>Params</th></tr></thead><tbody>
<tr><td>2023</td><td>PaLM-E <sup class="footnote-reference"><a href="#palme">1</a></sup></td><td>Vison + language + planning (robotic)</td><td></td><td>562B</td></tr>
<tr><td></td><td>USM <sup class="footnote-reference"><a href="#usm">2</a></sup></td><td>Audio</td><td></td><td></td></tr>
<tr><td></td><td>Kosmos-1 <sup class="footnote-reference"><a href="#kosmos1">3</a></sup></td><td>Vision + language</td><td></td><td></td></tr>
<tr><td></td><td>Flamingo</td><td></td><td></td><td></td></tr>
<tr><td></td><td>PaLI</td><td></td><td></td><td></td></tr>
<tr><td>2022</td><td>DALL•E 2</td><td>Vision + text</td><td>Transformer</td><td></td></tr>
<tr><td>2022</td><td>Stable Diffusion</td><td>Vision + text</td><td></td><td></td></tr>
<tr><td>2021</td><td>DALL•E</td><td>Vision + language</td><td>Transformer</td><td></td></tr>
<tr><td></td><td>CLIP <sup class="footnote-reference"><a href="#clip">4</a></sup></td><td>Vision + language</td><td>Transformer</td><td></td></tr>
<tr><td></td><td>Stable Diffusion</td><td>Vision + language</td><td></td><td></td></tr>
<tr><td></td><td>DALL•E</td><td>Vision + text</td><td>Transformer</td><td></td></tr>
<tr><td>?</td><td>GPT-3</td><td>Vision + language</td><td>Transformer</td><td></td></tr>
<tr><td>?</td><td>GPT</td><td>Vision + language</td><td>Transformer</td><td></td></tr>
<tr><td>2016</td><td>Show and Tell</td><td>Vision + text</td><td></td><td></td></tr>
</tbody></table>
</div>
<div class="footnote-definition" id="palme"><sup class="footnote-definition-label">1</sup>
<p><a href="https://palm-e.github.io/">PaLM-E: An Embodied Multimodal Language Model</a></p>
</div>
<div class="footnote-definition" id="usm"><sup class="footnote-definition-label">2</sup>
<p><a href="https://arxiv.org/abs/2303.01037">Google USM: Scaling Automatic Speech Recognition Beyond 100 Languages</a></p>
</div>
<div class="footnote-definition" id="kosmos1"><sup class="footnote-definition-label">3</sup>
<p><a href="https://arxiv.org/abs/230214045">Language Is Not All You Need: Aligning Perception with Language Models</a></p>
</div>
<div class="footnote-definition" id="clip"><sup class="footnote-definition-label">4</sup>
<p><a href="https://openai.com/blog/clip/">CLIP</a></p>
</div>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="loss-functions"><a class="header" href="#loss-functions">Loss functions</a></h1>
<ul>
<li><a href="loss-functions.html#mse-regression">MSE (regression)</a></li>
<li><a href="loss-functions.html#cross-entropy-loss-classification">Cross entropy loss (classification)</a>
<ul>
<li><a href="loss-functions.html#binary-cross-entropy-2-class">Binary cross entropy (2-class)</a></li>
</ul>
</li>
<li><a href="loss-functions.html#with-l2">With L2</a></li>
<li><a href="loss-functions.html#mle--map">MLE &amp; MAP</a></li>
<li><a href="loss-functions.html#l1">L1</a></li>
<li><a href="loss-functions.html#l2">L2</a></li>
<li><a href="loss-functions.html#label-smoothing">Label smoothing</a></li>
</ul>
<h2 id="mse-regression"><a class="header" href="#mse-regression">MSE (regression)</a></h2>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:9.06em;vertical-align:-4.28em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.7499em;"><span style="top:-6.7499em;"><span class="pstrut" style="height:11em;"></span><span style="width:0.667em;height:9.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='9.000em' viewBox='0 0 667 9000'><path d='M403 1759 V84 H666 V0 H319 V1759 v5400 v1759 h347 v-84 H403z M403 1759 V0 H319 V1759 v5400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.2501em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.78em;"><span style="top:-7.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-6.4275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.0275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span><span style="top:-2.1675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-0.9675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span><span style="top:0.2325em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.28em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.7499em;"><span style="top:-6.7499em;"><span class="pstrut" style="height:11em;"></span><span style="width:0.667em;height:9.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='9.000em' viewBox='0 0 667 9000'><path d='M347 1759 V0 H0 V84 H263 V1759 v5400 v1759 H0 v84 H347z M347 1759 V0 H263 V1759 v5400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.2501em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2583em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:10.26em;vertical-align:-4.88em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.3499em;"><span style="top:-7.3499em;"><span class="pstrut" style="height:12.2em;"></span><span style="width:0.667em;height:10.200em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='10.200em' viewBox='0 0 667 10200'><path d='M403 1759 V84 H666 V0 H319 V1759 v6600 v1759 h347 v-84 H403z M403 1759 V0 H319 V1759 v6600 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.8501em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.38em;"><span style="top:-8.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-7.0275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span><span style="top:-2.7675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span><span style="top:-0.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:0.8325em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.88em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.38em;"><span style="top:-7.54em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-5.14em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:0.32em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.68em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.38em;"><span style="top:-7.54em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">...</span></span></span><span style="top:-5.14em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">...</span></span></span><span style="top:0.32em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">...</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.68em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.38em;"><span style="top:-7.54em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-5.14em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:0.32em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.68em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.3499em;"><span style="top:-7.3499em;"><span class="pstrut" style="height:12.2em;"></span><span style="width:0.667em;height:10.200em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='10.200em' viewBox='0 0 667 10200'><path d='M347 1759 V0 H0 V84 H263 V1759 v6600 v1759 H0 v84 H347z M347 1759 V0 H263 V1759 v6600 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.8501em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">×</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:9.06em;vertical-align:-4.28em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.7499em;"><span style="top:-6.7499em;"><span class="pstrut" style="height:11em;"></span><span style="width:0.667em;height:9.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='9.000em' viewBox='0 0 667 9000'><path d='M403 1759 V84 H666 V0 H319 V1759 v5400 v1759 h347 v-84 H403z M403 1759 V0 H319 V1759 v5400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.2501em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.78em;"><span style="top:-7.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-6.4275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.0275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span><span style="top:-2.1675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-0.9675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span><span style="top:0.2325em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.28em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.7499em;"><span style="top:-6.7499em;"><span class="pstrut" style="height:11em;"></span><span style="width:0.667em;height:9.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='9.000em' viewBox='0 0 667 9000'><path d='M347 1759 V0 H0 V84 H263 V1759 v5400 v1759 H0 v84 H347z M347 1759 V0 H263 V1759 v5400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.2501em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>General:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2519em;vertical-align:-0.8804em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p><strong>univariate, 1 example</strong></p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:10.6649em;vertical-align:-5.0824em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.5824em;"><span style="top:-8.1139em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span><span style="top:-6.6139em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"></span></span><span style="top:-4.6324em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord mathnormal">L</span></span></span><span style="top:-2.8064em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"></span></span><span style="top:-0.775em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:1.051em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.0824em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.5824em;"><span style="top:-8.1139em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">x</span></span></span><span style="top:-4.6324em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-0.775em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:1em;"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5824em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><strong>univariate, multiple examples</strong></p>
<p>?</p>
<p><strong>multivariate, 1 example</strong></p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:10.724em;vertical-align:-5.112em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.612em;"><span style="top:-8.0843em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span><span style="top:-6.5843em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"></span></span><span style="top:-4.6029em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord mathnormal">L</span></span></span><span style="top:-2.7769em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"></span></span><span style="top:-0.7454em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:1.0806em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.112em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.612em;"><span style="top:-8.0843em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-2.453em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">×</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3053em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">×</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6029em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-0.7454em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:1em;"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.612em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><strong>multivariate, multiple examples</strong></p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:9.1649em;vertical-align:-4.3324em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.8324em;"><span style="top:-7.3639em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span></span></span><span style="top:-5.8639em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"></span></span><span style="top:-3.8824em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span></span></span><span style="top:-2.0564em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"></span></span><span style="top:-0.025em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.3324em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.8324em;"><span style="top:-7.3639em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2583em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">×</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.8824em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathnormal">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7079em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span></span><span style="top:-3.0134em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7079em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span></span><span style="top:-3.0134em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class="mclose">)</span></span></span><span style="top:-0.025em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7079em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span></span><span style="top:-3.0134em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.3324em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="cross-entropy-loss-classification"><a class="header" href="#cross-entropy-loss-classification">Cross entropy loss (classification)</a></h2>
<p>Binary cross entropy / negative log loss</p>
<p>Formulated by Claude Shannon, this loss function compares how different two distributions (true and predicted) are.</p>
<p><img src="./loss-regularisation-01.png" alt="Cross entropy" /></p>
<p>Gradient descent with</p>
<ul>
<li>Logistic regression (= binary cross entropy)</li>
<li>Softmax regression ( = softmax cross entropy)</li>
</ul>
<blockquote>
<p>💡 Note that softmax cross entropy is a generalisation of binary cross entropy.</p>
</blockquote>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7469em;vertical-align:-0.3025em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">p</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.242em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">×</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3025em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:9.06em;vertical-align:-4.28em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.7499em;"><span style="top:-6.7499em;"><span class="pstrut" style="height:11em;"></span><span style="width:0.667em;height:9.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='9.000em' viewBox='0 0 667 9000'><path d='M403 1759 V84 H666 V0 H319 V1759 v5400 v1759 h347 v-84 H403z M403 1759 V0 H319 V1759 v5400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.2501em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.78em;"><span style="top:-7.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-6.4275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.0275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span><span style="top:-2.1675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-0.9675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span><span style="top:0.2325em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.28em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.7499em;"><span style="top:-6.7499em;"><span class="pstrut" style="height:11em;"></span><span style="width:0.667em;height:9.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='9.000em' viewBox='0 0 667 9000'><path d='M347 1759 V0 H0 V84 H263 V1759 v5400 v1759 H0 v84 H347z M347 1759 V0 H263 V1759 v5400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.2501em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">p</span></span></span></span></span></span> is vector of logits with <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> classes.</p>
<p>General:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2519em;vertical-align:-0.8804em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">p</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<h3 id="binary-cross-entropy-2-class"><a class="header" href="#binary-cross-entropy-2-class">Binary cross entropy (2-class)</a></h3>
<p><strong>univariate, 1 example</strong></p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:12.8574em;vertical-align:-6.1787em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.6787em;"><span style="top:-9.2102em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span><span style="top:-7.7102em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"></span></span><span style="top:-6.2102em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span><span style="top:-4.7102em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"></span></span><span style="top:-3.2102em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord mathnormal">L</span></span></span><span style="top:-1.7102em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"></span></span><span style="top:0.3213em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:2.1473em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.1787em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.6787em;"><span style="top:-9.2102em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">x</span></span></span><span style="top:-6.2102em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span><span style="top:-3.2102em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span><span style="top:0.3213em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord mathnormal">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.6787em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><strong>univariate, many examples</strong></p>
<p><strong>multivariate, 1 example</strong></p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:12.9165em;vertical-align:-6.2083em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.7083em;"><span style="top:-9.1806em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span><span style="top:-7.6806em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"></span></span><span style="top:-6.1806em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span><span style="top:-4.6806em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"></span></span><span style="top:-3.1806em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord mathnormal">L</span></span></span><span style="top:-1.6806em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"></span></span><span style="top:0.3508em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord text"><span class="mord textbf">w</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:2.1768em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.2083em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.7083em;"><span style="top:-9.1806em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord textbf">w</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord textbf">x</span></span></span></span><span style="top:-6.1806em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span><span style="top:-3.1806em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span><span style="top:0.3508em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord text"><span class="mord textbf">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.7083em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><strong>multivariate, many examples</strong></p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:12.1649em;vertical-align:-5.8324em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.3324em;"><span style="top:-8.8639em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord text"><span class="mord textbf">z</span></span></span></span><span style="top:-7.3639em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"></span></span><span style="top:-5.8639em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord text"><span class="mord textbf">p</span></span></span></span><span style="top:-4.3639em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"></span></span><span style="top:-2.3824em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span></span></span><span style="top:-0.5564em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"></span></span><span style="top:1.475em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord text"><span class="mord textbf">w</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.8324em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.3324em;"><span style="top:-8.8639em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord text"><span class="mord textbf">w</span></span></span></span><span style="top:-5.8639em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord text"><span class="mord textbf">z</span></span><span class="mclose">)</span></span></span><span style="top:-2.3824em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord">−</span><span class="mord"><span class="mord text"><span class="mord textbf">y</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord textbf">p</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord textbf">y</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord textbf">p</span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span><span style="top:1.475em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord text"><span class="mord textbf">p</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord textbf">y</span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.8324em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="with-l2"><a class="header" href="#with-l2">With L2</a></h2>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:17.6314em;vertical-align:-8.5657em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:9.0657em;"><span style="top:-11.538em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span><span style="top:-10.038em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"></span></span><span style="top:-8.538em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span><span style="top:-7.038em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"></span></span><span style="top:-5.0066em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord mathnormal">L</span></span></span><span style="top:-3.1806em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"></span></span><span style="top:-1.1492em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord mathnormal">L</span></span></span><span style="top:0.6768em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"></span></span><span style="top:2.7083em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord text"><span class="mord textbf">w</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:4.5343em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:8.5657em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:9.0657em;"><span style="top:-11.538em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord textbf">w</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord textbf">x</span></span></span></span><span style="top:-8.538em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span><span style="top:-5.0066em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">λ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∣∣</span><span class="mord text"><span class="mord textbf">w</span></span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.1492em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">λ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">...</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:2.7083em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord text"><span class="mord textbf">x</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">λ</span><span class="mord text"><span class="mord textbf">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:7.0657em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<hr />
<h2 id="mle--map"><a class="header" href="#mle--map">MLE &amp; MAP</a></h2>
<ul>
<li>All the loss functions below use MLE (???)</li>
<li>L2 regularisation (not sure about L1) is actually finding the <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> of a distribution whose prior on <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span> is a normal distribution! (MAP interpretation is we are maximising a combination of prior and likelihood functions).</li>
</ul>
<h2 id="l1"><a class="header" href="#l1">L1</a></h2>
<h2 id="l2"><a class="header" href="#l2">L2</a></h2>
<p>Given <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.5</span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2251em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2251em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∣∣</span><span class="mord text"><span class="mord">w</span></span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>, find the final <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span> after one SGD update.</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣∣</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord">∣∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="label-smoothing"><a class="header" href="#label-smoothing">Label smoothing</a></h2>
<p><strong>Binary / categorical cross entropy:</strong></p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7858em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">true(hard)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:6em;vertical-align:-2.75em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='6.000em' viewBox='0 0 667 6000'><path d='M403 1759 V84 H666 V0 H319 V1759 v2400 v1759 h347 v-84 H403z M403 1759 V0 H319 V1759 v2400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='6.000em' viewBox='0 0 667 6000'><path d='M347 1759 V0 H0 V84 H263 V1759 v2400 v1759 H0 v84 H347z M347 1759 V0 H263 V1759 v2400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">pred</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:6em;vertical-align:-2.75em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='6.000em' viewBox='0 0 667 6000'><path d='M403 1759 V84 H666 V0 H319 V1759 v2400 v1759 h347 v-84 H403z M403 1759 V0 H319 V1759 v2400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.3</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.5</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='6.000em' viewBox='0 0 667 6000'><path d='M347 1759 V0 H0 V84 H263 V1759 v2400 v1759 H0 v84 H347z M347 1759 V0 H263 V1759 v2400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">loss</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord">0.2</span><span class="mclose">)</span></span></span></span></span></p>
<p><strong>Cross entropy with label smoothing regularisation:</strong></p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7858em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">true(smooth)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:6em;vertical-align:-2.75em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='6.000em' viewBox='0 0 667 6000'><path d='M403 1759 V84 H666 V0 H319 V1759 v2400 v1759 h347 v-84 H403z M403 1759 V0 H319 V1759 v2400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.1</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.1</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='6.000em' viewBox='0 0 667 6000'><path d='M347 1759 V0 H0 V84 H263 V1759 v2400 v1759 H0 v84 H347z M347 1759 V0 H263 V1759 v2400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">pred</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:6em;vertical-align:-2.75em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='6.000em' viewBox='0 0 667 6000'><path d='M403 1759 V84 H666 V0 H319 V1759 v2400 v1759 h347 v-84 H403z M403 1759 V0 H319 V1759 v2400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.3</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.5</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='6.000em' viewBox='0 0 667 6000'><path d='M347 1759 V0 H0 V84 H263 V1759 v2400 v1759 H0 v84 H347z M347 1759 V0 H263 V1759 v2400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">loss</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">0.1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord">0.3</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord">0.5</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord">0.2</span><span class="mclose">)</span></span></span></span></span></p>
<p><strong>with smoothing parameter <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.3</span></span></span></span> such that</strong></p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7858em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">true(smooth)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:6em;vertical-align:-2.75em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='6.000em' viewBox='0 0 667 6000'><path d='M403 1759 V84 H666 V0 H319 V1759 v2400 v1759 h347 v-84 H403z M403 1759 V0 H319 V1759 v2400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='6.000em' viewBox='0 0 667 6000'><path d='M347 1759 V0 H0 V84 H263 V1759 v2400 v1759 H0 v84 H347z M347 1759 V0 H263 V1759 v2400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:6em;vertical-align:-2.75em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='6.000em' viewBox='0 0 667 6000'><path d='M403 1759 V84 H666 V0 H319 V1759 v2400 v1759 h347 v-84 H403z M403 1759 V0 H319 V1759 v2400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='6.000em' viewBox='0 0 667 6000'><path d='M347 1759 V0 H0 V84 H263 V1759 v2400 v1759 H0 v84 H347z M347 1759 V0 H263 V1759 v2400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:6em;vertical-align:-2.75em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='6.000em' viewBox='0 0 667 6000'><path d='M403 1759 V84 H666 V0 H319 V1759 v2400 v1759 h347 v-84 H403z M403 1759 V0 H319 V1759 v2400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='6.000em' viewBox='0 0 667 6000'><path d='M347 1759 V0 H0 V84 H263 V1759 v2400 v1759 H0 v84 H347z M347 1759 V0 H263 V1759 v2400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:6em;vertical-align:-2.75em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='6.000em' viewBox='0 0 667 6000'><path d='M403 1759 V84 H666 V0 H319 V1759 v2400 v1759 h347 v-84 H403z M403 1759 V0 H319 V1759 v2400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.1</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.1</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='6.000em' viewBox='0 0 667 6000'><path d='M347 1759 V0 H0 V84 H263 V1759 v2400 v1759 H0 v84 H347z M347 1759 V0 H263 V1759 v2400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="metrics-4"><a class="header" href="#metrics-4">Metrics</a></h1>
<h2 id="mrr"><a class="header" href="#mrr">MRR</a></h2>
<p>Mean reciprocal rank</p>
<p>If MRR@10 is 0.8, it means on average (across users), and if I predict 10 items, the first relevant item will be located at position 1/0.8 = 8.</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="supervised-learning-2"><a class="header" href="#supervised-learning-2">Supervised learning</a></h1>
<p>Specifically for deep learning:</p>
<p>Given a labelled training dataset</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></span></p>
<p>minimise the objective function</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.106em;vertical-align:-1.2777em;"></span><span class="mop">ar<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-2.3479em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.03194em;">θ</span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7521em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">λ</span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Ω</span></span></span></span> is the regularisation term.</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="semi-supervised-learning"><a class="header" href="#semi-supervised-learning">Semi-supervised learning</a></h1>
<p>Specifically for deep learning:</p>
<p>Given a labelled training dataset</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></span></p>
<p>and another unlabelled dataset</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.04213em;">z</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.04213em;">z</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.04213em;">z</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span></p>
<p>minimise the objective function</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.106em;vertical-align:-1.2777em;"></span><span class="mop">ar<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-2.3479em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.03194em;">θ</span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7521em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.04213em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3353em;"><span style="top:-2.55em;margin-left:-0.0421em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord boldsymbol mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">λ</span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>where</p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Ω</span></span></span></span> is the regularisation term </li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> defines the targets for unlabelled data</li>
</ul>
<blockquote>
<p>Good for small amount of data and large amount of unlabelled data.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="weakly-supervised-learning"><a class="header" href="#weakly-supervised-learning">Weakly-supervised learning</a></h1>
<p>Labelled data are noisy and imprecise.</p>
<p>Workflow</p>
<ol>
<li>Process unlabelled data to generate accuracies of label sources</li>
<li>Generate training labels</li>
<li>Train a powerful model</li>
</ol>
<p><strong>Frameworks</strong></p>
<p>Snorkel: aggregate noisy labelling function outputs to automatically label training data</p>
<p>FlyingSquid</p>
<p>FixMatch</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="self-supervised-learning"><a class="header" href="#self-supervised-learning">Self-supervised learning</a></h1>
<p>Specifically for deep learning:</p>
<ul>
<li>Masked language modelling</li>
<li>VAE and GAN are generative SSL methods</li>
<li>Contrastive learning
<ul>
<li>SimCLRv2</li>
</ul>
</li>
</ul>
<p>Training a model using labels that are inherent in the data, rather than requiring a separate set of labels.</p>
<p>The task that is used for pretraining is the <strong>pretext task</strong>. The tasks that we then use for fine-tuning are called <strong>downstream tasks</strong>. This is also <strong>transfer learning</strong>.</p>
<ul>
<li>Colorisation</li>
<li>Guessing image patches</li>
<li>Placing frames in thr right order</li>
<li>Inpainting</li>
<li>Classify corrupted images</li>
</ul>
<p>Choosing a pretext task</p>
<p>The tasks that you choose needs to be something that, if solved, would require an understanding of your data which would also be needed to solve your downstream task.</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="clustering-algorithms"><a class="header" href="#clustering-algorithms">Clustering algorithms</a></h1>
<p>“Meaningful collections / meaningful groups”</p>
<p>“How you choose helps you understand more about them”</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> = size of data</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> = no. of clusters</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> = no. of iterations</p>
<blockquote>
<p>💡 <strong>Centroid</strong> an artificial point in a cluster</p>
</blockquote>
<blockquote>
<p>💡 <strong>Clustroid</strong> is an existing datapoint closes to all other points in a cluster</p>
</blockquote>
<p>Uses:</p>
<ul>
<li>Market segmentation</li>
<li>Medical. imaging</li>
<li>Anomaly detection</li>
<li>Image segmentation</li>
<li>Generalisation (less popular together with more popular videos)</li>
<li>User clustering</li>
</ul>
<p>Why transform data?</p>
<p>In clustering, you calculate the similarity between two examples by combining all the feature data for those examples into a numeric value. <strong>Combing feature data requires that the data have the same scale.</strong></p>
<h2 id="types"><a class="header" href="#types">Types</a></h2>
<ul>
<li>Centroid-based
<ul>
<li>k-means &amp; k-means++ (for choosing seeds)</li>
<li>FAISS (<a href="https://github.com/facebookresearch/faiss">facebookresearch / faiss</a>)</li>
</ul>
</li>
<li>Density-based
<ul>
<li>DBSCAN</li>
<li>OPTICS</li>
</ul>
</li>
<li>Distribution-based</li>
<li>Hierarchical</li>
<li>Unclassified
<ul>
<li>Mean shift</li>
</ul>
</li>
</ul>
<h2 id="metrics-5"><a class="header" href="#metrics-5">Metrics</a></h2>
<ul>
<li>Davies-Bouldin index</li>
<li>Silhouette score</li>
<li>Gini coefficient: measure degree of heterogeneity</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="intro-to-dl"><a class="header" href="#intro-to-dl">Intro to DL</a></h1>
<h1 id="terminologies-1"><a class="header" href="#terminologies-1"><strong>Terminologies</strong></a></h1>
<ul>
<li>architecture = model = network = algorithm</li>
<li>input = image = tensor = image matrix</li>
<li>output = convolved feature</li>
<li>input channels = input maps = depth</li>
<li>output channels = feature maps = activation map</li>
<li>filter = kernel = weights = feature extractor = convolution = feature detector</li>
<li>feature = structure (low-level, high-level)</li>
<li>resolution = dimension = size</li>
<li>depth = no. of channels/filters</li>
<li>class</li>
<li>example = observation = sample</li>
<li>Epoch = training step</li>
<li>Batch = iteration</li>
<li>Filter</li>
<li>Downsample = encode</li>
<li>Upsample = decode</li>
</ul>
<h1 id="why-deep-learning"><a class="header" href="#why-deep-learning"><strong>Why deep learning?</strong></a></h1>
<ul>
<li>Classical ML: Features are hand engineered. Hand engineered features are
<ol>
<li>Time-consuming</li>
<li>Brittle</li>
<li>Not scalable</li>
</ol>
</li>
<li>DL: Features are <strong>learned</strong>. Deep learning is able to extract salient information from raw data by developing a hierarchical representation of features. This automatic feature extraction is an intrinsic component of the architecture. For this reason, deep learning is often described as <strong>representation learning</strong>.</li>
</ul>
<p>Why now?</p>
<ol>
<li>Big data. Data is becoming more pervasive.</li>
<li>Hardware</li>
<li>Software</li>
</ol>
<h1 id="universal-approximation-theorem"><a class="header" href="#universal-approximation-theorem"><strong>Universal approximation theorem</strong></a></h1>
<p>A feedforward network with a single (hidden) layer is sufficient to approximate, to an arbitrary precision, any continuous function. (Neural networks are excellent function approximators.)</p>
<p><a href="https://twitter.com/gabrielpeyre/status/1304645917648269312">https://twitter.com/gabrielpeyre/status/1304645917648269312</a></p>
<h1 id="normalising-feature-values"><a class="header" href="#normalising-feature-values"><strong>Normalising feature values</strong></a></h1>
<ul>
<li>Roughly zero-centered, -1 to 1 often works well and roughly <strong>all our inputs are of the same scale</strong>.</li>
<li>Helps gradient descent converge. Avoid NaN</li>
<li>Avoiding outlier values can also help</li>
<li>Can use:
<ul>
<li>Linear scaling</li>
<li>Log scaling</li>
<li>Max min clipping</li>
</ul>
</li>
</ul>
<h1 id="networks"><a class="header" href="#networks"><strong>Networks</strong></a></h1>
<p>Perceptron (no hidden layer, with nonlinearity)</p>
<p>Deep neural network (multi-layer perceptron)</p>
<h1 id="perceptron-components"><a class="header" href="#perceptron-components"><strong>Perceptron components</strong></a></h1>
<ul>
<li>Inputs + Weights + bias. A high bias means that a neuron is more likely activated despite its weights.</li>
<li>Linear combination</li>
<li>Non-linearity (nonlinear activation functions)</li>
<li>Output</li>
</ul>
<p>Note that a combination of linear models is still linear ie b + wx + wx.</p>
<h1 id="optimisation"><a class="header" href="#optimisation"><strong>Optimisation</strong></a></h1>
<p>Solving the weights of a network with loss function is a non-convex optimisation. Proper initialisation matters. If network is composed of differentiable functions, then we can probably learn from it using gradient descent.</p>
<h1 id="gradient-descent"><a class="header" href="#gradient-descent"><strong>Gradient descent</strong></a></h1>
<p><a href="https://www.youtube.com/watch?v=aircAruvnKk">https://www.youtube.com/watch?v=aircAruvnKk</a></p>
<p>Compute gradient using backpropagation = chain rule. How does a small change in one weight affect the final loss? Should a weight get nudged up or down? Which ones give most bang for buck (which one will have more effect on the cost function)?</p>
<p>We can compute the <strong>best direction</strong> that is mathematically guaranteed to be the direction of the steepest descend. This direction is related to the gradient of the loss function.</p>
<p>Backpropagation</p>
<p>Backpropagation can be thought of as gates communicating to each other, whether they want their outputs to increase or decrease, so as to make the final output value higher or lower.</p>
<p>Backpropagation will ensure that weights that need to be updated are updated <strong>proportionately</strong> to the loss function. Gradient signals are “distributed” to everyone.</p>
<p>Gradient on x*w</p>
<p>If x were extremely large (no preprocessing done), gradient of w will be very large too. As a result, one needs to compensate by lowering the learning rate by that factor. Another method is to perform <strong>batch normalisation</strong>. Gradients can also vanish because each additional layer can successfully reduce signals through activation functions like sigmoid. One way to prevent this is to use other activation functions like ReLU.</p>
<p>Learning rate</p>
<p>If you set your learning rate too small, you’re not really trusting your gradient on each step. What can happen is that you can get stuck in local minima, because you’re not being as aggressive as you should be to escape them. If you set your learning rate too large, you can overshoot completely and diverge. Setting the learning rate can be challenging in practice such that you avoid the local minima but small off such that you still converge.</p>
<p>How to set learning rate?</p>
<ul>
<li>Try different learning rates</li>
<li>Design a learning rate that ‘adapts’ to the landscape.</li>
<li>Learning rate schedulers</li>
<li>One-fit cycle</li>
<li>Depends on batch size (larger batch size means you are trusting the gradient more so learning rate can be increased)</li>
</ul>
<p>Learning rate schedulers</p>
<ul>
<li>Constant</li>
<li>Time-based decay</li>
<li>Step decay</li>
<li>Exponential decay</li>
<li>Lambda</li>
<li>Multistep LR</li>
<li>Cosine annealing LR</li>
<li>ReduceLR on plateau</li>
<li>Cyclic</li>
</ul>
<h1 id="gradient-descent-optimisation-algorithms"><a class="header" href="#gradient-descent-optimisation-algorithms"><strong>Gradient descent optimisation algorithms</strong></a></h1>
<ul>
<li>Vanilla</li>
<li>Momentum</li>
<li>NAG</li>
<li>RMSProp</li>
<li>Adam</li>
<li>RAdam</li>
<li>SWA</li>
</ul>
<h1 id="batch-gradient-descent-mini-batch-gradient-descent-stochastic-gradient-descent"><a class="header" href="#batch-gradient-descent-mini-batch-gradient-descent-stochastic-gradient-descent"><strong>(Batch) gradient descent, mini-batch gradient descent, stochastic gradient descent</strong></a></h1>
<p>Gradient in gradient descent is expensive to compute over all data points. Stochastic gradient descent computes over <strong>a single data point chosen randomly</strong>. The term &quot;stochastic&quot; comes from the fact that the gradient based on a single training sample is a &quot;stochastic approximation&quot; of the &quot;true&quot; cost gradient. The downside of using a single point is that it’s going to be too noisy. Middle ground is to take a mini-batch, where true gradient is approximated by taking the average of the gradients.</p>
<ul>
<li>More accurate estimation of gradient
<ul>
<li>Smoother convergence</li>
<li><strong>Allows for larger learning rates</strong> (because we trust the gradients more)</li>
</ul>
</li>
</ul>
<p>Stochastic gradient descent can be also taken to mean batch gradient descent.</p>
<h1 id="overfitting--regularisation"><a class="header" href="#overfitting--regularisation"><strong>Overfitting &amp; regularisation</strong></a></h1>
<ul>
<li>Dropout: randomly set some of the activation of the hidden neurons to 0 with some probability (usually 50%)</li>
<li>Early stopping</li>
<li>JUMP START</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="tensor-libraries"><a class="header" href="#tensor-libraries">Tensor libraries</a></h1>
<p>Frameworks</p>
<ul>
<li>NumPy</li>
<li>PyTorch &amp; TorchScript</li>
<li>TensorFlow</li>
<li>JAX = JIT + Autograd + XLA</li>
<li>Numba</li>
<li>Keras</li>
<li>PyTorch lightning</li>
</ul>
<hr />
<p><a href="https://github.com/ipython-books/cookbook-2nd/blob/master/chapter04_optimization/05_array_copies.md">ipython-books/cookbook-2nd</a></p>
<p>Why are NumPy arrays efficient?</p>
<ol>
<li>Data is stored stored contiguously (unlike Python)</li>
<li>Spatial locality (???)</li>
<li>Because of contiguity, vectorised instructions can be used (Intel's SSE and AVX).</li>
</ol>
<h1 id="view"><a class="header" href="#view">View</a></h1>
<pre><code class="language-python">X.view()

To check if an array is a view of another

y1.base is y

If none, it’s a copy
</code></pre>
<h1 id="creation"><a class="header" href="#creation"><strong>Creation</strong></a></h1>
<pre><code class="language-python">x = np.zeros((3,4,5))              # zeros
x = np.ones((3,4,5))               # ones
x = np.random.rand(3,4,5)          # uniform [0,1]
x = np.random.randint(0,21,15)
x = np.random.normal(size=(3,4,5)) # N(0,1)
x = np.random.rand(4)              # U(0,1)
x = np.array([0,0,0])              # from array
x = np.arange(0,15)
x = np.eye(3)                      # diagonal 3x3 matrix ones
</code></pre>
<pre><code class="language-python">x = torch.zeros((3,4,5))           # zeros
x = torch.ones((3,4,5))            # ones
x = torch.rand(3,4,5)              # uniform [0,1]
x = torch.randn(3,4,5)             # N(0,1)
x = torch.tensor([3.,4.,2.])       # from array
x = torch.empty(1,5,3)             # zeros
</code></pre>
<h1 id="mathematical-operations"><a class="header" href="#mathematical-operations"><strong>Mathematical operations</strong></a></h1>
<pre><code class="language-python">x.dot(x)           # matrix multiplication
x.argmin()         # index of min
</code></pre>
<pre><code class="language-python">torch.matmul(x, y)
torch.mm(x, y)
</code></pre>
<h1 id="info"><a class="header" href="#info"><strong>Info</strong></a></h1>
<pre><code class="language-python">x.shape
</code></pre>
<pre><code class="language-python">x.size()
</code></pre>
<h1 id="shape-manipulation"><a class="header" href="#shape-manipulation"><strong>Shape manipulation</strong></a></h1>
<pre><code class="language-python">x = x.reshape(1,-1)
x = x.reshape(1,5,2) 
np.reshape(x,(1,5,2))
x = x.view(1,5,-1)  reshape to (1,5,?) where ? Is inferred
np.squeeze([[[[1,2,3,4]]]])

TOrch:
xy.squeeze()
</code></pre>
<h1 id="permute"><a class="header" href="#permute"><strong>Permute</strong></a></h1>
<pre><code class="language-python">x.transpose(2, 0, 1)
</code></pre>
<pre><code class="language-python">x.permute
</code></pre>
<h1 id="expand-dimension"><a class="header" href="#expand-dimension"><strong>Expand dimension</strong></a></h1>
<pre><code class="language-python">x[:, np.newaxis]
np.expand_dims(axis=)

x.expand()
</code></pre>
<h1 id="sorting"><a class="header" href="#sorting"><strong>Sorting</strong></a></h1>
<pre><code class="language-python">x.sort(axis=)
np.argsort(a)
</code></pre>
<h1 id="concat"><a class="header" href="#concat"><strong>Concat</strong></a></h1>
<pre><code class="language-python">torch.cat()
</code></pre>
<h1 id="mask"><a class="header" href="#mask">Mask</a></h1>
<p>https://stackoverflow.com/questions/19984102/select-elements-of-numpy-array-via-boolean-mask-array/58365403#58365403</p>
<h1 id="gotchas"><a class="header" href="#gotchas">Gotchas</a></h1>
<ul>
<li>Gradiemts are accumulated. Must zero accordingly</li>
<li><code>with torch.nograd</code> ensures that in manual gradient update, a computation graph for differentiation isnt created</li>
<li>Optimiser.step() updates weights for you</li>
<li>Forward and callable</li>
<li>Requires_grad</li>
<li>When inheriting from nn.Module, the weights must be wrapped with torch.nn.Parameter() to be automatically registered as parameter. (Not sure if this is the right way but it’s something like that)</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="sparse-matrices"><a class="header" href="#sparse-matrices">Sparse matrices</a></h1>
<ul>
<li>
<p>CSR (compressed sparse column)</p>
<p>Write-once-read-many</p>
<p>matrix is represented using three 1D arrays for the non zero values</p>
<p>value = [5 8 3 6]</p>
<p>col = [0 1 2 1]</p>
<p>row = [0 0 2 3 4]</p>
<p>Fast row access and matrix-vector multiplications.</p>
</li>
<li>
<p>LIL (list of list)</p>
<p><code>[(row,col,val), (row,col,val), (row,col,val)]</code></p>
</li>
<li>
<p>DOK (dictionary of keys)</p>
<pre><code>{(row,col): val,
 (row,col): val}
</code></pre>
</li>
<li>
<p>COO (coordinate list)</p>
<p><code>(row,col,val), (row,col,val), (row,col,val)]</code></p>
</li>
<li>
<p>CSC (compressed sparse row)</p>
</li>
<li>
<p>Block sparse row</p>
</li>
</ul>
<p><strong>Code</strong></p>
<pre><code class="language-python">from scipy.sparse import csr_matrix, csc_matrix
from scipy.sparse import random

matrix = random(3,3, format='csr', density=0.4)

.todense()
.toarray()
.nnz
.data
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="transfer-learning"><a class="header" href="#transfer-learning">Transfer learning</a></h1>
<h1 id="definitions--intuitions"><a class="header" href="#definitions--intuitions">Definitions / intuitions</a></h1>
<ul>
<li>&quot;Given a loss function, theoretically, the random model will have a higher loss (think loss landscape). This is what is meant by “knowing to do something”.&quot;</li>
<li>“Transfer learning is the idea that, if you know how to solve a task well, you should be able to transfer some of that understanding to solving related problems.”</li>
<li>“Transfer learning is a means to extract knowledge from a source setting and apply it to a different target setting.”
<ul>
<li>Train a model with a smaller dataset,</li>
<li>Improve generalisation, and</li>
<li>Speed up training.</li>
</ul>
</li>
<li>Transfer learning is a technique that takes a piece of a model that has already been trained on a related task and reusing it in a new model. The intuition behind this idea is, that also for other tasks or dataset the first layers of neural networks learn similar concepts to recognise basic structures such as blobs and edges. This concepts do not have be trained again from scratch when using pretrained models.</li>
<li><a href="http://cs231n.github.io/transfer-learning/">Transfer learning</a> is a technique in machine learning in which we apply knowledge from a source domain (e.g. ImageNet) to a target domain that may have significantly fewer data points. In practice, this generally involves initialising a model with pre-trained weights from ResNet, Inception, etc. and either using it as a feature extractor, or fine-tuning the last few layers on a new dataset. With transfer learning, these models can be re-purposed for any related task we want, from object detection for self-driving vehicles to generating captions for video clips. Use when:
<ul>
<li>Similar domain</li>
<li>Small dataset</li>
<li>Extract feature</li>
<li>Fine-tune last few layers</li>
</ul>
</li>
<li>The underlying idea of transfer learning is that neural net architectures will generalise for similar types of problems: for example, that many images have underlying features (such as corners, circles, dog faces, or wheels) that show up in a variety of different types of images. In contrast, the underlying idea of promoting neural architecture search for every problem is the opposite: that each dataset has a unique, highly specialised architecture it will perform best with.</li>
</ul>
<h1 id="how-can-knowledge-be-transferred"><a class="header" href="#how-can-knowledge-be-transferred">How can knowledge be transferred?</a></h1>
<ol>
<li>From a task to a downstream task (via sequential transfer learning or multitask learning)</li>
<li>From a domain to another domain (domain adaptation)</li>
<li>From a language to another language (cross-lingual learning)</li>
</ol>
<h1 id="who-can-use"><a class="header" href="#who-can-use">Who can use?</a></h1>
<ul>
<li>Small data</li>
<li>Pathetic computer</li>
</ul>
<h1 id="how-to-fine-tune"><a class="header" href="#how-to-fine-tune">How to fine-tune?</a></h1>
<p>Gradual unfreezing</p>
<p>Discriminative learning rates</p>
<p>One-cycle training</p>
<p>ImageNet pretraining has been quite successful</p>
<p>No. Of layers</p>
<p>Batch normalisation</p>
<p>ReLU</p>
<p>Dropouts</p>
<ul>
<li>architecture
<ul>
<li>Keep</li>
<li>Modify</li>
</ul>
</li>
<li>Weights
<ul>
<li>Don’t change (feature extraction)</li>
<li>Modify (fine-tuning the weights)</li>
</ul>
</li>
<li>Manner
<ul>
<li>One layer at a time (freezing)</li>
<li>Start with low learning rates</li>
<li>Regularisation (One way to minimise catastrophic forgetting is to encourage target model parameters to stay close to the parameters of the pretrained model using a regularisation term)</li>
</ul>
</li>
</ul>
<p>Given a loss function, theoretically, the random model will have a higher loss (think loss landscape). This is what is meant by “knowing to do something”.</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="weight-initialisation"><a class="header" href="#weight-initialisation">Weight initialisation</a></h1>
<p><a href="https://www.deeplearning.ai/ai-notes/initialization/">https://www.deeplearning.ai/ai-notes/initialization/</a></p>
<p>On weight initialisation in deep neural networks</p>
<h1 id="motivation-2"><a class="header" href="#motivation-2"><strong>Motivation</strong></a></h1>
<p>Backpropagated gradients are either amplified or minimised. As a results, training is slowed down or diverges.</p>
<h1 id="goal"><a class="header" href="#goal"><strong>Goal</strong></a></h1>
<p>Gradient signal should not be multiplied by values that are too small or too large in any layer.</p>
<h1 id="proposition"><a class="header" href="#proposition"><strong>Proposition</strong></a></h1>
<p>It is proposed that across layers:</p>
<ol>
<li>Mean of activations should be 0 (so that it’s easier to determine what is the right variance to use for different nonlinear activation functions)</li>
<li>Variance of nonlinear activations is the same (intuitively, it maintains magnitude of the signals)</li>
</ol>
<p>such that the resulting backpropagated gradient signal will not be multiplied by values too small or too large in any layer.</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span><span class="mclose">]</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">]</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<h1 id="assumptions"><a class="header" href="#assumptions"><strong>Assumptions</strong></a></h1>
<ul>
<li>Weights are IID.</li>
<li>Inputs to the first layer are IID with mean 0 and variance 1.</li>
<li>Weights and inputs are mutually independent.</li>
</ul>
<h1 id="types-of-initialisation"><a class="header" href="#types-of-initialisation"><strong>Types of initialisation</strong></a></h1>
<ul>
<li>Initialise with the same number = symmetrical
<ul>
<li>Cases
<ul>
<li>All zeros =&gt; network will not learn</li>
<li>All ones =&gt; does not break symmetry</li>
<li>All small =&gt; vanishing gradients; network will not learn</li>
<li>All big =&gt; exploding gradients</li>
</ul>
</li>
</ul>
</li>
<li>Initialise with different numbers i.e. random
<ul>
<li>Cases
<ul>
<li>Too large =&gt; exploding gradients</li>
<li>Too small =&gt; vanishing gradients</li>
<li>Just nice. We want the activations to have same mean and variance across, to prevent exploding or vanishing gradients</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="initialisations-to-use-for-nonlinear-activation-functions"><a class="header" href="#initialisations-to-use-for-nonlinear-activation-functions"><strong>Initialisations to use for nonlinear activation functions</strong></a></h1>
<ul>
<li>
<p>tanh: Xavier</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0254em;vertical-align:-0.704em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.296em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.814em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.704em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span></p>
</li>
<li>
<p>sigmoid: Kumar</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.1951em;vertical-align:-0.704em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.296em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.814em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3.</span><span class="mord"><span class="mord">6</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.704em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span></p>
</li>
<li>
<p>ReLU: He</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0254em;vertical-align:-0.704em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.296em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.814em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.704em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span></p>
</li>
</ul>
<h1 id="initialisation"><a class="header" href="#initialisation">Initialisation</a></h1>
<h2 id="xavier-initialisation"><a class="header" href="#xavier-initialisation">Xavier initialisation</a></h2>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0254em;vertical-align:-0.704em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.296em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.814em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.704em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span></p>
<h2 id="he-initialisation"><a class="header" href="#he-initialisation">He initialisation</a></h2>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0254em;vertical-align:-0.704em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.296em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.814em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.704em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span></p>
<h2 id="others-1"><a class="header" href="#others-1">Others</a></h2>
<ul>
<li>Xavier uniform</li>
<li>He uniform</li>
<li>Standard normal</li>
<li>Uniform</li>
<li>Zeros / other constants
<ul>
<li>Initialising all the weights with zeros leads the neurons to learn the same features during training.</li>
<li>Thus, both hidden units will have identical influence on the cost, which will lead to identical gradients. Thus, both neurons will evolve symmetrically throughout training, effectively preventing different neurons from learning different things.</li>
</ul>
</li>
</ul>
<h1 id="terms"><a class="header" href="#terms"><strong>Terms</strong></a></h1>
<p>Kaiming = Kaiming He</p>
<p>Glorot = Xavier Glorot</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="bonus-questions-2"><a class="header" href="#bonus-questions-2">Bonus questions</a></h1>
<p>Lack of data?</p>
<ul>
<li>Open source data</li>
<li>Augmentation</li>
<li>Synthetic data</li>
<li>Transfer learning</li>
</ul>
<p><strong>Deep Learning Interviews: Hundreds of fully solved job interview questions from a wide range of key topics in AI</strong></p>
<p><a href="https://arxiv.org/abs/2201.00650">https://arxiv.org/abs/2201.00650</a></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="frameworks-1"><a class="header" href="#frameworks-1">Frameworks</a></h1>
<p>TensorFlow, Keras</p>
<p>PyTorch, PyTorch Lightning, einops</p>
<p>flashlight</p>
<p>JAX, Trax</p>
<p>Create ML</p>
<p>PlaidML</p>
<p>Core ML</p>
<p>turicreate</p>
<p>TensorFlowJS</p>
<p>Darknet</p>
<p><a href="https://github.com/microsoft/DeepSpeed">DeepSpeed</a></p>
<p>ONNX</p>
<p>Accelerate</p>
<p>Intel MKL</p>
<p>MKL-DNN</p>
<p>BLAS</p>
<p>LAPACK</p>
<p>CUDA</p>
<p>Metal</p>
<p>PyOpenCL</p>
<h1 id="data-manipulation"><a class="header" href="#data-manipulation">Data manipulation</a></h1>
<p>cuDF</p>
<p>NumPy</p>
<p>pandas</p>
<p>ArrayFire</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="improving-predictive-power"><a class="header" href="#improving-predictive-power">Improving predictive power</a></h1>
<ul>
<li>
<p>Progressive resizing</p>
</li>
<li>
<p>Mixup augmentation</p>
</li>
<li>
<p>Removing wrongly classified test images</p>
</li>
<li>
<p>Ensembling</p>
</li>
<li>
<p>Model Fine-tuning using discriminative learning rate etc</p>
</li>
<li>
<p>Model distillation: large models or ensembles of models may be distilled into a single, smaller model</p>
</li>
</ul>
<p>Progressive Labelling</p>
<p>MixMatch</p>
<p>Catastrophic Forgetting is what limits learning rates at small batch sizes.</p>
<p>Cutout regularisation. Zero out a random 8x8 square subset of an image.</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="sgd-optimisers"><a class="header" href="#sgd-optimisers">SGD optimisers</a></h1>
<p><a href="https://towardsdatascience.com/10-gradient-descent-optimisation-algorithms-86989510b5e9">10 Stochastic Gradient Descent Optimisation Algorithms</a></p>
<ul>
<li>AdamW</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="limitations-and-new-frontiers"><a class="header" href="#limitations-and-new-frontiers">Limitations and new frontiers</a></h1>
<p><img src="./Popularity.png" alt="Limitations%20and%20new%20frontiers%2082b68cc6c3af48c7bcee686b2f8c2e5c/Popularity.png" /></p>
<h3 id="neural-networks-only-accept-certain-input-types"><a class="header" href="#neural-networks-only-accept-certain-input-types"><strong>Neural networks only accept certain input types</strong></a></h3>
<p>Effect:</p>
<ul>
<li>Difficult to encode structure and prior knowledge</li>
</ul>
<p>Frontiers:</p>
<ul>
<li>2D spatial structure like images - CNN.</li>
<li>Graph data like social networks, internet traffic, state machines, mobility &amp; transport, molecules, biological networks - graph convolutional networks.</li>
<li>3D data (point clouds: unordered sets with spatial dependence between points) - CNN.</li>
</ul>
<h3 id="neural-networks-are-excellent-function-approximators"><a class="header" href="#neural-networks-are-excellent-function-approximators"><strong>Neural networks are excellent function approximators</strong></a></h3>
<p>Effect:</p>
<ul>
<li>Poor generalisation, memorises data. Does not work on unseen data.</li>
<li>Easily fooled by adversarial attacks (image + perturbation = ???).</li>
</ul>
<p>Frontiers:</p>
<ul>
<li>(See below on uncertainty)</li>
</ul>
<h3 id="neural-network-predictions-are-point-predictions"><a class="header" href="#neural-network-predictions-are-point-predictions"><strong>Neural network predictions are point predictions</strong></a></h3>
<p>Effect:</p>
<ul>
<li>Cannot quantify uncertainty for unseen data.</li>
</ul>
<p>Frontiers:</p>
<ul>
<li>Bayesian deep learning for uncertainty. Rather then learning the weights directly, we learn a posterior over the weights i.e. P(W|X,Y). This posterior is intractable, however.</li>
<li>Ensembling for uncertainty estimation.</li>
<li>Evidential deep learning: directly learn the underlying uncertainty using evidential distributions.</li>
<li>Multi-task learning using uncertainty</li>
</ul>
<h3 id="neural-networks-are-large"><a class="header" href="#neural-networks-are-large"><strong>Neural networks are large</strong></a></h3>
<p>Effect:</p>
<ul>
<li>Data hungry</li>
<li>Computationally intensive</li>
</ul>
<h3 id="neural-networks-are-complex"><a class="header" href="#neural-networks-are-complex"><strong>Neural networks are complex</strong></a></h3>
<p>Effect:</p>
<ul>
<li>Requires expert knowledge to design and fine-tune</li>
<li>Finicky to optimise: non-convex, choice of architecture, learning parameters</li>
<li>Uninterpretable</li>
</ul>
<p>Frontiers:</p>
<ul>
<li>Automated machine learning for NAS.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="learning-rate-scheduler"><a class="header" href="#learning-rate-scheduler">Learning rate scheduler</a></h1>
<ul>
<li>Cosine</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="backpropagation-softmax-and-categorical-cross-entropy"><a class="header" href="#backpropagation-softmax-and-categorical-cross-entropy">Backpropagation softmax and categorical cross entropy</a></h1>
<pre><code class="language-python">import torch.nn.functional as F
import torch.nn as nn

y = torch.tensor([[0,0,1]], dtype=torch.float32)

x = torch.tensor([[2,3]], dtype=torch.float32)

y_true = torch.tensor([2], dtype=torch.long)

linear = nn.Linear(2,3,bias=False)

linear.weight.data = torch.tensor([[-1,1],[2,-1],[0,2]], dtype=torch.float32)

z = linear(x)

y_pred = F.softmax(z, dim=1)

#loss = F.nll_loss(y_pred, y_true)
loss = -torch.log(y_pred[y==1])

z.retain_grad()
loss.retain_grad()
y_pred.retain_grad()
loss.backward()
</code></pre>
<p><img src="backpropagation-softmax-and-categorical-cross.png" alt="Backpropagation%20softmax%20and%20categorical%20cross%20entr%20cec73119cc9b460e97708a3e433032d2/Untitled.png" /></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="hyperparameter-search"><a class="header" href="#hyperparameter-search">Hyperparameter search</a></h1>
<ul>
<li>Grid search</li>
<li>One learning rate cycle / one-fit cycle</li>
</ul>
<p>(search for the right learning rate) start low lr, increase exponentially for every batch. Plot LOSS vs. LR. We need to select a point on the graph <strong>with the fastest decrease in the loss</strong>. In this example, the loss function decreases fast when the learning rate is between 0.001 and 0.01.</p>
<p><img src="hyperparameter-search.png" alt="Hyperparameter%20search%20729c5649a5ed47d1b28eaad2e1090ebc/Untitled.png" /></p>
<p>Subsequently, use a cyclic learning rate scheduler and use this learning rate as the max.</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="layers"><a class="header" href="#layers">Layers</a></h1>
<hr />
<p><a href="https://twitter.com/fchollet/status/1627818199311069184?s=20">https://twitter.com/fchollet/status/1627818199311069184?s=20</a></p>
<h1 id="dropout"><a class="header" href="#dropout"><strong>Dropout</strong></a></h1>
<p>allows training on smaller datasets without over-fitting.</p>
<h1 id="batch-normalization"><a class="header" href="#batch-normalization"><strong>Batch normalization</strong></a></h1>
<p>allows for faster training. Normalise each pixel value across mini-batch</p>
<p>Make sure to scale the data if it’s on a very different scales. If we don’t scale the data, the level curves (contours) would be narrower and taller which means it would take longer time to converge (see figure 3).</p>
<p><img src="layers-Normalized.png" alt="Layers%206baf4091115f46f885e9a4718180f43f/Normalized.png" /></p>
<h1 id="skip-connections"><a class="header" href="#skip-connections"><strong>Skip connections</strong></a></h1>
<p>why do very deep nets perform worse as you keep adding layers?</p>
<p>Addressing the problem of training a really deep architecture by introducing skip connections: layers can copy their inputs to the next layer</p>
<p>Skip connections, which are employed in ResNet and DenseNet allow to build deeper architectures, while mitigating the vanishing gradient problem. All we have to do is to add the output of previous layers to the input of layers located deeper in our network, <strong>before</strong> the activation function is applied:</p>
<p>Skip connections work, because by connecting layers via shortcuts, we can at least learn the identity function. The intuition behind this technique is, that gradients do not have to be backpropagated solely through convolutional (or fully connected) layers, which cause gradients to diminish once they reach the earlier layers of the network. They can rather “skip” layers through the addition operation of the skip connection.</p>
<p><img src="layers-18Vhd39FU4B-ZDmRQ2m-fPA.png" alt="Layers%206baf4091115f46f885e9a4718180f43f/18Vhd39FU4B-ZDmRQ2m-fPA.png" /></p>
<p>Residual learning: instead of trying to learn some features, we try to learn some residual. Residual can be simply understood as subtraction of feature learned from input of that layer</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="improving-speed--accuracy"><a class="header" href="#improving-speed--accuracy">Improving speed / accuracy</a></h1>
<p><a href="https://myrtle.ai/how-to-train-your-resnet/">https://myrtle.ai/how-to-train-your-resnet/</a></p>
<h1 id="during-training"><a class="header" href="#during-training"><strong>During training</strong></a></h1>
<ul>
<li>Data
<ul>
<li>Perform preprocessing once before training</li>
<li>Curriculum learning - train on simple examples, then the hard ones</li>
</ul>
</li>
<li>Architecture
<ul>
<li>Mixed precision training</li>
<li>Smaller model</li>
<li>Engineering layers</li>
<li>Transfer learning</li>
</ul>
</li>
<li>Hyperparameters
<ul>
<li>High learning rates (super convergence)</li>
<li>Increase batch size</li>
</ul>
</li>
<li>Optimiser / regularisation / loss
<ul>
<li>Mixup regularisation</li>
<li>AdamW</li>
<li>Label smoothing</li>
</ul>
</li>
</ul>
<h1 id="during-inference"><a class="header" href="#during-inference"><strong>During inference</strong></a></h1>
<ul>
<li>Quantisation. Stores weights in low precision formats
<ul>
<li>fixed point vs floating point</li>
<li>post-training quantisation vs quantisation-aware training</li>
</ul>
</li>
<li>Pruning
<ul>
<li>Set some weights to 0. This cuts connections.</li>
</ul>
</li>
<li>Low Rank Approximation.
<ul>
<li>convolution layer can be broken down into two layers</li>
</ul>
</li>
<li>Weight sharing
<ul>
<li>Use means clustering to cluster 2.09, 2.12, 1.92, 1.87 and make them be 2. Stick to 2 bits for FCN and 4 bits for CNN</li>
</ul>
</li>
<li>Pruning &amp; training iteratively
<ul>
<li>Prune then retrain using a super small learning rate (1e-5)</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="activation-functions"><a class="header" href="#activation-functions">Activation functions</a></h1>
<p>Non-linearity functions</p>
<p>Decides if a neuron should be on or off, and if on, how useful is it. They also ensure that values are contained and don’t explode.</p>
<p>The purpose of activation functions is to introduce non-linearities into the network. In real life, almost all of our data is non linear. Nonlinearities allow you to approximate arbitrarily complex functions by introducing nonlinearities into decision boundaries.</p>
<ul>
<li><a href="activation-functions.html#sigmoid">Sigmoid</a></li>
<li><a href="activation-functions.html#softmax">Softmax</a></li>
<li><a href="activation-functions.html#softwax-with-temperature">Softwax with temperature</a></li>
<li><a href="activation-functions.html#relu">ReLU</a></li>
<li><a href="activation-functions.html#leakyrelu">LeakyReLU</a></li>
<li><a href="activation-functions.html#celu">CeLU</a></li>
<li><a href="activation-functions.html#gelu">GeLU</a></li>
<li><a href="activation-functions.html#swiglu">SwiGLU</a></li>
<li><a href="activation-functions.html#swish">Swish</a></li>
</ul>
<h2 id="sigmoid"><a class="header" href="#sigmoid">Sigmoid</a></h2>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2574em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">))</span></span></span></span></span></p>
<h2 id="softmax"><a class="header" href="#softmax">Softmax</a></h2>
<div id="admonition-note" class="admonition note">
<div class="admonition-title">
<p>Note</p>
<p><a class="admonition-anchor-link" href="activation-functions.html#admonition-note"></a></p>
</div>
<div>
<p>Softmax operations deal with vectors.</p>
</div>
</div>
<p>Given</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:9.06em;vertical-align:-4.28em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.7499em;"><span style="top:-6.7499em;"><span class="pstrut" style="height:11em;"></span><span style="width:0.667em;height:9.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='9.000em' viewBox='0 0 667 9000'><path d='M403 1759 V84 H666 V0 H319 V1759 v5400 v1759 h347 v-84 H403z M403 1759 V0 H319 V1759 v5400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.2501em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.78em;"><span style="top:-7.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-6.4275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.0275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span><span style="top:-2.1675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-0.9675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span><span style="top:0.2325em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.28em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.7499em;"><span style="top:-6.7499em;"><span class="pstrut" style="height:11em;"></span><span style="width:0.667em;height:9.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='9.000em' viewBox='0 0 667 9000'><path d='M347 1759 V0 H0 V84 H263 V1759 v5400 v1759 H0 v84 H347z M347 1759 V0 H263 V1759 v5400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.2501em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>The softmax function is given by</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">softmax</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4127em;vertical-align:-0.9857em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9857em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:9.06em;vertical-align:-4.28em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9857em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.7499em;"><span style="top:-6.7499em;"><span class="pstrut" style="height:11em;"></span><span style="width:0.667em;height:9.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='9.000em' viewBox='0 0 667 9000'><path d='M403 1759 V84 H666 V0 H319 V1759 v5400 v1759 h347 v-84 H403z M403 1759 V0 H319 V1759 v5400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.2501em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.78em;"><span style="top:-7.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-6.4275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-4.0275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span><span style="top:-2.1675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-0.9675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span><span style="top:0.2325em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.28em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.7499em;"><span style="top:-6.7499em;"><span class="pstrut" style="height:11em;"></span><span style="width:0.667em;height:9.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='9.000em' viewBox='0 0 667 9000'><path d='M347 1759 V0 H0 V84 H263 V1759 v5400 v1759 H0 v84 H347z M347 1759 V0 H263 V1759 v5400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.2501em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="softwax-with-temperature"><a class="header" href="#softwax-with-temperature">Softwax with temperature</a></h2>
<p><strong>Temperature</strong>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">100</span><span class="mclose">]</span></span></span></span>, is a parameter used in NLP to increase or decrease a model's confidence. </p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">softmax</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.458em;vertical-align:-1.031em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7115em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.031em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:9.06em;vertical-align:-4.28em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7115em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.031em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.7499em;"><span style="top:-6.7499em;"><span class="pstrut" style="height:11em;"></span><span style="width:0.667em;height:9.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='9.000em' viewBox='0 0 667 9000'><path d='M403 1759 V84 H666 V0 H319 V1759 v5400 v1759 h347 v-84 H403z M403 1759 V0 H319 V1759 v5400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.2501em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.78em;"><span style="top:-7.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7115em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span><span style="top:-6.4275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7115em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span><span style="top:-4.0275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span><span style="top:-2.1675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-0.9675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span><span style="top:0.2325em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7115em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.28em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.7499em;"><span style="top:-6.7499em;"><span class="pstrut" style="height:11em;"></span><span style="width:0.667em;height:9.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='9.000em' viewBox='0 0 667 9000'><path d='M347 1759 V0 H0 V84 H263 V1759 v5400 v1759 H0 v84 H347z M347 1759 V0 H263 V1759 v5400 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.2501em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><strong>Intuition</strong></p>
<p>A low confidence means that the distribution of the classes is roughly uniform:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.46em;vertical-align:-2.48em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.95em;"><span style="top:-4.95em;"><span class="pstrut" style="height:7.4em;"></span><span style="width:0.667em;height:5.400em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='5.400em' viewBox='0 0 667 5400'><path d='M403 1759 V84 H666 V0 H319 V1759 v1800 v1759 h347 v-84 H403z M403 1759 V0 H319 V1759 v1800 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.45em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.98em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.7675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.48em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.95em;"><span style="top:-4.95em;"><span class="pstrut" style="height:7.4em;"></span><span style="width:0.667em;height:5.400em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='5.400em' viewBox='0 0 667 5400'><path d='M347 1759 V0 H0 V84 H263 V1759 v1800 v1759 H0 v84 H347z M347 1759 V0 H263 V1759 v1800 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.45em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span> is the normalisation constant.</p>
<p>We can achieve this with the exponential function (for non-linearity purposes):</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.46em;vertical-align:-2.48em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.95em;"><span style="top:-4.95em;"><span class="pstrut" style="height:7.4em;"></span><span style="width:0.667em;height:5.400em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='5.400em' viewBox='0 0 667 5400'><path d='M403 1759 V84 H666 V0 H319 V1759 v1800 v1759 h347 v-84 H403z M403 1759 V0 H319 V1759 v1800 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.45em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.98em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.7675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.48em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.95em;"><span style="top:-4.95em;"><span class="pstrut" style="height:7.4em;"></span><span style="width:0.667em;height:5.400em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='5.400em' viewBox='0 0 667 5400'><path d='M347 1759 V0 H0 V84 H263 V1759 v1800 v1759 H0 v84 H347z M347 1759 V0 H263 V1759 v1800 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.45em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:5.46em;vertical-align:-2.48em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.95em;"><span style="top:-4.95em;"><span class="pstrut" style="height:7.4em;"></span><span style="width:0.667em;height:5.400em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='5.400em' viewBox='0 0 667 5400'><path d='M403 1759 V84 H666 V0 H319 V1759 v1800 v1759 h347 v-84 H403z M403 1759 V0 H319 V1759 v1800 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.45em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.98em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:-2.7675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.48em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.95em;"><span style="top:-4.95em;"><span class="pstrut" style="height:7.4em;"></span><span style="width:0.667em;height:5.400em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='5.400em' viewBox='0 0 667 5400'><path d='M347 1759 V0 H0 V84 H263 V1759 v1800 v1759 H0 v84 H347z M347 1759 V0 H263 V1759 v1800 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.45em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:5.46em;vertical-align:-2.48em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.95em;"><span style="top:-4.95em;"><span class="pstrut" style="height:7.4em;"></span><span style="width:0.667em;height:5.400em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='5.400em' viewBox='0 0 667 5400'><path d='M403 1759 V84 H666 V0 H319 V1759 v1800 v1759 h347 v-84 H403z M403 1759 V0 H319 V1759 v1800 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.45em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.98em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-2.7675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.48em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.95em;"><span style="top:-4.95em;"><span class="pstrut" style="height:7.4em;"></span><span style="width:0.667em;height:5.400em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='5.400em' viewBox='0 0 667 5400'><path d='M347 1759 V0 H0 V84 H263 V1759 v1800 v1759 H0 v84 H347z M347 1759 V0 H263 V1759 v1800 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.45em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:5.46em;vertical-align:-2.48em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.95em;"><span style="top:-4.95em;"><span class="pstrut" style="height:7.4em;"></span><span style="width:0.667em;height:5.400em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='5.400em' viewBox='0 0 667 5400'><path d='M403 1759 V84 H666 V0 H319 V1759 v1800 v1759 h347 v-84 H403z M403 1759 V0 H319 V1759 v1800 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.45em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.98em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7115em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7115em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span><span style="top:-2.7675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7115em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.48em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.95em;"><span style="top:-4.95em;"><span class="pstrut" style="height:7.4em;"></span><span style="width:0.667em;height:5.400em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='5.400em' viewBox='0 0 667 5400'><path d='M347 1759 V0 H0 V84 H263 V1759 v1800 v1759 H0 v84 H347z M347 1759 V0 H263 V1759 v1800 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.45em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>where each of the <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0106em;vertical-align:-0.2587em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span></span> is very small (close to 0).</p>
<p>Softmax with temperature is easy to compute (via vectorised operations) (?).</p>
<p>See the blog post from <a href="https://lukesalamone.github.io/posts/what-is-temperature/">Luke Salamon</a> to visualise varying the temperature.</p>
<h2 id="relu"><a class="header" href="#relu">ReLU</a></h2>
<p>Rectified Linear Unit</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.32em;vertical-align:-1.91em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-2.2em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.192em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.8889em' height='0.316em' style='width:0.8889em' viewBox='0 0 888.89 316' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V316 H384z M384 0 H504 V316 H384z'/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.8889em' height='0.316em' style='width:0.8889em' viewBox='0 0 888.89 316' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V316 H384z M384 0 H504 V316 H384z'/></svg></span></span><span style="top:-4.6em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if </span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">else</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1.0751em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">ReLU</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8251em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.32em;vertical-align:-1.91em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-2.2em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.192em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.8889em' height='0.316em' style='width:0.8889em' viewBox='0 0 888.89 316' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V316 H384z M384 0 H504 V316 H384z'/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.8889em' height='0.316em' style='width:0.8889em' viewBox='0 0 888.89 316' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V316 H384z M384 0 H504 V316 H384z'/></svg></span></span><span style="top:-4.6em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if </span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">else</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<h2 id="leakyrelu"><a class="header" href="#leakyrelu">LeakyReLU</a></h2>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">LeakyReLU</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.32em;vertical-align:-1.91em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-2.2em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.192em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.8889em' height='0.316em' style='width:0.8889em' viewBox='0 0 888.89 316' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V316 H384z M384 0 H504 V316 H384z'/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.8889em' height='0.316em' style='width:0.8889em' viewBox='0 0 888.89 316' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V316 H384z M384 0 H504 V316 H384z'/></svg></span></span><span style="top:-4.6em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">0.01</span><span class="mord mathnormal">x</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if </span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">else</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1.0862em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">LeakyReLU</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8362em;"><span style="top:-3.1473em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.32em;vertical-align:-1.91em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-2.2em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.192em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.8889em' height='0.316em' style='width:0.8889em' viewBox='0 0 888.89 316' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V316 H384z M384 0 H504 V316 H384z'/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.8889em' height='0.316em' style='width:0.8889em' viewBox='0 0 888.89 316' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V316 H384z M384 0 H504 V316 H384z'/></svg></span></span><span style="top:-4.6em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">0.01</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if </span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">else</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<h2 id="celu"><a class="header" href="#celu">CeLU</a></h2>
<p>Continuously Differentiable Exponential Linear Unit</p>
<h2 id="gelu"><a class="header" href="#gelu">GeLU</a></h2>
<p>Gaussian Error Linear Unit</p>
<h2 id="swiglu"><a class="header" href="#swiglu">SwiGLU</a></h2>
<h2 id="swish"><a class="header" href="#swish">Swish</a></h2>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="reinforcement-learning"><a class="header" href="#reinforcement-learning">Reinforcement learning</a></h1>
<p>Learn an optimal <em>policy</em> for sequential decision-making problems in a stochastic environment.</p>
<p><a href="https://remykarem.github.io/books/ai-planning-book">AI Planning book</a></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="metric-learning"><a class="header" href="#metric-learning">Metric learning</a></h1>
<p>Distance-Based Learning</p>
<ul>
<li>Examples
<ul>
<li>By class
<ul>
<li>Positive</li>
<li>Negative</li>
</ul>
</li>
<li>By model training
<ul>
<li>Hard</li>
<li>Soft</li>
</ul>
</li>
</ul>
</li>
<li>Mining (Hard Mining)
<ul>
<li>Online (while training model)</li>
<li>Offline (before? training model)</li>
</ul>
</li>
</ul>
<p><strong>Positives / Positive Examples</strong></p>
<p>A pair of examples from the same class</p>
<p><strong>Negatives / Negative Examples</strong></p>
<p>A pair of examples from different class</p>
<p><strong>Hard Mining</strong></p>
<p>Finding the relevant examples that can train the model (non-zero gradient)</p>
<p><strong>Hard Examples</strong></p>
<p>Examples that cause the model to train (non-zero gradient)</p>
<p><strong>Hard Negative Mining</strong></p>
<p>Finding negatives that cause the model to train (non-zero gradient)</p>
<p><strong>Hard Positive Mining</strong></p>
<p>Finding positives that cause the model to train (non-zero gradient)</p>
<p><strong>Hard Positives</strong></p>
<p>Positives that cause the model to train (non-zero gradient)</p>
<p><strong>Hard Negatives</strong> </p>
<p>Negatives that cause the model to train (non-zero gradient)</p>
<p><strong>Offline Hard Mining</strong></p>
<p>Hard mining before training model</p>
<p><strong>Online Hard Mining</strong></p>
<p>Hard mining while training model</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="learning-to-rank"><a class="header" href="#learning-to-rank">Learning to rank</a></h1>
<ul>
<li><a href="learning-to-rank.html#data-scope">Data scope</a></li>
<li><a href="learning-to-rank.html#objective">Objective</a></li>
<li><a href="learning-to-rank.html#difference-between-supervised-learning-and-ltr">Difference between supervised learning and LTR</a></li>
<li><a href="learning-to-rank.html#algorithm">Algorithm</a></li>
<li><a href="learning-to-rank.html#score-to-probability">Score to probability</a></li>
<li><a href="learning-to-rank.html#inference-time">Inference time</a></li>
<li><a href="learning-to-rank.html#loss-function">Loss function</a></li>
<li><a href="learning-to-rank.html#rank-aware-evaluation-metrics">Rank-aware evaluation metrics</a></li>
<li><a href="learning-to-rank.html#variants">Variants</a></li>
<li><a href="learning-to-rank.html#others">Others</a></li>
</ul>
<hr />
<p>Used in information retrieval and recommender systems.</p>
<h2 id="data-scope"><a class="header" href="#data-scope">Data scope</a></h2>
<p>For learning to rank, we are trying to compare between positive samples and negative samples. </p>
<h2 id="objective"><a class="header" href="#objective"><strong>Objective</strong></a></h2>
<p>Train a model to predict the probability of a certain item ranking over another (pairwise ranking). This directly trains the model to rank the items, contrary to using proxy measure (eg. probability of a user clicking on an item).</p>
<h2 id="difference-between-supervised-learning-and-ltr"><a class="header" href="#difference-between-supervised-learning-and-ltr"><strong>Difference between supervised learning and LTR</strong></a></h2>
<p>Supervised learning: Click probability is {ItemA: 90%, ItemB: 10%}</p>
<p>LTR: ItemA will rank higher with probability 70%</p>
<h2 id="algorithm"><a class="header" href="#algorithm"><strong>Algorithm</strong></a></h2>
<p>Inputs: 2 item embeddings</p>
<p>Penultimate output: Scores (the higher the score, the higher the rank)</p>
<p>Output: Probability of one item ranking over the other</p>
<p>Target: Binary</p>
<h2 id="score-to-probability"><a class="header" href="#score-to-probability"><strong>Score to probability</strong></a></h2>
<p>Based on the algorithm above, we find a way to translate the score to probability. Here are our needs:</p>
<ul>
<li>Larger difference in scores translate to a larger probability</li>
<li>If scores are equal, the probability should be 0.5</li>
<li>The probability function should be symmetric</li>
</ul>
<p>With these, the sigmoid function is a natural choice.</p>
<h2 id="inference-time"><a class="header" href="#inference-time">Inference time</a></h2>
<p><img src="./learning-to-rank-1.png" alt="Inference time" /></p>
<h2 id="loss-function"><a class="header" href="#loss-function">Loss function</a></h2>
<p>We want the probability to be large -&gt; maximise probability = minimise negative probability</p>
<p>Because of this we use a negative log likelihood of the probability as the loss function.</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.2935em;vertical-align:-0.9721em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">−</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span></span></span></p>
<p>Because of this formulation, the pairs of dataset should be in terms of (i,j) where the true ranking of I is higher than j.</p>
<p>Optimiser: Gradient descent</p>
<h2 id="rank-aware-evaluation-metrics"><a class="header" href="#rank-aware-evaluation-metrics">Rank-aware evaluation metrics</a></h2>
<ul>
<li>
<p>CG (cumulative gain)</p>
</li>
<li>
<p>DCG (discounted CG)</p>
</li>
<li>
<p>IDCG (ideal DCG)</p>
</li>
<li>
<p>NDCG (normalised DCG)</p>
<p>Measure of ranking quality.</p>
</li>
<li>
<p>MAP (only relevant documents!)
If my mAP@10 = 0.8, it means that on average (across users), if I predict k items for you (where k can be 1≤k≤10), 0.8k will be relevant.
<a href="https://web.stanford.edu/class/cs276/handouts/EvaluationNew-handout-1-per.pdf">https://web.stanford.edu/class/cs276/handouts/EvaluationNew-handout-1-per.pdf</a></p>
</li>
</ul>
<p><img src="./learning-to-rank-2.png" alt="Metrics" />
<img src="./learning-to-rank-3.png" alt="Metrics" />
<img src="./learning-to-rank-4.png" alt="Metrics" /></p>
<p>AP@5 is per user</p>
<p>mAP@5 is averaged across all users</p>
<h2 id="variants"><a class="header" href="#variants"><strong>Variants</strong></a></h2>
<ul>
<li>RankNet (agnostic to actual ranking, because of training the data in a pairwise manner)</li>
<li>LambdaRank</li>
<li>LambdaMART</li>
</ul>
<h2 id="others-2"><a class="header" href="#others-2"><strong>Others</strong></a></h2>
<ul>
<li>RankSVM</li>
<li>RankBoost</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="deep-generative-models"><a class="header" href="#deep-generative-models">Deep generative models</a></h1>
<hr />
<p>Supervised learning: learn function to map x to y.</p>
<p>Unsupervised learning: learn hidden or underlying structure of data</p>
<p>Generative modelling: learn a model that represents distribution of data</p>
<p>Main tasks:</p>
<ul>
<li>Density estimation</li>
<li>Sample generation</li>
</ul>
<h1 id="why-learn-generative-models"><a class="header" href="#why-learn-generative-models">Why learn generative models?</a></h1>
<p>Debiasing</p>
<p>Outlier detection</p>
<h1 id="generative-models"><a class="header" href="#generative-models">Generative models</a></h1>
<p><img src="Deep_Generative_Modeling_Summary.png" alt="Deep_Generative_Modeling_Summary.png" /></p>
<ul>
<li>Autoencoder</li>
<li>VAE</li>
<li>GAN</li>
</ul>
<blockquote>
<p>💡 <strong>Autoencoders</strong>
Bottleneck hidden layer foreces network to learn a compressed latent representation. Reconstruction loss forces the latent representation to capture as much information about the data as possible.</p>
</blockquote>
<h2 id="autoencoder"><a class="header" href="#autoencoder">Autoencoder</a></h2>
<p><img src="Autoencoders_background.png" alt="Autoencoders_background.png" /></p>
<p>Encoder learns mapping from the data x to a low-dimensional latent space z (“compressed”).</p>
<p>Decoder learns mapping from latent z to a reconstructed observation, x_hat.</p>
<p>Loss function is L(x, x_hat). It doesn’t use any labels.</p>
<p>Reconstruction loss forces the latent representation to capture as much information about the data as possible.</p>
<h2 id="vae"><a class="header" href="#vae">VAE</a></h2>
<p><img src="VAE_optimization.png" alt="VAE_optimization.png" /></p>
<p>Variational autoencoder</p>
<p>Instead of learning a deterministic latent vector z, we learn a vector of mean and a vector std that parametrise the probability distribution for each of the latent variables</p>
<p><img src="VAE_optimization%201.png" alt="VAE_optimization%201.png" /></p>
<p><img src="VAE_optimization%202.png" alt="VAE_optimization%202.png" /></p>
<p><img src="Reparametrizing_the_sampling_layer.png" alt="Reparametrizing_the_sampling_layer.png" /></p>
<p><img src="VAEs_Latent_perturbation.png" alt="VAEs_Latent_perturbation.png" /></p>
<p><img src="VAEs_Latent_perturbation%201.png" alt="VAEs_Latent_perturbation%201.png" /></p>
<h2 id="gan"><a class="header" href="#gan">GAN</a></h2>
<p>Generative Adversarial Network</p>
<p>Instead of explicitly modelling the density (distribution of data), we just sample to generate new instances. However, we can’t sample from complex distribution directly. Thus the solution is to sample from something simple (noise), <strong>learn a transformation</strong> to the training distribution.</p>
<blockquote>
<p>💡 We also cannot measure the difference of the generated samples with training samples because it's too expensive.</p>
</blockquote>
<p>Adversaries (neural networks): </p>
<ul>
<li>The generator turns noise into an imitation of the data</li>
<li>The discriminator tries to discern between a fake generated by the generator and the true data.</li>
</ul>
<h1 id="uses"><a class="header" href="#uses">Uses</a></h1>
<p>Style transfer: CycleGAN</p>
<h1 id="mitigating-bias-through-learned-latent-structure"><a class="header" href="#mitigating-bias-through-learned-latent-structure">Mitigating bias through learned latent structure</a></h1>
<ol>
<li>Learn latent structure using VAE.</li>
<li>Estimate distribution. (How?)</li>
<li>Adaptively resample data.</li>
<li>Learn from fair data distribution.</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="association-rule-mining"><a class="header" href="#association-rule-mining">Association rule mining</a></h1>
<p>Suitable for nominal data?</p>
<p>The goal of association rule mining is to find interesting or significant association rules and to find them efficiently.</p>
<p><img src="./arm-01.png" alt="" /></p>
<p>Applications</p>
<ul>
<li>
<p>Market basket analysis</p>
<ul>
<li>Shelf management, item placement. (put cereal and milk at opposite ends of NTUC to force people to chance upon other items)</li>
<li>Promotion bundles</li>
<li>Recommendations</li>
<li>Pricing strategies</li>
</ul>
</li>
<li>
<p>Medical data analysis</p>
<p>Note that there are 2 types of items here.</p>
<p><img src="./arm-02.png" alt="" /></p>
</li>
<li>
<p>Census data analysis</p>
<p><img src="./arm-03.png" alt="" /></p>
</li>
<li>
<p>Behaviour data analysis</p>
<p><img src="./arm-04.png" alt="" /></p>
</li>
</ul>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span> unique items result in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9324em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9324em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> possible rules<sup class="footnote-reference"><a href="#allcombinations">1</a></sup>.</p>
<p>Definitions</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span>: no. of unique items</p>
<p><strong>Itemset;</strong> <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>: a subset of items</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>: an association rule</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>: no. of transactions</p>
<p><strong>Support count</strong>: no. of transactions that <em>has</em> this itemset</p>
<p><strong>Support</strong>: </p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.9781em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2921em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal">pp</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mord mathnormal">t</span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p><strong>Frequent itemset</strong>: itemsets with at least <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">min</span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal">p</span></span></span></span> support</p>
<p><strong>Support of an association rule</strong>:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p><strong>Confidence of a rule</strong>: </p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p><strong>Lift</strong>:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<blockquote>
<p>💡 A high support means that the itemset frequently appear together <em>historically</em></p>
</blockquote>
<blockquote>
<p>💡 A high confidence means that if an itemset X appears, it usually appears with itemset Y</p>
</blockquote>
<blockquote>
<p>💡 If S({milk, bread}) = 10, then S({milk, bread, ...}) ≤ 10</p>
</blockquote>
<p><img src="./arm-05.png" alt="" /></p>
<p><img src="./arm-06.png" alt="" /></p>
<h2 id="brute-force"><a class="header" href="#brute-force">Brute force</a></h2>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1491em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<ul>
<li>Specify minimum confidence and minimum support.</li>
<li>List all rules</li>
<li>Drop rules that don't meet the requirement</li>
</ul>
<h2 id="apriori"><a class="header" href="#apriori">Apriori</a></h2>
<p><img src="./arm-07.png" alt="" /></p>
<p><img src="./arm-08.png" alt="" /></p>
<p>Two-Part algorithm for mining association rules</p>
<ol>
<li>Frequent itemset generation
<ul>
<li>Generate all possible itemsets</li>
<li>Drop itemsets that don't meet the <code>minSup</code> requirement</li>
</ul>
</li>
<li>Association rule generation
<ul>
<li>Drop rules that don’t meet the the <code>minconf</code> requirement</li>
</ul>
</li>
</ol>
<hr />
<div class="footnote-definition" id="allcombinations"><sup class="footnote-definition-label">1</sup>
<p>Explanation why <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span> unique items result in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9324em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9324em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> possible rules.</p>
</div>
<p>An item can be either be on the LHS, RHS or neither (&quot;None&quot;).</p>
<pre><code>Item 1: [LHS, RHS, None]
Item 2: [LHS, RHS, None]
Item 3: [LHS, RHS, None]
...
Item d: [LHS, RHS, None]
</code></pre>
<p>Any possible state can be obtained by drawing a path from one of the 3 states in Item 1 down to one of the 3 states in Item <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span>. For <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span></span></span></span>, a possible state is</p>
<p><code>[LHS,None,RHS,RHS]</code></p>
<p>which denotes <code>{1} -&gt; {3,4}</code>.</p>
<p>First, we calculate the total number of possible states, which is  <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span>. -- (1)</p>
<p>However, we should remove the states that are not allowed eg. <code>{} -&gt; {3,4}</code>.</p>
<p>It is not possible to have only one side filled up, say only the RHS. For this to happen, an item is allowed to be in 2 different positions at a time (LHS and None). This gives us <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span> positions. -- (2)</p>
<pre><code>Item 1: [LHS, None]
Item 2: [LHS, None]
Item 3: [LHS, None]
...
Item d: [LHS, None]
</code></pre>
<p>We repeat this for when items are only filled up on the LHS. This gives us <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span> positions. -- (3)</p>
<pre><code>Item 1: [RHS, None]
Item 2: [RHS, None]
Item 3: [RHS, None]
...
Item d: [RHS, None]
</code></pre>
<p>Note that in the previous two cases, we eliminated a case twice -- the case where all items are None. So we will add 1 back. -- (4)</p>
<pre><code>Item 1: None
Item 2: None
Item 3: None
...
Item d: None
</code></pre>
<p>Starting with the total possible states (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span>), we remove the states that cannot happen from the 3 cases above:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.6773em;vertical-align:-3.5887em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.0887em;"><span style="top:-6.0887em;"><span class="pstrut" style="height:2.8991em;"></span><span class="mord"></span></span><span style="top:-4.5887em;"><span class="pstrut" style="height:2.8991em;"></span><span class="mord"></span></span><span style="top:-3.0296em;"><span class="pstrut" style="height:2.8991em;"></span><span class="mord"></span></span><span style="top:-1.5296em;"><span class="pstrut" style="height:2.8991em;"></span><span class="mord"></span></span><span style="top:0.0296em;"><span class="pstrut" style="height:2.8991em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5887em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.0887em;"><span style="top:-6.1896em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span><span style="top:-3.1304em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span><span style="top:-0.0713em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5887em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="decision-tree"><a class="header" href="#decision-tree">Decision tree</a></h1>
<p><strong>#nonparametric</strong> <strong>#nonprobabilistic</strong></p>
<p>Keep splitting, split based on highest Gini Gain or Information Gain.</p>
<blockquote>
<p>💡 Gini impurity is a way of measuring if a split is &quot;good&quot;. Calculate Gini impurities (1) before split, (2) left branch and (3) right branch. Then weight the impurities of each branch (2) and (3). Then calculate how much impurity is removed by taking (1) minus the weighted (2) and (3).</p>
</blockquote>
<p>Try every split:</p>
<ul>
<li>Every feature</li>
<li>Every possible threshold (optimisable)</li>
</ul>
<p>Stop when:</p>
<ul>
<li>All Gini gains are the same</li>
<li>No Gini gain</li>
</ul>
<p>Algorithms:</p>
<ul>
<li>ID3 (multiway)
<ul>
<li>Brute force</li>
</ul>
</li>
<li>C4.5 (binary)
<ul>
<li>Brute force</li>
</ul>
</li>
<li>CART
<ul>
<li>Construct binary trees from using features and thresholds that yield highest information gain</li>
</ul>
</li>
</ul>
<blockquote>
<p>👉 Tree-based algorithms don’t require scaling!</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="dbscan"><a class="header" href="#dbscan">DBSCAN</a></h1>
<p>Density-based spatial clustering of applications with noise</p>
<p><strong>#nonparametric</strong> <strong>#nonprobabilistic</strong></p>
<ul>
<li><a href="dbscan.html#from-cs5228">From CS5228:</a>
<ul>
<li><a href="dbscan.html#quiz">Quiz</a></li>
<li><a href="dbscan.html#review">Review</a></li>
</ul>
</li>
</ul>
<hr />
<p>The DBSCAN algorithm views clusters as areas of high density separated by areas of low density.</p>
<ol>
<li>Choose 2 numbers: max_distance, min_points</li>
<li>Pick a random datapoint. This is cluster A</li>
<li>Criteria for datapoints to be in this cluster:
<ol>
<li>They are within a distance of max_distance</li>
<li>There are more than min_points datapoints</li>
</ol>
</li>
<li>Once run out of points, find another datapoint that has no cluster. This is Cluster B.</li>
</ol>
<h2 id="from-cs5228"><a class="header" href="#from-cs5228">From CS5228:</a></h2>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal">in</span><span class="mord mathnormal">Pt</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></p>
<p>Clusters: <strong>density-based</strong></p>
<p>Clustering: partitional, exclusive, <strong>partial</strong></p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.7936em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">ma</span><span class="mord mathnormal">ss</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0463em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal">in</span><span class="mord mathnormal">Pt</span><span class="mord mathnormal">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span> is the radius defining no. of points in the neighbourhood and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal">in</span><span class="mord mathnormal">Pt</span><span class="mord mathnormal">s</span></span></span></span> the min. no. of points for it to be a core point.</p>
<p><img src="./dbscan-01.png" alt="Types of points" /></p>
<p>There are 3 types of points:</p>
<ul>
<li>Core points: Any points with at least MinPts neighours in a radius <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span>.</li>
<li>Border points: Any non-core points with at least one core point within the radius <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span>.</li>
<li>Outliers</li>
</ul>
<p>Algorithm:</p>
<ol>
<li>
<p>Repeat</p>
<ol>
<li>Pick a random unexplored point x.</li>
<li>If x is not a core point, label as noise (might change later). </li>
</ol>
<p>Until x is a core point</p>
</li>
<li>
<p>Then explore this new cluster starting from this core point. </p>
<ul>
<li>A neighbour of a cluster is never a noise.</li>
<li>Do for all neighbours</li>
<li>Exploration stops once there are no more core points.</li>
</ul>
<p><img src="./dbscan-02.png" alt="Exploration" /></p>
</li>
</ol>
<p><img src="https://www.comp.nus.edu.sg/~chris/downloads/images/dbscan-visualized.gif" alt="https://www.comp.nus.edu.sg/~chris/downloads/images/dbscan-visualized.gif" /></p>
<blockquote>
<p>💡 Note that a noise point can become a border point.</p>
</blockquote>
<ul>
<li>
<p>Always converges</p>
</li>
<li>
<p>Cannot handle different densities</p>
<p><img src="./dbscan-03.png" alt="Different densities" /></p>
</li>
<li>
<p>Very sensitive to parameters</p>
<p><img src="./dbscan-04.png" alt="Sensitive to parameters" /></p>
<p>Parameters can be chosen by</p>
<ul>
<li>
<p>EDA: plot distribution of all pairwise distances. This can help us to decide suitable values for <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span>.</p>
<p><img src="./dbscan-05.png" alt="Find epsilon" /></p>
</li>
<li>
<p>Intuitive semantic meaning of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal">in</span><span class="mord mathnormal">Pt</span><span class="mord mathnormal">s</span></span></span></span>.</p>
</li>
</ul>
</li>
</ul>
<h3 id="quiz"><a class="header" href="#quiz">Quiz</a></h3>
<p><img src="./dbscan-06.png" alt="Quiz" /></p>
<p><img src="./dbscan-07.png" alt="Quiz" /></p>
<p><img src="./dbscan-08.png" alt="Quiz" /></p>
<h3 id="review"><a class="header" href="#review">Review</a></h3>
<p><img src="./dbscan-09.png" alt="Review" /></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="evolutionary-algorithms"><a class="header" href="#evolutionary-algorithms">Evolutionary algorithms</a></h1>
<p>Subject a <strong>population</strong> to a heuristic survival-of-the-fittest competition. Individuals that score higher on the <strong>fitness function</strong> are granted more <strong>offspring</strong> in the next generation through <strong>crossover</strong> and <strong>mutation</strong> (slightly perturbed copes of themselves or combinations of themselves with other individuals). Individuals that score poorly are removed from the population.</p>
<ul>
<li>Genetic algorithm</li>
<li>Evolution strategy</li>
<li>Natural evolution strategy</li>
</ul>
<h1 id="natural-evolution-strategies-openai"><a class="header" href="#natural-evolution-strategies-openai">Natural Evolution Strategies (OpenAI)</a></h1>
<p>Individuals come from a probability distribution (usually Gaussian) around a single set of parameters. Iteratively update this population distribution such that average fitness of individuals drawn from population is maximised. Objective function is differentiable.</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="frequent-itemsets"><a class="header" href="#frequent-itemsets">Frequent itemsets</a></h1>
<h2 id="brute-force-1"><a class="header" href="#brute-force-1">Brute force</a></h2>
<p>Computationally expensive. Not enough memory.</p>
<h2 id="apriori-1"><a class="header" href="#apriori-1">Apriori</a></h2>
<p><em>k</em> passes</p>
<blockquote>
<p>✅ Less expensive (use the anti-monotone property)</p>
</blockquote>
<h2 id="pcy"><a class="header" href="#pcy">PCY</a></h2>
<p>(Park-Chen-Yu)</p>
<p><em>k</em> passes</p>
<blockquote>
<p>✅ Less memory</p>
</blockquote>
<h2 id="random-sampling"><a class="header" href="#random-sampling">Random sampling</a></h2>
<p>no. of passes can be customised</p>
<p>Run an algorithm eg. Apriori. </p>
<p>Note that false positives (itemset may be frequent in the sample but not in the entire set of baskets) false negatives may occur. To reduce these, we can use a smaller threshold, but requires more space.</p>
<h2 id="son"><a class="header" href="#son">SON</a></h2>
<p>(Savasere Omiencinski Navathe)</p>
<p>2 passes</p>
<p>Divide the baskets into chunks</p>
<p>Key ideas:</p>
<ol>
<li>If an itemset is not frequent in any chunk, then it is indeed not frequent.</li>
<li>If an itemset is indeed frequent, then it is frequent in at least one chunk.</li>
</ol>
<blockquote>
<p>✅ Less memory (cos distributed)</p>
</blockquote>
<p><img src="./frequent-itemsets-1.png" alt="Untitled" /></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="gaussian-process"><a class="header" href="#gaussian-process">Gaussian process</a></h1>
<pre><code class="language-python">import numpy as np
from sklearn.metrics.pairwise import rbf_kernel

class Kernel:
    @staticmethod
    def rbf(x_1, x_2):
        K = rbf_kernel(x_1, x_2)
        return K

class GaussianProcess:

    def __init__(self, X, y, kernel=&quot;rbf&quot;):
        self.X = X
        self.y = y

        # Prepare kernel
        self.k = Kernel.rbf(self.X, self.X)

        # Invert kernel
        self.k_inv = np.linalg.inv(self.k)

    def hey(self):
        pass

    def update(self, X_new, y_new):
        &quot;&quot;&quot;Not used&quot;&quot;&quot;

        self.X = np.concatenate(self.X, X_new, axis=0)
        self.y = np.concatenate(self.y, y_new, axis=0)

        # Update the covariance matrix for existing training points
        self.k = Kernel.rbf(self.X, self.X)
        self.k_inv = np.linalg.inv(self.k)

    def predict(self, X_new):
        &quot;&quot;&quot;Predict a value&quot;&quot;&quot;

        # Get all the kernel parts
        k_new = np.array(
            [Kernel.rbf(X_new, np.array([x])).reshape(-1) for x in self.X])
        k_newnew = Kernel.rbf(X_new, X_new)

        # Mean
        y_pred = np.dot(k_new.T, self.k_inv).dot(self.y)
        y_pred = y_pred.squeeze()

        # Covariance
        sigma = k_newnew - np.dot(k_new.T, self.k_inv).dot(k_new)
        sigma = sigma.squeeze()

        return y_pred, sigma
</code></pre>
<pre><code class="language-python">import numpy as np
from gp import Kernel, GaussianProcess
import matplotlib.pyplot as plt

# Real
X = np.linspace(1,20,10000)
X = X.reshape(1,-1)
y = np.sin(X)
plt.scatter(X,y, color='black')

# Data
SIZE = 5
X = np.random.uniform(low=1, high=20, size=SIZE)
X = X.reshape(-1,1)
y = np.sin(X) + np.random.normal(0, 0.3, SIZE).reshape(-1,1)
plt.scatter(X,y, color='yellow')

# New data
X_new = np.random.uniform(low=1, high=20, size=100)
X_new = X_new.reshape(-1,1)

# GP
gp = GaussianProcess(X, y)
y_new = gp.predict(X_new)
plt.scatter(X_new,y_new, color='red', alpha=0.5)

# Plot
plt.show()
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="gmm"><a class="header" href="#gmm">GMM</a></h1>
<p>Gaussian Mixture Model</p>
<p><strong>#parametric</strong> <strong>#probabilistic</strong></p>
<p>A probabilistic model that assumes all the data points are generated from a mixture of Gaussian distributions with unknown parameters</p>
<p>Optimiser: EM algorithm</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="hierachical-clustering"><a class="header" href="#hierachical-clustering">Hierachical clustering</a></h1>
<ul>
<li>agglomerative (slowly accumulate)</li>
<li>divisive (slowly split)</li>
</ul>
<p>Naive implementation has time complexity <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> is the no. of datapoints</p>
<ol>
<li>Find pairwise distance — <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
<li>Merge the 2 closest points.</li>
<li>Repeat for the other <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> points — <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></li>
</ol>
<p>Can use priority queue to get <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>.</p>
<p>Hierarchical clustering is achieved by use of a metric and a linkage criterion.</p>
<p>Examples of linkage criteria:</p>
<ul>
<li>Single linkage (minimum)</li>
<li>Complete linkage (maximum)</li>
<li>Average linkage (average between pairs)</li>
<li>Ward</li>
<li>Centroid</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="gradient-boosting"><a class="header" href="#gradient-boosting">Gradient boosting</a></h1>
<p><img src="./gradient-boosting.png" alt="Gradient boosting" /></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="k-means"><a class="header" href="#k-means">k-means</a></h1>
<p><strong>#nonparametric</strong></p>
<ul>
<li><a href="k-means.html#before-notes">Before notes</a></li>
<li><a href="k-means.html#from-cs5228">From CS5228:</a>
<ul>
<li><a href="k-means.html#lloyds-algorithm">Lloyd's algorithm</a></li>
<li><a href="k-means.html#k-means">k-means++</a></li>
<li><a href="k-means.html#x-means">X-means</a></li>
<li><a href="k-means.html#k-medoids">k-medoids</a></li>
</ul>
</li>
<li><a href="k-means.html#quiz">Quiz</a></li>
</ul>
<hr />
<h2 id="before-notes"><a class="header" href="#before-notes">Before notes</a></h2>
<ol>
<li>Assign <em>k</em> centroids randomly</li>
<li>Get each data point to see which centroid it’s closest to, and assign a class</li>
<li>Calculate centre of points for each group</li>
<li>Reassign the <em>k</em> centroids</li>
<li>Use silhouette heuristic or the elbow method to determine a reasonable value for <em>k</em></li>
</ol>
<p><img src="./k-means.png" alt="k-means" /></p>
<blockquote>
<p>💡 Assumes clusters are normally distributed in each dimension</p>
</blockquote>
<p>Time <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p>
<ol>
<li>Assign <em>k</em> centroids</li>
<li>For every datapoint, calculate distance to all other centroids — <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></li>
<li>Repeat for all datapoints — <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></li>
<li>Reassign each datapoint to the nearest cluster</li>
<li>Repeat for <em>m</em> iterations until convergence — <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span></li>
</ol>
<p>Space <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p>
<hr />
<h2 id="from-cs5228-1"><a class="header" href="#from-cs5228-1">From CS5228:</a></h2>
<p>Clusters: centroid-based</p>
<p>Clustering: partitional, exclusive, complete</p>
<p>NP-hard; <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span><span class="mord mathnormal mtight">d</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>.</p>
<p>Define the objective function to minimise:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">SSE</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.3258em;vertical-align:-1.4974em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2901em;"><span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0715em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4974em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>which is the total squared distance between every point and centroid across all the <em>K</em> clusters. For every cluster <em>k</em>, and for every point <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> in this cluster <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, find the squared distance between the point <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> and the cluster's centroid, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</p>
<p>Taking derivative with respect to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, the best centroid can be found as follows:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.2074em;vertical-align:-0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.05764em;">SSE</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span><span class="mspace newline"></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.549em;vertical-align:-0.024em;"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⟹</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.8189em;vertical-align:-1.4974em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2901em;"><span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0715em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4974em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<div id="admonition-note" class="admonition note">
<div class="admonition-title">
<p>Note</p>
<p><a class="admonition-anchor-link" href="k-means.html#admonition-note"></a></p>
</div>
<div>
<p>k-means works on relative distances.</p>
</div>
</div>
<h3 id="lloyds-algorithm"><a class="header" href="#lloyds-algorithm">Lloyd's algorithm</a></h3>
<ol>
<li>Select <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> points in the space (not datapoints) as initial centroids</li>
<li>Repeat
<ol>
<li>Assign each point to the nearest cluster</li>
<li>Reassign the centroid based on average</li>
</ol>
</li>
</ol>
<p>Note:</p>
<ul>
<li>
<p>Always converges</p>
</li>
<li>
<p>But returns a local optimum</p>
</li>
<li>
<p>Susceptible to natural clusters (only looks for spherical shapes). Potential workaround is to choose a larger value of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span>.</p>
<p><img src="./k-means-01.png" alt="" /></p>
<p><img src="./k-means-02.png" alt="" /></p>
</li>
<li>
<p>Different initialisations yield different clusterings. Some centroid can yield empty clusters.</p>
<p><img src="./k-means-03.png" alt="All the points are closest to only 1 centroid." /></p>
<p><em>All</em> the points are closest to only 1 centroid.</p>
</li>
</ul>
<h3 id="k-means-1"><a class="header" href="#k-means-1">k-means++</a></h3>
<p>Same like Lloyd's but different initialisation:</p>
<ol>
<li>
<p>Initialisation</p>
<ol>
<li>Pick random datapoint as first centroid</li>
<li>??????????  just ensures the centroids are distributed across the dataset</li>
</ol>
</li>
<li>
<p>Repeat</p>
<p>...</p>
</li>
</ol>
<blockquote>
<p>💡 Only initial centroids must be datapoints.</p>
</blockquote>
<h3 id="x-means"><a class="header" href="#x-means">X-means</a></h3>
<ol>
<li>Start with <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>.</li>
<li>For every cluster, see if it can be split by 2. This uses a scoring function like BIC, AIC, MDL.</li>
</ol>
<p><img src="./k-means-04.png" alt="X-means" /></p>
<h3 id="k-medoids"><a class="header" href="#k-medoids">k-medoids</a></h3>
<p>Use when you cannot compute averages.</p>
<p>????????? use Jaccard similarity ????? (prof didn't explain properly)</p>
<blockquote>
<p>⚠️ Centroids must be datapoints</p>
</blockquote>
<h2 id="quiz-1"><a class="header" href="#quiz-1">Quiz</a></h2>
<p><img src="./k-means-05.png" alt="QUiz" /></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="k-nn"><a class="header" href="#k-nn">k-NN</a></h1>
<p><strong>#nonparametric</strong> <strong>#nonprobabilistic</strong></p>
<p>Use a distance metric to calculate the <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> closest neighbours. Then, take its mean (or median etc.).</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e7/KnnClassification.svg/220px-KnnClassification.svg.png" alt="k-NN" /></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="lda-1"><a class="header" href="#lda-1">LDA</a></h1>
<p><a href="https://lettier.com/projects/lda-topic-modeling/">LDA visualisation from Lettier</a></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="linear-models"><a class="header" href="#linear-models">Linear models</a></h1>
<p>Uses OLS. See page for assumptions. </p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="logistic-regression"><a class="header" href="#logistic-regression">Logistic regression</a></h1>
<p><strong>#parametric</strong> <strong>#probabilistic</strong></p>
<p>A model that predicts the probability using the logistic function <span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.2574em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>Model:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3072em;vertical-align:-0.9857em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9857em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span></p>
<p>A regression model whose output (termed as logits) is mapped from a real number to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span> through the use of logistic function, which is the inverse of log odds. Log of odds is a measure of odds, which is a ratio (of probabilities).</p>
<p>To get the loss function, notice that each sample can be considered as a Bernoulli trial hence the model follows a Bernoulli distribution. Our objective is to maximise the likelihood, which is equivalent to minimising the negative of maximum likelihood.</p>
<p><strong>Why is it called logistic regression?</strong></p>
<p>It's because its underlying technique is quite the same as linear regression. The term <em>logistic</em> is taken from the logit function which is used as the method of classification. A logit function is</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">logit</span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">odds</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.988em;vertical-align:-0.8804em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>which maps values from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">∞</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∞</span><span class="mclose">)</span></span></span></span>.</p>
<p><strong>What is the relation between the logistic function and the logit function?</strong></p>
<p>A logistic function is inverse-logit:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:16.5618em;vertical-align:-8.0309em;"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:8.5309em;"><span style="top:-10.8717em;"><span class="pstrut" style="height:3.4483em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-8.5837em;"><span class="pstrut" style="height:3.4483em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span><span style="top:-6.5632em;"><span class="pstrut" style="height:3.4483em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span><span style="top:-5.0632em;"><span class="pstrut" style="height:3.4483em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span><span style="top:-3.5632em;"><span class="pstrut" style="height:3.4483em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-1.5619em;"><span class="pstrut" style="height:3.4483em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span><span style="top:0.9558em;"><span class="pstrut" style="height:3.4483em;"></span><span class="mord"></span></span><span style="top:3.5133em;"><span class="pstrut" style="height:3.4483em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:8.0309em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:8.5309em;"><span style="top:-10.8717em;"><span class="pstrut" style="height:3.4483em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-8.5837em;"><span class="pstrut" style="height:3.4483em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-6.5632em;"><span class="pstrut" style="height:3.4483em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">p</span></span></span><span style="top:-5.0632em;"><span class="pstrut" style="height:3.4483em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span><span style="top:-3.5632em;"><span class="pstrut" style="height:3.4483em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span><span style="top:-1.5619em;"><span class="pstrut" style="height:3.4483em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3414em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5904em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:0.9558em;"><span class="pstrut" style="height:3.4483em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4483em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6973em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5904em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:3.5133em;"><span class="pstrut" style="height:3.4483em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6973em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:8.0309em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:8.5309em;"><span style="top:-10.8717em;"><span class="pstrut" style="height:3.4483em;"></span><span class="eqn-num"></span></span><span style="top:-8.5837em;"><span class="pstrut" style="height:3.4483em;"></span><span class="eqn-num"></span></span><span style="top:-6.5632em;"><span class="pstrut" style="height:3.4483em;"></span><span class="eqn-num"></span></span><span style="top:-5.0632em;"><span class="pstrut" style="height:3.4483em;"></span><span class="eqn-num"></span></span><span style="top:-3.5632em;"><span class="pstrut" style="height:3.4483em;"></span><span class="eqn-num"></span></span><span style="top:-1.5619em;"><span class="pstrut" style="height:3.4483em;"></span><span class="eqn-num"></span></span><span style="top:0.9558em;"><span class="pstrut" style="height:3.4483em;"></span><span class="eqn-num"></span></span><span style="top:3.5133em;"><span class="pstrut" style="height:3.4483em;"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:8.0309em;"><span></span></span></span></span></span></span></span></span></p>
<p>which will map values from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">∞</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∞</span><span class="mclose">)</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>, which will be convenient for binary classification tasks.</p>
<p>The last form of the equation is probably easier to compute in libraries (?).</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="mean-shift"><a class="header" href="#mean-shift">Mean shift</a></h1>
<p><strong>#nonparametric</strong></p>
<p>Popular in computer vision</p>
<p>Builds on KDE</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="naive-bayes"><a class="header" href="#naive-bayes">Naive Bayes</a></h1>
<p><strong>#probabilistic</strong></p>
<p>Assumes strong independence assumption between features, where each feature x is a particular distribution (usually Gaussian), so need to get the mean and std dev.</p>
<p><a href="https://remykarem.github.io/blog/naive-bayes.html">https://remykarem.github.io/blog/naive-bayes.html</a></p>
<p>Inference time:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbf">P</span><span class="mopen">(</span><span class="mord text"><span class="mord">class</span></span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathbf">P</span><span class="mopen">(</span><span class="mord text"><span class="mord">data</span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathbf">P</span><span class="mopen">(</span><span class="mord text"><span class="mord">class</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbf">P</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mord">∣</span><span class="mord text"><span class="mord">class</span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="cnn"><a class="header" href="#cnn">CNN</a></h1>
<h2 id="calculations"><a class="header" href="#calculations">Calculations</a></h2>
<ul>
<li>
<p>Computational cost</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">ze</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">ze</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
</li>
<li>
<p>No. of parameters</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">ze</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">ze</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>where the last term is for bias</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="pagerank-1"><a class="header" href="#pagerank-1">PageRank</a></h1>
<ul>
<li><a href="pagerank.html#importance">Importance</a></li>
<li><a href="pagerank.html#pagerank">PageRank</a></li>
<li><a href="pagerank.html#pagerank-with-teleports">PageRank with Teleports</a></li>
<li><a href="pagerank.html#topic-sensitive-pagerank">Topic-sensitive PageRank</a></li>
<li><a href="pagerank.html#trustrank">TrustRank</a></li>
</ul>
<hr />
<h2 id="importance"><a class="header" href="#importance">Importance</a></h2>
<p>(aka &quot;<strong>rank</strong>&quot;, &quot;vote&quot;)</p>
<p>There are several ways to define importance of a page:</p>
<ul>
<li>
<p>no. of in-links to this page</p>
<blockquote>
<p>⚠️ susceptible to attacks</p>
</blockquote>
</li>
<li>
<p>(weighted) sum of importance of links to this page</p>
<blockquote>
<p>💡 recursive definition of importance</p>
</blockquote>
</li>
</ul>
<h2 id="pagerank-2"><a class="header" href="#pagerank-2">PageRank</a></h2>
<p>Properties of importance</p>
<ul>
<li>A vote from an important page is worth more</li>
<li>A page that votes too many pages has a smaller vote</li>
</ul>
<p>This recursive definition can be represented as</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></span></p>
<p>and can be solved via <strong>Power Iteration</strong>.</p>
<p>Issues</p>
<p>Some issues that might not ensure convergence:</p>
<ol>
<li>
<p>Spider trap</p>
<p>At the end of the day we have</p>
<pre><code class="language-python">y   0
a = 0
m   1
</code></pre>
</li>
</ol>
<p><img src="./pagerank-1.png" alt="Untitled" /></p>
<ol>
<li>
<p>Dead end</p>
<p>At the end of the day we have</p>
<pre><code class="language-python">a   0
b = 0
</code></pre>
</li>
</ol>
<p><img src="./pagerank-2.png" alt="Untitled" /></p>
<h2 id="pagerank-with-teleports"><a class="header" href="#pagerank-with-teleports">PageRank with Teleports</a></h2>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span></p>
<p>&quot;Google Matrix A&quot;</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span></p>
<p>where the second term is a matrix</p>
<p>&quot;Random teleport&quot; as a solution for spider trap</p>
<p>dead ends → assign 1/N prob</p>
<p>Random teleport will ensure convergence to a stationary distribution.</p>
<p>Random teleport ensures that the Markov chain is not reducible.</p>
<blockquote>
<p>💡 Recall that an irreducible Markov chain (can go from a state to <em>any</em> state) has a stationary probability distribution if and only if ALL of its states are positive recurrent.</p>
</blockquote>
<p><img src="./pagerank-3.png" alt="Untitled" /></p>
<p><img src="./pagerank-6.png" alt="Untitled" /></p>
<h2 id="topic-sensitive-pagerank"><a class="header" href="#topic-sensitive-pagerank">Topic-sensitive PageRank</a></h2>
<p><img src="./pagerank-4.png" alt="Untitled" /></p>
<p><img src="./pagerank-5.png" alt="Untitled" /></p>
<p>&quot;<strong>teleport set&quot;</strong> is the set of pages of similar topic</p>
<h2 id="trustrank"><a class="header" href="#trustrank">TrustRank</a></h2>
<p>goal is to identify trusted vs untrusted pages.</p>
<p>this assumes that good pages only rarely link to bad pages.</p>
<p>start with a small set of trusted pages and propagate trust.</p>
<p>&quot;<strong>teleport set</strong>&quot; is the set of trusted pages</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="pca"><a class="header" href="#pca">PCA</a></h1>
<p>Principal Component Analysis</p>
<p><strong>#parametric</strong> <strong>#nonprobabilistic</strong></p>
<p><a href="https://towardsdatascience.com/visualizing-principal-component-analysis-with-matrix-transforms-d17dabc8230e?gi=2dbc0f4e5157">https://towardsdatascience.com/visualizing-principal-component-analysis-with-matrix-transforms-d17dabc8230e?gi=2dbc0f4e5157</a></p>
<p>Premise: the useful information is the underlying axes of data that gives you most variance</p>
<ul>
<li>Linear dimension reduction technique</li>
<li>Things that are different end up very far apart</li>
<li>Maximises variance and preserves large pairwise distances</li>
<li>Computationally cheap</li>
<li>“Redefine new axes”</li>
</ul>
<p><strong>Principal components</strong></p>
<p>They are the</p>
<ul>
<li>Underlying “axes” of data</li>
<li>= “directions” (= eigenvectors) where the data is most spread out, i.e have the most variance (variance = eigenvalues)
<ul>
<li>No. of eigenvalues/eigenvectors equals to no. of dimensions of data</li>
<li>The eigenvectors are perpendicular (= orthogonal) to each other</li>
</ul>
</li>
</ul>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from sklearn.decomposition import PCA

# Generate data
angle = np.radians(30.)
x1 = np.random.normal(scale=8, size=100)
x2 = x1*np.tan(angle) + np.random.normal(scale=3, size=100)
# x2 = np.random.normal(scale=3, size=100)
x1 = x1-np.mean(x1)
x2 = x2-np.mean(x2)
data = np.array([x1, x2])

# PCA
pca = PCA()
pca.fit(data.T)

# Matrix transformation
# angle = np.radians(30. - 360.) # same
angle_derotate = -angle
derotate = np.array([[np.cos(angle_derotate), -np.sin(angle_derotate)],
                     [np.sin(angle_derotate), np.cos(angle_derotate)]])
derotated_data = np.matmul(derotate, data)

rotate = np.array([[np.cos(angle_derotate), np.sin(angle_derotate)],
                     [-np.sin(angle_derotate), np.cos(angle_derotate)]])
rotated_data = np.matmul(data.T, rotate)

# Get explained variances
print(&quot;Variance in X: {:0.1f}&quot;.format(np.var(derotated_data[0])))
print(&quot;Variance in Y: {:0.1f}&quot;.format(np.var(derotated_data[1])))
print(pca.explained_variance_)

# Get the principal components
print(derotate)
print(rotate)
print(pca.components_.T)

# Covariance
# print(np.cov(data))
# print(np.matmul(np.matmul(derotate, data).T, rotate)) ????
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="svm"><a class="header" href="#svm">SVM</a></h1>
<p>Support Vector Machine</p>
<p><strong>What is SVM?</strong></p>
<p>SVM is a supervised learning algorithm that maximises the margin between classes by finding the best decision boundary that separates the data into its classes. The datapoints which are at the margin are called <strong>support vectors</strong>.</p>
<p>“Large-margin classifier”</p>
<ul>
<li>Linear separable</li>
<li>Nonlinear separable
<ul>
<li><strong>Soft Margin</strong>
Two types of misclassifications are tolerated by SVM under soft margin:
<ul>
<li>The dot is on the wrong side of the decision boundary but on the correct side/ on the margin (shown in left)</li>
<li>The dot is on the wrong side of the decision boundary and on the wrong side of the margin (shown in right)</li>
</ul>
</li>
<li><strong>Kernel Tricks</strong>
<ul>
<li>What Kernel Trick does is it utilises existing features, applies some transformations, and creates new features.</li>
<li>Think of the polynomial kernel as a transformer/processor to generate new features by applying the polynomial combination of all the existing features.</li>
<li>Think of the Radial Basis Function kernel as a transformer/processor to generate new features by measuring the distance between all other dots to a specific dot/dots — centres.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="visualisation"><a class="header" href="#visualisation">Visualisation</a></h2>
<p><a href="https://dash.gallery/dash-svm/">https://dash.gallery/dash-svm/</a></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="t-sne"><a class="header" href="#t-sne">t-SNE</a></h1>
<p><strong>#nonparametric</strong></p>
<p>t-Distributed Stochastic Neighbour Embedding (2008)</p>
<ul>
<li>Unsupervised non-linear technique</li>
<li>Things that are close remain close (?)</li>
<li>preserving only small pairwise distances or local similarities</li>
<li>Perplexity ~ a guess about the number of close neighbours each point has. 5-50</li>
<li>Creates 2D maps from multidimensional data</li>
<li>More computationally expensive</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="umap"><a class="header" href="#umap">UMAP</a></h1>
<p><strong>#nonparametric</strong> <strong>#nonprobabilistic</strong></p>
<p>Uniform Manifold Approximation and Projection</p>
<ol>
<li>The data is uniformly distributed on a Riemannian manifold;</li>
<li>The Riemannian metric is locally constant (or can be approximated as such);</li>
<li>The manifold is locally connected.</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="similarity-measures"><a class="header" href="#similarity-measures">Similarity measures</a></h1>
<p>Distance metrics, distance measures</p>
<p>For <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> datapoints, computing pairwise distance is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> because </p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="mord"><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>Axioms of distance measures:</p>
<ul>
<li>
<p>Non-negativity — d(a,b) ≥ 0</p>
</li>
<li>
<p>Symmetry — dist(a,b) = dist(b,a)</p>
</li>
<li>
<p>Identity — d(a,b) = 0 iff a=b</p>
</li>
<li>
<p>Triangle equality — d(a,b) ≤ d(a,x) + d(x,b)</p>
<pre><code class="language-python">       a *
 
                       * x

           b *
</code></pre>
</li>
</ul>
<h2 id="manhattan-distance"><a class="header" href="#manhattan-distance">Manhattan distance</a></h2>
<p>(shortest path by along a grid) L1 norm</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">∣</span></span></span></span></span></p>
<p>or</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.3277em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span></span></p>
<h2 id="euclidean-distance"><a class="header" href="#euclidean-distance">Euclidean distance</a></h2>
<p>(shortest path) L2 norm</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣∣</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>or</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.04em;vertical-align:-1.52em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.52em;"><span class="svg-align" style="top:-5em;"><span class="pstrut" style="height:5em;"></span><span class="mord" style="padding-left:1em;"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.48em;"><span class="pstrut" style="height:5em;"></span><span class="hide-tail" style="min-width:1.02em;height:3.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='3.08em' viewBox='0 0 400000 3240' preserveAspectRatio='xMinYMin slice'><path d='M473,2793 c339.3,-1799.3,509.3,-2700,510,-2702 l0 -0 c3.3,-7.3,9.3,-11,18,-11 H400000v40H1017.7 s-90.5,478,-276.2,1466c-185.7,988,-279.5,1483,-281.5,1485c-2,6,-10,9,-24,9 c-8,0,-12,-0.7,-12,-2c0,-1.3,-5.3,-32,-16,-92c-50.7,-293.3,-119.7,-693.3,-207,-1200 c0,-1.3,-5.3,8.7,-16,30c-10.7,21.3,-21.3,42.7,-32,64s-16,33,-16,33s-26,-26,-26,-26 s76,-153,76,-153s77,-151,77,-151c0.7,0.7,35.7,202,105,604c67.3,400.7,102,602.7,104, 606zM1001 80h400000v40H1017.7z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.52em;"><span></span></span></span></span></span></span></span></span></span></p>
<h2 id="dot-product"><a class="header" href="#dot-product">Dot product</a></h2>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></span></p>
<p>or</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.3277em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<blockquote>
<p>💡 Difference between dot product and inner product is that the dot product is a specific inner product that works on <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathcal">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>.</p>
</blockquote>
<h2 id="cosine-similarity"><a class="header" href="#cosine-similarity">Cosine similarity</a></h2>
<p>(we are interested in the orientation, not the magnitude of vectors). Value is bounded between <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>.</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2963em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣∣</span><span class="mord mathnormal">A</span><span class="mord">∣∣</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">∣∣</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">∣∣</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>or</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.5697em;vertical-align:-1.13em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4397em;"><span style="top:-2.1769em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9331em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.4231em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8931em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119 c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120 c340,-704.7,510.7,-1060.3,512,-1067 l0 -0 c4.7,-7.3,11,-11,19,-11 H40000v40H1012.3 s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232 c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1 s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26 c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z M1001 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3069em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9331em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.4231em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8931em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119 c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120 c340,-704.7,510.7,-1060.3,512,-1067 l0 -0 c4.7,-7.3,11,-11,19,-11 H40000v40H1012.3 s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232 c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1 s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26 c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z M1001 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3069em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.6897em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.13em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<blockquote>
<p>💡 Difference between dot product and cosine similarity is that <strong>cosine similarity ignores the magnitude</strong> (scaled by magnitude).</p>
</blockquote>
<h2 id="pearson-correlation"><a class="header" href="#pearson-correlation">Pearson correlation</a></h2>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Corr</span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.2509em;vertical-align:-1.73em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5209em;"><span style="top:-2.11em;"><span class="pstrut" style="height:3.2508em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9101em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">a</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-2.8701em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119 c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120 c340,-704.7,510.7,-1060.3,512,-1067 l0 -0 c4.7,-7.3,11,-11,19,-11 H40000v40H1012.3 s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232 c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1 s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26 c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z M1001 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3299em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2508em;"><span class="svg-align" style="top:-3.8em;"><span class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8312em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.2108em;"><span class="pstrut" style="height:3.8em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.88em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.88em' viewBox='0 0 400000 1944' preserveAspectRatio='xMinYMin slice'><path d='M983 90 l0 -0 c4,-6.7,10,-10,18,-10 H400000v40 H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7 s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744 c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30 c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722 c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5 c53.7,-170.3,84.5,-266.8,92.5,-289.5z M1001 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5892em;"><span></span></span></span></span></span></span></span><span style="top:-3.4808em;"><span class="pstrut" style="height:3.2508em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.9405em;"><span class="pstrut" style="height:3.2508em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">a</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8312em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.73em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<blockquote>
<p>💡 Difference between cosine similarity and correlation is correlation is <strong>invariant to shifts.</strong></p>
</blockquote>
<h2 id="minkowski-distance"><a class="header" href="#minkowski-distance">Minkowski distance</a></h2>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> norm</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.3277em;vertical-align:-1.2777em;"></span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2868em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0368em;"><span style="top:-3.4458em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4829em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li>Jaccard distance: compare the unique items</li>
<li>Mahalanobis distance</li>
<li>Maximum distance</li>
<li>Haversine distance - distance between 2 points on a sphere</li>
<li>Hamming distance</li>
<li>Levenshtein distance</li>
</ul>
<p><img src="./Euclidean_Distance.png" alt="Euclidean distance" /></p>
<h2 id="jaccard-distance"><a class="header" href="#jaccard-distance">Jaccard distance</a></h2>
<h2 id="mahalanobis-distance"><a class="header" href="#mahalanobis-distance">Mahalanobis distance</a></h2>
<p>&quot;how many standard deviations away&quot;</p>
<p>Euclidean distance, but normalised with standard deviation</p>
<h2 id="edit-distance"><a class="header" href="#edit-distance">Edit distance</a></h2>
<p>Min. no. of inserts and deletes of characters to convert one to another</p>
<pre><code class="language-python">d(&quot;abcde&quot;, &quot;acfdeg&quot;) = 3
</code></pre>
<ol>
<li>Remove g</li>
<li>Insert f</li>
<li>Insert b</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="similarity-search"><a class="header" href="#similarity-search">Similarity search</a></h1>
<ul>
<li><a href="similarity-search.html#brute-force">Brute force</a></li>
<li><a href="similarity-search.html#min-hashing">Min-hashing</a></li>
</ul>
<hr />
<h2 id="brute-force-2"><a class="header" href="#brute-force-2">Brute force</a></h2>
<p>Given <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> documents, there are <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2723em;vertical-align:-0.35em;"></span><span class="mord"><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9223em;"><span style="top:-2.355em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.144em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.355em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> combinations.</p>
<p>Complexity is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> .</p>
<h2 id="min-hashing"><a class="header" href="#min-hashing">Min-hashing</a></h2>
<p>Complexity is... <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>?</p>
<p><strong>Distance</strong></p>
<ul>
<li>
<p>Jaccard</p>
<p><img src="./similarity-search-0.png" alt="Untitled" /></p>
</li>
</ul>
<p><img src="./similarity-search-1.png" alt="Untitled" /></p>
<p>doc1: <code>the cat is is is glad today</code></p>
<p>doc2: <code>the cat is glad</code></p>
<ol>
<li>
<p><strong>Shingling</strong></p>
<p>n-gram</p>
<pre><code>
             doc1 doc2 ... docN
             ------------------
   (the cat)    1    1
    (cat is)    1    1
   (is glad)    1    1
(glad today)    1    0

1 indicates that the shingle exists in the doc1
</code></pre>
</li>
<li>
<p><strong>Min-hash</strong></p>
<p>hash each document. Highly similar documents usually have the same document</p>
<pre><code class="language-python">doc = &quot;the cat is is is glad&quot;

hash(&quot;the cat&quot;) = 12 = a
hash(&quot;cat is&quot;)  = 41 = b
hash(&quot;is glad&quot;) = 37 = c

minhash(doc) = min(a,b,c) = 12
</code></pre>
<p><img src="./similarity-search-2.png" alt="Positive example" /></p>
<p>Positive example</p>
<blockquote>
<p>💡 P( h(d1)=h(d2) ) = jaccard_sim(d1, d2)</p>
</blockquote>
</li>
<li>
<p><strong>Find candidate pairs</strong></p>
<p>This is done by comparing signatures.</p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="similar-items"><a class="header" href="#similar-items">Similar items</a></h1>
<h2 id="brute-force-3"><a class="header" href="#brute-force-3">Brute force</a></h2>
<h2 id="lsh"><a class="header" href="#lsh">LSH</a></h2>
<ul>
<li>
<p>Jaccard similarity</p>
</li>
<li>
<p>Shingling</p>
<p>document → {(xx,ds), (ds,4), }</p>
<aside>
  💡 Shingles (k-grams) account for order
</aside>
<p>O(n(n-1)/2)</p>
<p>compressing shingles</p>
<pre><code class="language-python">abcab -shingle-&gt; {ab,bc,ca} -hash-&gt; {1, 5, 7}
</code></pre>
</li>
<li>
<p>Min-hashing</p>
<p>convert large set to short signatures while preserving similarity
document → f4fca09</p>
</li>
<li>
<p>Locality-Sensitivity Hashing</p>
</li>
</ul>
<p><img src="./similar-items-1.png" alt="R5; R6; R3; R4" /></p>
<p>R5; R6; R3; R4</p>
<p><img src="./similar-items-2.jpg" alt="Note 10 Sep 2021.jpg" /></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="dimensionality-reduction"><a class="header" href="#dimensionality-reduction">Dimensionality reduction</a></h1>
<p>to create embeddings or projection of high-dimensional vector to 3D</p>
<p>(unsupervised learning)</p>
<p>Dimensionality reduction. Reducing the dimension helps us to visualise better</p>
<p>PCA - keep global distance</p>
<p>t-SNE - focus on local distance</p>
<p>UMAP - focus on local distance, but keep more global distance</p>
<p>Random projection</p>
<p>Runtime: tSNE&gt;UMAP≥PCA</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="ann"><a class="header" href="#ann">ANN</a></h1>
<p>Approximate nearest neighbours</p>
<p>Fast computation of nearest neighbours is an active area of research. The most naive implementation i s the brute-force computation of distances between all pairs.</p>
<p><a href="http://ann-benchmarks.com/">http://ann-benchmarks.com</a></p>
<p>Fast approximate distance computations for vector similarity search</p>
<ul>
<li><a href="https://github.com/google-research/google-research/tree/master/scann">ScaNN</a></li>
<li>NGT-ONNG</li>
<li>hnswlib</li>
<li><a href="https://github.com/facebookresearch/faiss">FAISS</a></li>
<li><a href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;ved=2ahUKEwik7vrY9oLrAhVLAXIKHfz3AC4QFjAAegQIAxAC&amp;url=https%3A%2F%2Fgithub.com%2Fspotify%2Fannoy&amp;usg=AOvVaw1EAessPsvKY5ftaBM6VmqC">ANNOY</a></li>
<li>scikit-learn: K-D tree, Ball Tree</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="concept-drift"><a class="header" href="#concept-drift">Concept drift</a></h1>
<p>data drift, label schema change, model drift</p>
<p><a href="https://twitter.com/chipro/status/1313921889061015557?s=20">https://twitter.com/chipro/status/1313921889061015557?s=20</a></p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="interpretable-ai"><a class="header" href="#interpretable-ai">Interpretable AI</a></h1>
<p>Explainable AI / Bias in AI</p>
<p>Resources</p>
<p><a href="https://christophm.github.io/interpretable-ml-book/">https://christophm.github.io/interpretable-ml-book/</a></p>
<p><a href="https://github.com/jphall663/awesome-machine-learning-interpretability">https://github.com/jphall663/awesome-machine-learning-interpretability</a></p>
<p><a href="https://microscope.openai.com/models">https://microscope.openai.com/models</a></p>
<p><strong>Explainability</strong> refers to the understanding, in simple terms, of how exactly a model works under the hood.</p>
<p><strong>Interpretability</strong> refers to the ability of observing the effect that changes in the (i) input or (ii) parameters will have on predicted outputs</p>
<p>What is?</p>
<ul>
<li>Extracting insights to understand
<ul>
<li>Why did the model make such a prediction?</li>
<li>How does each feature affect a prediction? What if I did this?</li>
</ul>
</li>
</ul>
<p>For?</p>
<ul>
<li>Trust</li>
<li>Debugging</li>
<li>Future data collection</li>
<li>Feature engineering</li>
<li>Inform human decision-making</li>
</ul>
<p><strong>General</strong></p>
<ul>
<li>Model cards</li>
<li>explainx.ai</li>
</ul>
<h1 id="tabular"><a class="header" href="#tabular"><strong>Tabular</strong></a></h1>
<h2 id="feature-importance"><a class="header" href="#feature-importance"><strong>Feature importance</strong></a></h2>
<ul>
<li>Tree-based models</li>
<li>LIME</li>
<li>Permutation importance: shuffle the data within a column</li>
<li>Partial dependence plots: keep changing value for one variable</li>
<li>SHAP values (Shapley additive explanations): compare a value with baseline value</li>
<li>Integrated Gradients</li>
<li>DeepLift</li>
<li>Model-Agnostic Linear Competitors (MALC)</li>
<li><a href="https://github.com/pytorch/captum">Captum</a></li>
</ul>
<h2 id="constraining-nonlinear-models"><a class="header" href="#constraining-nonlinear-models"><strong>Constraining nonlinear models</strong></a></h2>
<ul>
<li>Contextual Decomposition Explanation Penalization (CDEP) add a term to the loss function so models can learn how to produce good explanations</li>
<li>MonoNet</li>
</ul>
<h2 id="interpretable-models"><a class="header" href="#interpretable-models"><strong>Interpretable models</strong></a></h2>
<ul>
<li>Decision trees: 
Information gain &amp; gini impurity. Splits that have the most impact on a prediction are kept closer to the root of the tree</li>
<li>Linear models
Implicitly interpretable, since they can naturally weight the influence of the weights. Perturbing the inputs or learned parameters has a predetermined effect on the outputs.</li>
<li>Logistic regression</li>
</ul>
<h1 id="image"><a class="header" href="#image"><strong>Image</strong></a></h1>
<p>Using feature visualisation and activation atlases</p>
<ul>
<li>
<p>Grad-CAM (Class activation map)</p>
<p>Grad-CAM works by (1) finding the final convolutional layer in the network and then (2) examining the gradient information flowing into that layer. Then multiply the signals with the outputs from (1).</p>
</li>
<li>
<p><a href="https://github.com/marcotcr/lime">LIME</a></p>
</li>
<li>
<p>Summit</p>
</li>
</ul>
<h1 id="text"><a class="header" href="#text"><strong>Text</strong></a></h1>
<ul>
<li>exBERT</li>
<li><a href="https://github.com/jalammar/ecco?utm_source=Deep+Learning+Weekly&amp;utm_campaign=6f762da6bd-EMAIL_CAMPAIGN_2019_04_24_03_18_COPY_01&amp;utm_medium=email&amp;utm_term=0_384567b42d-6f762da6bd-72969297">Ecco</a></li>
<li>Language Interpretability Tool by Google</li>
</ul>
<p>Libraries</p>
<ul>
<li>ELI5</li>
<li>pdpbox</li>
<li>shap</li>
<li>Uber’s manifold</li>
<li>What-If</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="cs5260--neural-networks-and-deep-learning-ii"><a class="header" href="#cs5260--neural-networks-and-deep-learning-ii">CS5260 — Neural Networks and Deep Learning II</a></h1>
<hr />
<h1 id="adversarial-ml"><a class="header" href="#adversarial-ml">Adversarial ML</a></h1>
<p><a href="https://www.tensorflow.org/tutorials/generative/adversarial_fgsm">https://www.tensorflow.org/tutorials/generative/adversarial_fgsm</a></p>
<h2 id="intro"><a class="header" href="#intro">Intro</a></h2>
<p>a machine learning technique that attempts to fool models by supplying deceptive input</p>
<p>adversarial example = image + noise</p>
<ul>
<li>Self-driving cars: kill people</li>
<li>Spam classifiers</li>
<li>Biometric recognition — steal money eg. apple pay</li>
</ul>
<p>Given</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3.35em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">~</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span></span></span></span></p>
<p>where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3.35em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">~</span></span></span></span></span></span></span></span></span></span> is the adversarial sample, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> is the image and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span></span></span></span> is the perturbation,</p>
<p>then if</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span></p>
<p>where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span></span></span></span> is the number small enough to be discarded by the hardware, </p>
<p>we expect the model assigns the same class to both <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3.35em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">~</span></span></span></span></span></span></span></span></span></span>.</p>
<p>This also makes use of the fact that digital images often use 8 bits per pixel:</p>
<p>(0, 1/255, 2/255, ..., 255/255)</p>
<p><img src="Untitled.png" alt="Untitled" /></p>
<ul>
<li>Take-away
<ul>
<li>A simple linear model can have adversarial examples if its input has sufficient dimensionality</li>
</ul>
</li>
</ul>
<h2 id="how-to-attack"><a class="header" href="#how-to-attack">How to attack</a></h2>
<h3 id="fgsm-whitebox"><a class="header" href="#fgsm-whitebox">FGSM (whitebox)</a></h3>
<p>Fast Gradient Sign Method</p>
<p>attacker has complete access to the model (white box attack)</p>
<p><img src="Untitled%201.png" alt="Untitled" /></p>
<h3 id="one-step-target-class-method-whitebox"><a class="header" href="#one-step-target-class-method-whitebox">One-step target class method (whitebox)</a></h3>
<p><img src="Untitled%202.png" alt="Untitled" /></p>
<p><img src="Untitled%203.png" alt="Untitled" /></p>
<h3 id="build-a-substitute-model"><a class="header" href="#build-a-substitute-model">Build a substitute model</a></h3>
<blockquote>
<p>Black-box Attack, Papernot et al. AsiaCCS 2017</p>
</blockquote>
<p>based on a small no. of initial queries to the model in production</p>
<h2 id="how-to-defend"><a class="header" href="#how-to-defend">How to defend</a></h2>
<h3 id="adversarial-training"><a class="header" href="#adversarial-training">Adversarial training</a></h3>
<p><img src="Untitled%204.png" alt="Untitled" /></p>
<blockquote>
<p>💡 Metric: “89.4% error rate on adversarial examples” — which is bad</p>
</blockquote>
<p>Note that adversarial training can have a negative impact (lower accuracy on clean samples, compared to models that don;’t go through adversarial training)</p>
<p><img src="Untitled%205.png" alt="Must do fine-tuning together with adversarial training" /></p>
<p>Must do fine-tuning together with adversarial training</p>
<p>Recap: Batch normalisation</p>
<p><img src="Untitled%206.png" alt="Untitled" /></p>
<p><img src="Untitled%207.png" alt="Untitled" /></p>
<p>Use <strong>Disentangled Learning</strong> via an Auxiliary BN. Uses the <strong>AdvProp</strong> algorithm</p>
<p><img src="Untitled%208.png" alt="Motivation for this is that the 2 different samples have different distributions" /></p>
<p>Motivation for this is that the 2 different samples have different distributions</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="automl"><a class="header" href="#automl">AutoML</a></h1>
<ul>
<li>H20-AutoML</li>
<li><a href="https://optuna.org">Optuna</a></li>
<li>Auto-sklearn</li>
<li>TPOT</li>
<li>Microsoft NNI</li>
<li>AutoKeras</li>
<li>Model Search by Google</li>
</ul>
<p>Google’s AutoML Tables:</p>
<ol>
<li>
<p>Feature engineering</p>
</li>
<li>
<p>Architecture search</p>
</li>
<li>
<p>Hyperparameter tuning</p>
</li>
<li>
<p>Model selection</p>
</li>
<li>
<p>Model ensembling</p>
</li>
<li>
<p>Model distillation and export</p>
</li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->

        <script type="text/javascript">
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>

    </body>
</html>
