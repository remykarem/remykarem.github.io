<!DOCTYPE HTML>
<html lang="en" class="frappé" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Recsys - AI/ML/DS book</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="./mdbook-admonish.css">
        <link rel="stylesheet" href="./theme/catppuccin.css">
        <link rel="stylesheet" href="./theme/catppuccin-admonish.css">

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "macchiato" : "frappé";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('frappé')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="preface.html">Preface</a></li><li class="chapter-item expanded "><a href="general-course-history.html">Course history</a></li><li class="chapter-item expanded "><a href="technolgoies-libraries.html">Trending</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Loss functions</li><li class="chapter-item expanded "><a href="loss-functions.html">Loss functions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="loss-functions/mse.html">MSE</a></li><li class="chapter-item expanded "><a href="loss-functions/mae.html">MAE</a></li><li class="chapter-item expanded "><a href="loss-functions/binary-cross-entropy.html">Binary cross entropy</a></li><li class="chapter-item expanded "><a href="loss-functions/categorical-cross-entropy.html">Categorical cross entropy</a></li><li class="chapter-item expanded "><a href="loss-functions/kl-divergence.html">KL divergence</a></li><li class="chapter-item expanded "><a href="loss-functions/mle.html">MLE</a></li><li class="chapter-item expanded "><a href="loss-functions/map.html">MAP</a></li><li class="chapter-item expanded "><a href="loss-functions/mape.html">MAPE</a></li><li class="chapter-item expanded "><a href="loss-functions/huber-loss.html">Huber loss</a></li><li class="chapter-item expanded "><a href="loss-functions/contrastive-loss.html">Contrastive loss</a></li><li class="chapter-item expanded "><a href="loss-functions/triplet-loss.html">Triplet loss</a></li></ol></li><li class="chapter-item expanded "><div>Regularisation</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="loss-functions/label-smoothing.html">Label smoothing</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">Representations</li><li class="chapter-item expanded "><div>Vector</div></li><li class="chapter-item expanded "><div>Set</div></li><li class="chapter-item expanded "><div>String</div></li><li class="chapter-item expanded "><div>Natural language</div></li><li class="chapter-item expanded "><a href="similarity-measures.html">Similarity measures</a></li><li class="chapter-item expanded "><a href="similarity-search.html">Similarity search</a></li><li class="chapter-item expanded "><a href="similar-items.html">Similar items</a></li><li class="chapter-item expanded "><a href="dimensionality-reduction.html">Dimensionality reduction</a></li><li class="chapter-item expanded "><a href="ann.html">ANN</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Models and algorithms</li><li class="chapter-item expanded "><a href="algorithms/association-rule-mining.html">Association rule mining</a></li><li class="chapter-item expanded "><a href="algorithms/decision-tree.html">Decision tree</a></li><li class="chapter-item expanded "><a href="algorithms/dbscan.html">DBSCAN</a></li><li class="chapter-item expanded "><div>Diffusion model</div></li><li class="chapter-item expanded "><a href="algorithms/evolutionary-algorithms.html">Evolutionary algorithms</a></li><li class="chapter-item expanded "><a href="algorithms/frequent-itemsets.html">Frequent itemsets</a></li><li class="chapter-item expanded "><a href="algorithms/gaussian-process.html">Gaussian process</a></li><li class="chapter-item expanded "><a href="algorithms/gmm.html">GMM</a></li><li class="chapter-item expanded "><a href="algorithms/hierarchical-clustering.html">Hierachical clustering</a></li><li class="chapter-item expanded "><div>HMM</div></li><li class="chapter-item expanded "><a href="algorithms/gradient-boosting.html">Gradient boosting</a></li><li class="chapter-item expanded "><a href="algorithms/k-means.html">k-means</a></li><li class="chapter-item expanded "><a href="algorithms/k-nn.html">k-NN</a></li><li class="chapter-item expanded "><div>KDE</div></li><li class="chapter-item expanded "><a href="algorithms/lda.html">LDA</a></li><li class="chapter-item expanded "><a href="algorithms/linear-models.html">Linear models</a></li><li class="chapter-item expanded "><a href="algorithms/logistic-regression.html">Logistic regression</a></li><li class="chapter-item expanded "><a href="algorithms/mean-shift.html">Mean shift</a></li><li class="chapter-item expanded "><a href="algorithms/naive-bayes.html">Naive Bayes</a></li><li class="chapter-item expanded "><div>Neural networks</div></li><li><ol class="section"><li class="chapter-item expanded "><div>MLP</div></li><li class="chapter-item expanded "><a href="algorithms/cnn.html">CNN</a></li><li class="chapter-item expanded "><div>RNN</div></li><li class="chapter-item expanded "><div>LSTM</div></li><li class="chapter-item expanded "><div>Transformer</div></li><li class="chapter-item expanded "><div>GAN</div></li></ol></li><li class="chapter-item expanded "><a href="algorithms/pagerank.html">PageRank</a></li><li class="chapter-item expanded "><a href="algorithms/pca.html">PCA</a></li><li class="chapter-item expanded "><div>PGM</div></li><li class="chapter-item expanded "><a href="algorithms/svm.html">SVM</a></li><li class="chapter-item expanded "><a href="algorithms/t-sne.html">t-SNE</a></li><li class="chapter-item expanded "><div>Tree ensembles</div></li><li class="chapter-item expanded "><a href="algorithms/umap.html">UMAP</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Metrics</li><li class="chapter-item expanded "><a href="general-metrics.html">AUC</a></li><li class="chapter-item expanded "><a href="metrics.html">MRR</a></li><li class="chapter-item expanded "><a href="top-k.html">Top-k</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">'Learning' types</li><li class="chapter-item expanded "><a href="classes-of-learning-problems.html">Classes of learning problems</a></li><li class="chapter-item expanded "><div>Supervision</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="supervised-learning.html">Supervised learning</a></li><li class="chapter-item expanded "><a href="semi-supervised-learning.html">Semi-supervised learning</a></li><li class="chapter-item expanded "><a href="weakly-supervised-learning.html">Weakly-supervised learning</a></li><li class="chapter-item expanded "><a href="self-supervised-learning.html">Self-supervised learning</a></li><li class="chapter-item expanded "><div>Unsupervised learning</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="clustering-algorithms.html">Clustering algorithms</a></li><li class="chapter-item expanded "><div>Dimensionality reduction algorithms</div></li></ol></li></ol></li><li class="chapter-item expanded "><div>n-shot learning</div></li><li class="chapter-item expanded "><div>Deep learning</div></li><li><ol class="section"><li class="chapter-item expanded "><div>Knowledge distillation</div></li><li class="chapter-item expanded "><a href="deep-learning/intro-to-dl.html">Intro to DL</a></li><li class="chapter-item expanded "><a href="deep-learning/tensor-libraries.html">Tensor libraries</a></li><li class="chapter-item expanded "><a href="deep-learning/sparse-matrices.html">Sparse matrices</a></li><li class="chapter-item expanded "><a href="deep-learning/transfer-learning.html">Transfer learning</a></li><li class="chapter-item expanded "><a href="deep-learning/weight-initialisation.html">Weight initialisation</a></li><li class="chapter-item expanded "><a href="deep-learning/bonus-questions.html">Bonus questions</a></li><li class="chapter-item expanded "><a href="deep-learning/frameworks.html">Frameworks</a></li><li class="chapter-item expanded "><a href="deep-learning/improving-predictive-power.html">Improving predictive power</a></li><li class="chapter-item expanded "><a href="deep-learning/optimisers.html">SGD optimisers</a></li><li class="chapter-item expanded "><a href="deep-learning/limitations-and-new-frontiers.html">Limitations and new frontiers</a></li><li class="chapter-item expanded "><a href="deep-learning/learning-rate-scheduler.html">Learning rate scheduler</a></li><li class="chapter-item expanded "><a href="deep-learning/backpropagation-softmax-and-categorical-cross.html">Backpropagation softmax and categorical cross</a></li><li class="chapter-item expanded "><a href="deep-learning/hyperparameter-search.html">hyperparameter-search</a></li><li class="chapter-item expanded "><a href="deep-learning/layers.html">layers</a></li><li class="chapter-item expanded "><a href="deep-learning/improving-speed-accuracy.html">improving-speed-accuracy</a></li><li class="chapter-item expanded "><a href="deep-learning/activation-functions.html">Activation functions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="deep-learning/approximating-softmax.html">Approximating softmax</a></li></ol></li></ol></li><li class="chapter-item expanded "><div>Machine learning</div></li><li class="chapter-item expanded "><a href="reinforcement-learning.html">Reinforcement learning</a></li><li class="chapter-item expanded "><div>Bayesian learning</div></li><li class="chapter-item expanded "><a href="metric-learning.html">Metric learning</a></li><li class="chapter-item expanded "><a href="learning-to-rank.html">Learning to rank</a></li><li class="chapter-item expanded "><a href="generative-ai/index.html">Generative AI</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="generative-ai/autoencoder.html">Autoencoder</a></li><li class="chapter-item expanded "><a href="generative-ai/vae.html">VAE</a></li><li class="chapter-item expanded "><a href="generative-ai/gan.html">GAN</a></li><li class="chapter-item expanded "><div>Diffusion model</div></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">Domain: General</li><li class="chapter-item expanded "><a href="general/eda.html">EDA</a></li><li class="chapter-item expanded "><a href="hyperparameter-optimisation.html">Hyperparameter optimisation</a></li><li class="chapter-item expanded "><a href="feature-transformation.html">Feature transformation</a></li><li class="chapter-item expanded "><a href="stream-processing.html">Stream processing</a></li><li class="chapter-item expanded "><a href="feature-selection.html">Feature selection</a></li><li class="chapter-item expanded "><a href="feature-engineering.html">Feature engineering</a></li><li class="chapter-item expanded "><a href="train-test-split.html">Train-test split</a></li><li class="chapter-item expanded "><a href="cross-validation.html">Cross validation</a></li><li class="chapter-item expanded "><a href="ensembling.html">Ensembling</a></li><li class="chapter-item expanded "><a href="eda-plus-plus.html">EDA++</a></li><li class="chapter-item expanded "><a href="tests.html">Tests</a></li><li class="chapter-item expanded "><a href="general/bonus-questions.html">Bonus questions</a></li><li class="chapter-item expanded "><a href="bias-variance-decomposition.html">Bias-variance decomposition</a></li><li class="chapter-item expanded "><a href="blas.html">BLAS</a></li><li class="chapter-item expanded "><a href="coursera.html">Coursera</a></li><li class="chapter-item expanded "><a href="improve-generalisation.html">Improve generalisation</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="anomaly-detection.html">Anomaly detection</a></li><li class="chapter-item expanded "><a href="recsys.html" class="active">Recsys</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="recsys-ii.html">Recsys II</a></li><li class="chapter-item expanded "><a href="recsys-youtube.html">YouTube</a></li></ol></li><li class="chapter-item expanded "><a href="survival-analysis.html">Survival analysis</a></li><li class="chapter-item expanded "><div>Market basket analysis</div></li><li class="chapter-item expanded "><div>Time series analysis</div></li><li class="chapter-item expanded "><a href="rare-event-classification.html">Rare event classification / anomaly detection</a></li><li class="chapter-item expanded "><a href="information-retrieval.html">Information retrieval</a></li><li class="chapter-item expanded "><a href="retrieval-augmented-generation.html">Retrieval augmented generation</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Domain: Vision</li><li class="chapter-item expanded "><a href="vision/eda.html">EDA</a></li><li class="chapter-item expanded "><a href="vision/image-processing.html">Image processing</a></li><li class="chapter-item expanded "><a href="vision/image-frameworks.html">Image frameworks</a></li><li class="chapter-item expanded "><a href="vision/techniques.html">Techniques</a></li><li class="chapter-item expanded "><a href="vision/regularisation.html">Regularisation</a></li><li class="chapter-item expanded "><a href="vision/basic-cnn-architectures.html">Basic CNN architectures</a></li><li class="chapter-item expanded "><a href="vision/pretraining-tasks.html">Pretraining tasks</a></li><li class="chapter-item expanded "><a href="vision/models.html">Models</a></li><li class="chapter-item expanded "><a href="vision/trending.html">Trending</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="vision/image-classification.html">Image classification</a></li><li class="chapter-item expanded "><a href="vision/object-detection.html">Object detection</a></li><li class="chapter-item expanded "><a href="vision/instance-segmentation.html">Semantic segmentation</a></li><li class="chapter-item expanded "><a href="vision/reidentification.html">Reidentification</a></li><li class="chapter-item expanded "><a href="vision/autoaugment.html">AutoAugment</a></li><li class="chapter-item expanded "><a href="vision/style-transfer.html">Style transfer</a></li><li class="chapter-item expanded "><a href="vision/obj-inst-seg.html">Obj det / instance seg</a></li><li class="chapter-item expanded "><a href="vision/ocr.html">OCR</a></li><li class="chapter-item expanded "><a href="vision/ui.html">UI</a></li><li class="chapter-item expanded "><a href="vision/others.html">Others</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Domain: Language</li><li class="chapter-item expanded "><a href="language/language.html">Intro</a></li><li class="chapter-item expanded "><a href="language/processing.html">Processing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="language/tokenisation.html">Tokenisation</a></li></ol></li><li class="chapter-item expanded "><a href="language/representation.html">Representation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="language/sparse-representations.html">Sparse representations</a></li><li class="chapter-item expanded "><a href="language/dense-representations.html">Dense representations</a></li><li class="chapter-item expanded "><a href="language/positional-encoding.html">Positional encoding</a></li></ol></li><li class="chapter-item expanded "><a href="language/language-models.html">Language models</a></li><li class="chapter-item expanded "><a href="language/pretraining.html">Pretraining tasks</a></li><li class="chapter-item expanded "><a href="language/fine-tuning.html">Fine-tuning</a></li><li class="chapter-item expanded "><a href="language/models.html">Models</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="language/prompting.html">Prompting</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="language/language-modelling.html">Language modelling</a></li><li class="chapter-item expanded "><a href="language/topic-modelling.html">Topic modelling</a></li><li class="chapter-item expanded "><a href="language/sequence-modelling.html">Sequence modelling</a></li><li class="chapter-item expanded "><a href="language/ner.html">NER</a></li><li class="chapter-item expanded "><a href="language/sentiment-analysis.html">Sentiment analysis</a></li><li class="chapter-item expanded "><a href="language/qa.html">QA</a></li><li class="chapter-item expanded "><a href="language/summarisation.html">Summarisation</a></li><li class="chapter-item expanded "><a href="language/machine-translation.html">Machine translation</a></li><li class="chapter-item expanded "><a href="language/coreference.html">Coreference</a></li><li class="chapter-item expanded "><a href="language/reading-comprehension.html">Reading comprehension</a></li><li class="chapter-item expanded "><a href="language/paraphrase.html">Paraphrase</a></li><li class="chapter-item expanded "><a href="language/commonsense.html">Commonsense</a></li><li class="chapter-item expanded "><a href="language/nli.html">NLI</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Domain: Speech</li><li class="chapter-item expanded "><a href="digital-signal-processing.html">Digital signal processing</a></li><li class="chapter-item expanded "><a href="speech/models.html">Models</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Domain: Graph</li><li class="chapter-item expanded "><a href="graph-analysis.html">Graph analysis</a></li><li class="chapter-item expanded "><a href="graph/models.html">Models</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Domain: Multimodal</li><li class="chapter-item expanded "><a href="multimodal/pretraining.html">Pretraining tasks</a></li><li class="chapter-item expanded "><a href="multimodal/models.html">Models</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Domain: AI planning</li><li class="chapter-item expanded "><div>AI planning</div></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">System design</li><li class="chapter-item expanded "><a href="ml-system-design.html">ML system design</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Others</li><li class="chapter-item expanded "><a href="concept-drift.html">Concept drift</a></li><li class="chapter-item expanded "><a href="interpretable-ai.html">Interpretable AI</a></li><li class="chapter-item expanded "><a href="adversarial-ai.html">Adversarial AI</a></li><li class="chapter-item expanded "><a href="automl.html">AutoML</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="latte">Latte</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="frappe">Frappé</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="macchiato">Macchiato</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mocha">Mocha</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">AI/ML/DS book</h1>

                    <div class="right-buttons">
                        <a href="https://github.com/remykarem/remykarem.github.io/edit/main/books-src/ai-book/src/recsys.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="recsys"><a class="header" href="#recsys">Recsys</a></h1>
<p>Recommender system, recommendation system</p>
<!-- toc -->
<hr />
<p>Goal of recsys:</p>
<ul>
<li>Provide 'relevant' recommendations to users</li>
<li>Balance between diversity, novelty and familiarity</li>
</ul>
<p><img src="./recsys-1.png" alt="Spectrum" /></p>
<p><strong>Motivation</strong></p>
<p>Having a recommendation system helps users find things they wouldn’t have to look for on their own.</p>
<h1 id="libraries"><a class="header" href="#libraries">Libraries</a></h1>
<p><a href="https://github.com/facebookresearch/dlrm">DLRM</a></p>
<p><a href="https://github.com/NicolasHug/Surprise">Surprise</a></p>
<p><a href="https://github.com/microsoft/recommenders">Microsoft Recommenders</a></p>
<p>Implicit</p>
<p>DeepFM</p>
<p>LightFM - hybrid recommendation algorithm (3000)</p>
<p><a href="https://github.com/wubinzzu/NeuRec">NeuRec</a></p>
<h1 id="resources"><a class="header" href="#resources">Resources</a></h1>
<p><a href="https://developers.google.com/machine-learning/recommendation">Google’s recommendation system course</a></p>
<p><a href="https://blog.fastforwardlabs.com/2018/04/10/pytorch-for-recommenders-101.html">https://blog.fastforwardlabs.com/2018/04/10/pytorch-for-recommenders-101.html</a> (Collaborative filtering using supervised learning and DNN)</p>
<p><a href="https://www.ethanrosenthal.com/2017/06/20/matrix-factorization-in-pytorch/">https://www.ethanrosenthal.com/2017/06/20/matrix-factorization-in-pytorch/</a></p>
<p><a href="https://blog.fennel.ai/p/real-world-recommendation-system?s=r">https://blog.fennel.ai/p/real-world-recommendation-system?s=r</a></p>
<h1 id="terminology"><a class="header" href="#terminology"><strong>Terminology</strong></a></h1>
<p>“Dense features” - watch time, time since last watch, …</p>
<p>“Sparse features” - watch history, country, …</p>
<p>“Side features” - user metadata, …</p>
<p>“Factors” - embedding size</p>
<h1 id="data"><a class="header" href="#data">Data</a></h1>
<h2 id="types-of-interaction--feedback"><a class="header" href="#types-of-interaction--feedback">Types of interaction / feedback</a></h2>
<h3 id="implicit-feedback"><a class="header" href="#implicit-feedback">Implicit feedback</a></h3>
<ul>
<li>Click</li>
<li>Purchase</li>
<li>Follow</li>
<li>Duration of consumption</li>
</ul>
<p>indirectly reflect opinion by observing user behaviour including purchase history, browsing history (ALS is good).</p>
<p>Classification problem.</p>
<ul>
<li>How recent?</li>
<li>Downloaded or not?</li>
<li>Synopsis / reviews of books?</li>
</ul>
<h3 id="explicit-feedback"><a class="header" href="#explicit-feedback">Explicit feedback</a></h3>
<ul>
<li>Rating (star ratings eg. GoodReads, MovieLens, Amazon)</li>
<li>Review</li>
<li>Vote</li>
<li>Continuous scale</li>
<li>Pairwise preference (if you like one product X over another product Y)</li>
<li>Temporary (eg. Pandora 30-day suspend)</li>
</ul>
<p>(aka ratings) explicit input by users regarding their interest in product.</p>
<p>Regression problem.</p>
<ul>
<li>During or immediately after consumption</li>
<li>Some time after the experience</li>
</ul>
<p>Difficulties with ratings</p>
<ul>
<li>Ratings might not be reliable because users might not express their preference well on the scale. If you asked someone to re-rate, their rating will change.</li>
<li>Ever-changing users (helping to borrow book for another person).</li>
<li>User preference can change.</li>
<li>What does a rating mean?</li>
</ul>
<h2 id="train-test-split"><a class="header" href="#train-test-split"><strong>Train-test split</strong></a></h2>
<ul>
<li>Mask out some parts of entries in the feedback matrix</li>
<li>Leave-one-out
Hold out the most recent transaction of each user</li>
<li>Time series split:
Split the whole dataset according to time sequence, and hold out the newer transactions based. On a cut-off date</li>
<li>Split by user:
Hold our certain user’s transaction data</li>
<li>Sliding window</li>
</ul>
<h1 id="methods"><a class="header" href="#methods">Methods</a></h1>
<h2 id="content-based-filtering"><a class="header" href="#content-based-filtering">Content-based filtering</a></h2>
<p>My own alias: &quot;feature-based filtering&quot;</p>
<p>When recommending for a user, one can:</p>
<ul>
<li>compute the similarity between a user embedding and all other item embeddings</li>
<li>compute the similarity between an item embedding and all other item embeddings. These items can come from a user's history.</li>
</ul>
<p>and return the closest items.</p>
<h2 id="collaborative-filtering"><a class="header" href="#collaborative-filtering">Collaborative <strong>filtering</strong></a></h2>
<p>interaction-only filtering</p>
<p>My own alias: &quot;interaction-based filtering&quot;</p>
<p>Types:</p>
<ul>
<li>Neighbourhood-based methods (similarity based)
<ul>
<li>Item-based, user-based</li>
</ul>
</li>
<li>Latent factor models
<ul>
<li>Matrix factorisation</li>
<li>Supervised learning</li>
</ul>
</li>
</ul>
<p>Collaborative filtering uses similarities/interactions/feedback signals between users and items simultaneously to provide recommendations (in a more supervised manner). This requires</p>
<ul>
<li>Feedback signals (labels) that indicate if a user has interacted with an item.</li>
</ul>
<p>Collaborative here refers to interaction between user and item.</p>
<p><img src="./recsys-2.png" alt="Feedback matrix" /></p>
<p>During retrieval, an embedding of a user or item is obtained, which is then used to find similar users or items.</p>
<h2 id="matrix-factorisation"><a class="header" href="#matrix-factorisation"><strong>Matrix factorisation</strong></a></h2>
<p><img src="./recsys-3.png" alt="Matrix factorisation" /></p>
<p>MSE = rating - predicted rating,           where predictedrating = global avg + item bias + user-item interaction</p>
<p>Objective functions: MSE, Frobenius distance</p>
<p>Optimisers: ****SVD, PCA, NMF, SGD, ALS (alternating least squares)</p>
<p>Cons: Cold-start problem - during retrieval, a new item does not have an assigned embedding.</p>
<p>During retrieval, user embedding can be looked up from user embedding matrix.</p>
<p>..............</p>
<p><a href="https://developers.google.com/machine-learning/recommendation/collaborative/matrix">https://developers.google.com/machine-learning/recommendation/collaborative/matrix</a></p>
<p>Matrix factorisation is an embedding model where it learns <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span> such that the </p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8913em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span></p>
<p><img src="./recsys-4.png" alt="Matrix factorisation" /></p>
<p><strong>Objectives</strong></p>
<p>There are several objective functions (to be minimised) to choose from:</p>
<ul>
<li>
<p>Frobenius norm</p>
<p>For the first entry in the matrix, take the squared difference between true and predicted. Repeat the same for all other entries. Finally sum all these squared differences. Treat unobserved as zeros.</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4638em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1502em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
</li>
<li>
<p>Observed-only MF</p>
<p>Only consider observed values.</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4638em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">(observed)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.4578em;vertical-align:-0.413em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">(observed)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><img src="./recsys-5.png" alt="Observed only MF" /></p>
</li>
<li>
<p>Weighted MF</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.6em;vertical-align:-0.55em;"></span><span class="mop op-symbol large-op" style="position:relative;top:0em;">∑</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">(observed)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">(observed)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">(unobserved)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>Sometimes you also need to weight the observed pairs:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.6em;vertical-align:-0.55em;"></span><span class="mop op-symbol large-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">(observed)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">(observed)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">(observed)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">(unobserved)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">(unobserved)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><img src="./recsys-6.png" alt="Weighted MF" /></p>
</li>
</ul>
<p><strong>Optimisers</strong> </p>
<ul>
<li>
<p>SGD</p>
<ol>
<li>Initialise embeddings to <span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.2514em;vertical-align:-0.93em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord mathnormal">ni</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.1833em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9267em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span><span style="top:-2.8867em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702 c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14 c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54 c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10 s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429 c69,-144,104.5,-217.7,106.5,-221 l0 -0 c5.3,-9.3,12,-14,20,-14 H400000v40H845.2724 s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7 c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1133em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span> where K is no. of features</li>
</ol>
</li>
<li>
<p>Weighted ALS</p>
<ol>
<li>Initialise embeddings randomly.</li>
<li>Alternate between (i) fixing <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span> and solving <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span>, and (ii) fixing <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span> and solving <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span>. Each stage can be solved exactly via OLS. </li>
</ol>
<blockquote>
<p>⚠️ Only for objective functions that are squared loss.</p>
</blockquote>
</li>
<li>
<p>SVD</p>
<p>Not good if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> is very sparse. (Why?)</p>
</li>
<li>
<p>Coordinate descent</p>
</li>
<li>
<p>Conjugate gradient</p>
</li>
</ul>
<p>Embeddings (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span>) are initialised randomly.</p>
<h3 id="item-based-collaborative-filtering"><a class="header" href="#item-based-collaborative-filtering">Item-based collaborative filtering</a></h3>
<ol>
<li>
<p>Create interaction matrix</p>
<p><img src="./recsys-7.png" alt="Interaction matrix" /></p>
</li>
<li>
<p>Create item-item similarity based on interaction matrix.</p>
<p><img src="./recsys-8.png" alt="Item-item similarity" /></p>
</li>
<li>
<p>Recommend:</p>
<ul>
<li>Customer B: Item 3</li>
<li>Customer C: Item 4, Item 2. Item 5 is similar to Item 4 (similarity value: 0.82). Item 2 is similar to Item 3 (similarity value: 0.45).</li>
</ul>
</li>
</ol>
<h3 id="neighbourhood-methods-based-on-feedback-matrix"><a class="header" href="#neighbourhood-methods-based-on-feedback-matrix"><strong>Neighbourhood methods based on feedback matrix</strong></a></h3>
<p>Get k most similar users to the user, recommend new items.</p>
<h3 id="supervised-learning"><a class="header" href="#supervised-learning"><strong>Supervised learning</strong></a></h3>
<p>Neural collaborative filtering</p>
<p><img src="./recsys-9.png" alt="Neural collaborative filtering" /></p>
<h2 id="hybrid"><a class="header" href="#hybrid">Hybrid</a></h2>
<p>&quot;feature-and-interaction filtering&quot;</p>
<p>Combination of content-based and collaborative filtering</p>
<p>Uses both</p>
<ol>
<li>Features of
<ul>
<li>Users</li>
<li>Items</li>
</ul>
</li>
<li>Interactions between users and items</li>
</ol>
<h3 id="supervised-learning-1"><a class="header" href="#supervised-learning-1">S<strong>upervised learning</strong></a></h3>
<p>Can be framed as binary classification or multiclass classification.</p>
<p><img src="./recsys-10.png" alt="Recsys supervised learning" /></p>
<p>During retrieval, ???</p>
<h3 id="ltr"><a class="header" href="#ltr"><strong>LTR</strong></a></h3>
<p>LTR trains a model to directly predict the probability of a certain item ranking over another item.</p>
<h3 id="factorisation-machine"><a class="header" href="#factorisation-machine"><strong>Factorisation machine</strong></a></h3>
<p>A generalisation of matrix factorisation that allows use of item and user metadata, and feedback signals. It models the interaction between user and item with higher-order dimensions. This is in contrast to Matrix Factorisation, where interaction is modelled as dot-product.</p>
<p><img src="./recsys-11.png" alt="Factorisation machine" /></p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3.2316em;vertical-align:-1.4032em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4032em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3.2588em;vertical-align:-1.4304em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4032em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4304em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="retrieval"><a class="header" href="#retrieval"><strong>Retrieval</strong></a></h2>
<p>One can think of the embedding space as an abstract representation common to both users and items, in which we can measure the notion of closeness or relevance using similarity metric.</p>
<ul>
<li>Cosine</li>
<li>Euclidean</li>
<li>Dot product</li>
</ul>
<p>At inference time,</p>
<ol>
<li>Look up embedding of input
<ul>
<li>If input is a user/query, look up its embedding.</li>
<li>If input is an item, look up its embedding.</li>
</ul>
</li>
<li>Select top k nearest neighbours. One may consider using approximate nearest neighbours for large corpora.</li>
</ol>
<h1 id="metrics"><a class="header" href="#metrics"><strong>Metrics</strong></a></h1>
<p>Accuracy: How similar are the recommendations compared to previous interactions?</p>
<p>Diversity: How dissimilar are the recommendations?</p>
<p>Coverage: What % of the user-item space are recommended?</p>
<p>Serendipity: How surprising are the relevant recommendations?</p>
<p>Novelty: How surprising are the recommendations in general?</p>
<p>Relevancy: How relevant are the recommendations?</p>
<h1 id="tricks"><a class="header" href="#tricks">Tricks</a></h1>
<ul>
<li>2-stage:
<ul>
<li>Stage 1: Candidate generation</li>
<li>Stage 2: Ranking</li>
</ul>
</li>
</ul>
<p><img src="./recsys-12.png" alt="2-stage recsys" /></p>
<ul>
<li>
<p>Banding</p>
<p>The top predictions are what the user has already read. But we don't want that. Instead it is customary to use the 70% percentile onwards.</p>
</li>
</ul>
<h1 id="case-studies"><a class="header" href="#case-studies">Case studies</a></h1>
<ul>
<li><a href="https://research.google/pubs/pub45530/">YouTube</a></li>
<li><a href="https://instagram-engineering.com/powered-by-ai-instagrams-explore-recommender-system-7ca901d2a882">Instagram Explore</a></li>
<li><a href="https://medium.com/airbnb-engineering/machine-learning-powered-search-ranking-of-airbnb-experiences-110b4b1a0789">Airbnb Experiences</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="anomaly-detection.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="recsys-ii.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="anomaly-detection.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="recsys-ii.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="mermaid.min.js"></script>
        <script src="mermaid-init.js"></script>


    </div>
    </body>
</html>