<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Recsys - AI/ML/DS book</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="last-changed.css">

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="preface.html">Preface</a></li><li class="chapter-item expanded affix "><li class="part-title">General</li><li class="chapter-item expanded "><a href="general/eda.html"><strong aria-hidden="true">1.</strong> EDA</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.</strong> Tasks</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="anomaly-detection.html"><strong aria-hidden="true">2.1.</strong> Anomaly detection</a></li><li class="chapter-item expanded "><a href="recsys.html" class="active"><strong aria-hidden="true">2.2.</strong> Recsys</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="recsys-ii.html"><strong aria-hidden="true">2.2.1.</strong> Recsys II</a></li><li class="chapter-item expanded "><a href="recsys-youtube.html"><strong aria-hidden="true">2.2.2.</strong> YouTube</a></li></ol></li><li class="chapter-item expanded "><a href="survival-analysis.html"><strong aria-hidden="true">2.3.</strong> Survival analysis</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.4.</strong> Market basket analysis</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.5.</strong> Time series analysis</div></li></ol></li><li class="chapter-item expanded "><a href="stream-processing.html"><strong aria-hidden="true">3.</strong> Stream processing</a></li><li class="chapter-item expanded "><a href="hyperparameter-optimisation.html"><strong aria-hidden="true">4.</strong> Hyperparameter optimisation</a></li><li class="chapter-item expanded "><a href="feature-transformation.html"><strong aria-hidden="true">5.</strong> Feature transformation</a></li><li class="chapter-item expanded "><a href="feature-selection.html"><strong aria-hidden="true">6.</strong> Feature selection</a></li><li class="chapter-item expanded "><a href="feature-engineering.html"><strong aria-hidden="true">7.</strong> Feature engineering</a></li><li class="chapter-item expanded "><a href="train-test-split.html"><strong aria-hidden="true">8.</strong> Train-test split</a></li><li class="chapter-item expanded "><a href="cross-validation.html"><strong aria-hidden="true">9.</strong> Cross validation</a></li><li class="chapter-item expanded "><a href="ensembling.html"><strong aria-hidden="true">10.</strong> Ensembling</a></li><li class="chapter-item expanded "><a href="eda-plus-plus.html"><strong aria-hidden="true">11.</strong> EDA++</a></li><li class="chapter-item expanded "><a href="tests.html"><strong aria-hidden="true">12.</strong> Tests</a></li><li class="chapter-item expanded "><a href="ml-system-design.html"><strong aria-hidden="true">13.</strong> ML system design</a></li><li class="chapter-item expanded "><a href="general-metrics.html"><strong aria-hidden="true">14.</strong> Metrics</a></li><li class="chapter-item expanded "><a href="general/bonus-questions.html"><strong aria-hidden="true">15.</strong> Bonus questions</a></li><li class="chapter-item expanded "><a href="bias-variance-decomposition.html"><strong aria-hidden="true">16.</strong> Bias-variance decomposition</a></li><li class="chapter-item expanded "><a href="rare-event-classification.html"><strong aria-hidden="true">17.</strong> Rare event classification / anomaly detection</a></li><li class="chapter-item expanded "><a href="blas.html"><strong aria-hidden="true">18.</strong> BLAS</a></li><li class="chapter-item expanded "><a href="coursera.html"><strong aria-hidden="true">19.</strong> Coursera</a></li><li class="chapter-item expanded "><a href="improve-generalisation.html"><strong aria-hidden="true">20.</strong> Improve generalisation</a></li><li class="chapter-item expanded "><a href="general-course-history.html"><strong aria-hidden="true">21.</strong> Course history</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Domain: Vision</li><li class="chapter-item expanded "><a href="vision/eda.html"><strong aria-hidden="true">22.</strong> EDA</a></li><li class="chapter-item expanded "><a href="image-processing.html"><strong aria-hidden="true">23.</strong> Image processing</a></li><li class="chapter-item expanded "><a href="image-frameworks.html"><strong aria-hidden="true">24.</strong> Image frameworks</a></li><li class="chapter-item expanded "><a href="techniques.html"><strong aria-hidden="true">25.</strong> Techniques</a></li><li class="chapter-item expanded "><a href="vision/regularisation.html"><strong aria-hidden="true">26.</strong> Regularisation</a></li><li class="chapter-item expanded "><a href="basic-cnn-architectures.html"><strong aria-hidden="true">27.</strong> Basic CNN architectures</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">28.</strong> Tasks</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="image-classification.html"><strong aria-hidden="true">28.1.</strong> Image classification</a></li><li class="chapter-item expanded "><a href="object-detection.html"><strong aria-hidden="true">28.2.</strong> Object detection</a></li><li class="chapter-item expanded "><a href="instance-segmentation.html"><strong aria-hidden="true">28.3.</strong> Semantic segmentation</a></li><li class="chapter-item expanded "><a href="reidentification.html"><strong aria-hidden="true">28.4.</strong> Reidentification</a></li><li class="chapter-item expanded "><a href="autoaugment.html"><strong aria-hidden="true">28.5.</strong> AutoAugment</a></li><li class="chapter-item expanded "><a href="style-transfer.html"><strong aria-hidden="true">28.6.</strong> Style transfer</a></li><li class="chapter-item expanded "><a href="obj-inst-seg.html"><strong aria-hidden="true">28.7.</strong> Obj det / instance seg</a></li><li class="chapter-item expanded "><a href="ocr.html"><strong aria-hidden="true">28.8.</strong> OCR</a></li><li class="chapter-item expanded "><a href="ui.html"><strong aria-hidden="true">28.9.</strong> UI</a></li><li class="chapter-item expanded "><a href="vision/others.html"><strong aria-hidden="true">28.10.</strong> Others</a></li></ol></li><li class="chapter-item expanded "><a href="computer-vision/pretraining-tasks.html"><strong aria-hidden="true">29.</strong> Pretraining tasks</a></li><li class="chapter-item expanded "><a href="computer-vision/models.html"><strong aria-hidden="true">30.</strong> Models</a></li><li class="chapter-item expanded "><a href="prompt-engineering.html"><strong aria-hidden="true">31.</strong> Prompt engineering</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Domain: Language</li><li class="chapter-item expanded "><a href="language.html"><strong aria-hidden="true">32.</strong> Intro</a></li><li class="chapter-item expanded "><a href="processing.html"><strong aria-hidden="true">33.</strong> Processing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="tokenisation.html"><strong aria-hidden="true">33.1.</strong> Tokenisation</a></li><li class="chapter-item expanded "><a href="embeddings.html"><strong aria-hidden="true">33.2.</strong> Embeddings</a></li><li class="chapter-item expanded "><a href="encoding.html"><strong aria-hidden="true">33.3.</strong> Encoding</a></li><li class="chapter-item expanded "><a href="representation.html"><strong aria-hidden="true">33.4.</strong> Representation</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">34.</strong> Tasks</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="language-modelling.html"><strong aria-hidden="true">34.1.</strong> Language modelling</a></li><li class="chapter-item expanded "><a href="topic-modelling.html"><strong aria-hidden="true">34.2.</strong> Topic modelling</a></li><li class="chapter-item expanded "><a href="sequence-modelling.html"><strong aria-hidden="true">34.3.</strong> Sequence modelling</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">35.</strong> Tasks</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="ner.html"><strong aria-hidden="true">35.1.</strong> NER</a></li><li class="chapter-item expanded "><a href="sentiment-analysis.html"><strong aria-hidden="true">35.2.</strong> Sentiment analysis</a></li><li class="chapter-item expanded "><a href="qa.html"><strong aria-hidden="true">35.3.</strong> QA</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">35.4.</strong> Common sense reasoning</div></li><li class="chapter-item expanded "><a href="summarisation.html"><strong aria-hidden="true">35.5.</strong> Summarisation</a></li><li class="chapter-item expanded "><a href="machine-translation.html"><strong aria-hidden="true">35.6.</strong> Machine translation</a></li></ol></li><li class="chapter-item expanded "><a href="pretraining.html"><strong aria-hidden="true">36.</strong> Pretraining tasks</a></li><li class="chapter-item expanded "><a href="language-models.html"><strong aria-hidden="true">37.</strong> Language models</a></li><li class="chapter-item expanded "><a href="nlp/models.html"><strong aria-hidden="true">38.</strong> Models</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Domain: Speech</li><li class="chapter-item expanded "><a href="digital-signal-processing.html"><strong aria-hidden="true">39.</strong> Digital signal processing</a></li><li class="chapter-item expanded "><a href="speech/models.html"><strong aria-hidden="true">40.</strong> Models</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Domain: Graph</li><li class="chapter-item expanded "><a href="graph-analysis.html"><strong aria-hidden="true">41.</strong> Graph analysis</a></li><li class="chapter-item expanded "><a href="graph/models.html"><strong aria-hidden="true">42.</strong> Models</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Domain: Multimodal</li><li class="chapter-item expanded "><a href="multimodal/pretraining.html"><strong aria-hidden="true">43.</strong> Pretraining tasks</a></li><li class="chapter-item expanded "><a href="multimodal/models.html"><strong aria-hidden="true">44.</strong> Models</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Domain: AI planning</li><li class="chapter-item expanded "><div><strong aria-hidden="true">45.</strong> AI planning</div></li><li class="spacer"></li><li class="chapter-item expanded "><a href="loss-functions.html"><strong aria-hidden="true">46.</strong> Loss functions</a></li><li class="chapter-item expanded "><a href="metrics.html"><strong aria-hidden="true">47.</strong> Metrics</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">48.</strong> Hyperparameter optimisation</div></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">'Learning' types</li><li class="chapter-item expanded "><div><strong aria-hidden="true">49.</strong> Supervision</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="supervised-learning.html"><strong aria-hidden="true">49.1.</strong> Supervised learning</a></li><li class="chapter-item expanded "><a href="semi-supervised-learning.html"><strong aria-hidden="true">49.2.</strong> Semi-supervised learning</a></li><li class="chapter-item expanded "><a href="weakly-supervised-learning.html"><strong aria-hidden="true">49.3.</strong> Weakly-supervised learning</a></li><li class="chapter-item expanded "><a href="self-supervised-learning.html"><strong aria-hidden="true">49.4.</strong> Self-supervised learning</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">49.5.</strong> Unsupervised learning</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="clustering-algorithms.html"><strong aria-hidden="true">49.5.1.</strong> Clustering algorithms</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">49.5.2.</strong> Dimensionality reduction algorithms</div></li></ol></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">50.</strong> n-shot learning</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">51.</strong> Deep learning</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">51.1.</strong> Knowledge distillation</div></li><li class="chapter-item expanded "><a href="intro-to-dl.html"><strong aria-hidden="true">51.2.</strong> Intro to DL</a></li><li class="chapter-item expanded "><a href="tensor-libraries.html"><strong aria-hidden="true">51.3.</strong> Tensor libraries</a></li><li class="chapter-item expanded "><a href="sparse-matrices.html"><strong aria-hidden="true">51.4.</strong> Sparse matrices</a></li><li class="chapter-item expanded "><a href="transfer-learning.html"><strong aria-hidden="true">51.5.</strong> Transfer learning</a></li><li class="chapter-item expanded "><a href="weight-initialisation.html"><strong aria-hidden="true">51.6.</strong> Weight initialisation</a></li><li class="chapter-item expanded "><a href="bonus-questions.html"><strong aria-hidden="true">51.7.</strong> Bonus questions</a></li><li class="chapter-item expanded "><a href="frameworks.html"><strong aria-hidden="true">51.8.</strong> Frameworks</a></li><li class="chapter-item expanded "><a href="improving-predictive-power.html"><strong aria-hidden="true">51.9.</strong> Improving predictive power</a></li><li class="chapter-item expanded "><a href="optimisers.html"><strong aria-hidden="true">51.10.</strong> SGD optimisers</a></li><li class="chapter-item expanded "><a href="limitations-and-new-frontiers.html"><strong aria-hidden="true">51.11.</strong> Limitations and new frontiers</a></li><li class="chapter-item expanded "><a href="learning-rate-scheduler.html"><strong aria-hidden="true">51.12.</strong> Learning rate scheduler</a></li><li class="chapter-item expanded "><a href="backpropagation-softmax-and-categorical-cross.html"><strong aria-hidden="true">51.13.</strong> Backpropagation softmax and categorical cross</a></li><li class="chapter-item expanded "><a href="hyperparameter-search.html"><strong aria-hidden="true">51.14.</strong> hyperparameter-search</a></li><li class="chapter-item expanded "><a href="layers.html"><strong aria-hidden="true">51.15.</strong> layers</a></li><li class="chapter-item expanded "><a href="improving-speed-accuracy.html"><strong aria-hidden="true">51.16.</strong> improving-speed-accuracy</a></li><li class="chapter-item expanded "><a href="activation-functions.html"><strong aria-hidden="true">51.17.</strong> Activation functions</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">52.</strong> Machine learning</div></li><li class="chapter-item expanded "><a href="reinforcement-learning.html"><strong aria-hidden="true">53.</strong> Reinforcement learning</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">54.</strong> Bayesian learning</div></li><li class="chapter-item expanded "><a href="metric-learning.html"><strong aria-hidden="true">55.</strong> Metric learning</a></li><li class="chapter-item expanded "><a href="learning-to-rank.html"><strong aria-hidden="true">56.</strong> Learning to rank</a></li><li class="chapter-item expanded "><a href="deep-generative-models.html"><strong aria-hidden="true">57.</strong> Deep generative models</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Models and algorithms</li><li class="chapter-item expanded "><a href="association-rule-mining.html"><strong aria-hidden="true">58.</strong> Association rule mining</a></li><li class="chapter-item expanded "><a href="decision-tree.html"><strong aria-hidden="true">59.</strong> Decision tree</a></li><li class="chapter-item expanded "><a href="dbscan.html"><strong aria-hidden="true">60.</strong> DBSCAN</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">61.</strong> Diffusion model</div></li><li class="chapter-item expanded "><a href="evolutionary-algorithms.html"><strong aria-hidden="true">62.</strong> Evolutionary algorithms</a></li><li class="chapter-item expanded "><a href="frequent-itemsets.html"><strong aria-hidden="true">63.</strong> Frequent itemsets</a></li><li class="chapter-item expanded "><a href="gaussian-process.html"><strong aria-hidden="true">64.</strong> Gaussian process</a></li><li class="chapter-item expanded "><a href="gmm.html"><strong aria-hidden="true">65.</strong> GMM</a></li><li class="chapter-item expanded "><a href="hierarchical-clustering.html"><strong aria-hidden="true">66.</strong> Hierachical clustering</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">67.</strong> HMM</div></li><li class="chapter-item expanded "><a href="gradient-boosting.html"><strong aria-hidden="true">68.</strong> Gradient boosting</a></li><li class="chapter-item expanded "><a href="k-means.html"><strong aria-hidden="true">69.</strong> k-means</a></li><li class="chapter-item expanded "><a href="k-nn.html"><strong aria-hidden="true">70.</strong> k-NN</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">71.</strong> KDE</div></li><li class="chapter-item expanded "><a href="lda.html"><strong aria-hidden="true">72.</strong> LDA</a></li><li class="chapter-item expanded "><a href="linear-models.html"><strong aria-hidden="true">73.</strong> Linear models</a></li><li class="chapter-item expanded "><a href="logistic-regression.html"><strong aria-hidden="true">74.</strong> Logistic regression</a></li><li class="chapter-item expanded "><a href="mean-shift.html"><strong aria-hidden="true">75.</strong> Mean shift</a></li><li class="chapter-item expanded "><a href="naive-bayes.html"><strong aria-hidden="true">76.</strong> Naive Bayes</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">77.</strong> Neural networks</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">77.1.</strong> MLP</div></li><li class="chapter-item expanded "><a href="cnn.html"><strong aria-hidden="true">77.2.</strong> CNN</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">77.3.</strong> RNN</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">77.4.</strong> LSTM</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">77.5.</strong> Transformer</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">77.6.</strong> GAN</div></li></ol></li><li class="chapter-item expanded "><a href="pagerank.html"><strong aria-hidden="true">78.</strong> PageRank</a></li><li class="chapter-item expanded "><a href="pca.html"><strong aria-hidden="true">79.</strong> PCA</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">80.</strong> PGM</div></li><li class="chapter-item expanded "><a href="svm.html"><strong aria-hidden="true">81.</strong> SVM</a></li><li class="chapter-item expanded "><a href="t-sne.html"><strong aria-hidden="true">82.</strong> t-SNE</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">83.</strong> Tree ensembles</div></li><li class="chapter-item expanded "><a href="umap.html"><strong aria-hidden="true">84.</strong> UMAP</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Representations</li><li class="chapter-item expanded "><a href="similarity-measures.html"><strong aria-hidden="true">85.</strong> Similarity measures</a></li><li class="chapter-item expanded "><a href="similarity-search.html"><strong aria-hidden="true">86.</strong> Similarity search</a></li><li class="chapter-item expanded "><a href="similar-items.html"><strong aria-hidden="true">87.</strong> Similar items</a></li><li class="chapter-item expanded "><a href="dimensionality-reduction.html"><strong aria-hidden="true">88.</strong> Dimensionality reduction</a></li><li class="chapter-item expanded "><a href="ann.html"><strong aria-hidden="true">89.</strong> ANN</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">System design</li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Others</li><li class="chapter-item expanded "><a href="concept-drift.html"><strong aria-hidden="true">90.</strong> Concept drift</a></li><li class="chapter-item expanded "><a href="interpretable-ai.html"><strong aria-hidden="true">91.</strong> Interpretable AI</a></li><li class="chapter-item expanded "><a href="adversarial-ai.html"><strong aria-hidden="true">92.</strong> Adversarial AI</a></li><li class="chapter-item expanded "><a href="automl.html"><strong aria-hidden="true">93.</strong> AutoML</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">AI/ML/DS book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/remykarem/remkarem.github.io" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="recsys"><a class="header" href="#recsys">Recsys</a></h1>
<p>Recommender system, recommendation system</p>
<ul>
<li><a href="#libraries">Libraries</a></li>
<li><a href="#resources">Resources</a></li>
<li><a href="#terminology">Terminology</a></li>
<li><a href="#data">Data</a>
<ul>
<li><a href="#types-of-interaction--feedback">Types of interaction / feedback</a>
<ul>
<li><a href="#implicit-feedback">Implicit feedback</a></li>
<li><a href="#explicit-feedback">Explicit feedback</a></li>
</ul>
</li>
<li><a href="#train-test-split">Train-test split</a></li>
</ul>
</li>
<li><a href="#methods">Methods</a>
<ul>
<li><a href="#content-based-filtering">Content-based filtering</a></li>
<li><a href="#collaborative-filtering">Collaborative filtering</a></li>
<li><a href="#matrix-factorisation">Matrix factorisation</a>
<ul>
<li><a href="#item-based-collaborative-filtering">Item-based collaborative filtering</a></li>
<li><a href="#neighbourhood-methods-based-on-feedback-matrix">Neighbourhood methods based on feedback matrix</a></li>
<li><a href="#supervised-learning">Supervised learning</a></li>
</ul>
</li>
<li><a href="#hybrid">Hybrid</a>
<ul>
<li><a href="#supervised-learning-1">Supervised learning</a></li>
<li><a href="#ltr">LTR</a></li>
<li><a href="#factorisation-machine">Factorisation machine</a></li>
</ul>
</li>
<li><a href="#retrieval">Retrieval</a></li>
</ul>
</li>
<li><a href="#metrics">Metrics</a></li>
<li><a href="#tricks">Tricks</a></li>
<li><a href="#case-studies">Case studies</a></li>
</ul>
<hr />
<p>Goal of recsys:</p>
<ul>
<li>Provide 'relevant' recommendations to users</li>
<li>Balance between diversity, novelty and familiarity</li>
</ul>
<p><img src="./recsys-1.png" alt="Spectrum" /></p>
<p><strong>Motivation</strong></p>
<p>Having a recommendation system helps users find things they wouldn’t have to look for on their own.</p>
<h1 id="libraries"><a class="header" href="#libraries">Libraries</a></h1>
<p><a href="https://github.com/facebookresearch/dlrm">DLRM</a></p>
<p><a href="https://github.com/NicolasHug/Surprise">Surprise</a></p>
<p><a href="https://github.com/microsoft/recommenders">Microsoft Recommenders</a></p>
<p>Implicit</p>
<p>DeepFM</p>
<p>LightFM - hybrid recommendation algorithm (3000)</p>
<p><a href="https://github.com/wubinzzu/NeuRec">NeuRec</a></p>
<h1 id="resources"><a class="header" href="#resources">Resources</a></h1>
<p><a href="https://developers.google.com/machine-learning/recommendation">Google’s recommendation system course</a></p>
<p><a href="https://blog.fastforwardlabs.com/2018/04/10/pytorch-for-recommenders-101.html">https://blog.fastforwardlabs.com/2018/04/10/pytorch-for-recommenders-101.html</a> (Collaborative filtering using supervised learning and DNN)</p>
<p><a href="https://www.ethanrosenthal.com/2017/06/20/matrix-factorization-in-pytorch/">https://www.ethanrosenthal.com/2017/06/20/matrix-factorization-in-pytorch/</a></p>
<p><a href="https://blog.fennel.ai/p/real-world-recommendation-system?s=r">https://blog.fennel.ai/p/real-world-recommendation-system?s=r</a></p>
<h1 id="terminology"><a class="header" href="#terminology"><strong>Terminology</strong></a></h1>
<p>“Dense features” - watch time, time since last watch, …</p>
<p>“Sparse features” - watch history, country, …</p>
<p>“Side features” - user metadata, …</p>
<p>“Factors” - embedding size</p>
<h1 id="data"><a class="header" href="#data">Data</a></h1>
<h2 id="types-of-interaction--feedback"><a class="header" href="#types-of-interaction--feedback">Types of interaction / feedback</a></h2>
<h3 id="implicit-feedback"><a class="header" href="#implicit-feedback">Implicit feedback</a></h3>
<ul>
<li>Click</li>
<li>Purchase</li>
<li>Follow</li>
<li>Duration of consumption</li>
</ul>
<p>indirectly reflect opinion by observing user behaviour including purchase history, browsing history (ALS is good).</p>
<p>Classification problem.</p>
<ul>
<li>How recent?</li>
<li>Downloaded or not?</li>
<li>Synopsis / reviews of books?</li>
</ul>
<h3 id="explicit-feedback"><a class="header" href="#explicit-feedback">Explicit feedback</a></h3>
<ul>
<li>Rating (star ratings eg. GoodReads, MovieLens, Amazon)</li>
<li>Review</li>
<li>Vote</li>
<li>Continuous scale</li>
<li>Pairwise preference (if you like one product X over another product Y)</li>
<li>Temporary (eg. Pandora 30-day suspend)</li>
</ul>
<p>(aka ratings) explicit input by users regarding their interest in product.</p>
<p>Regression problem.</p>
<ul>
<li>During or immediately after consumption</li>
<li>Some time after the experience</li>
</ul>
<p>Difficulties with ratings</p>
<ul>
<li>Ratings might not be reliable because users might not express their preference well on the scale. If you asked someone to re-rate, their rating will change.</li>
<li>Ever-changing users (helping to borrow book for another person).</li>
<li>User preference can change.</li>
<li>What does a rating mean?</li>
</ul>
<h2 id="train-test-split"><a class="header" href="#train-test-split"><strong>Train-test split</strong></a></h2>
<ul>
<li>Mask out some parts of entries in the feedback matrix</li>
<li>Leave-one-out
Hold out the most recent transaction of each user</li>
<li>Time series split:
Split the whole dataset according to time sequence, and hold out the newer transactions based. On a cut-off date</li>
<li>Split by user:
Hold our certain user’s transaction data</li>
<li>Sliding window</li>
</ul>
<h1 id="methods"><a class="header" href="#methods">Methods</a></h1>
<h2 id="content-based-filtering"><a class="header" href="#content-based-filtering">Content-based filtering</a></h2>
<p>My own alias: &quot;feature-based filtering&quot;</p>
<p>When recommending for a user, one can:</p>
<ul>
<li>compute the similarity between a user embedding and all other item embeddings</li>
<li>compute the similarity between an item embedding and all other item embeddings. These items can come from a user's history.</li>
</ul>
<p>and return the closest items.</p>
<h2 id="collaborative-filtering"><a class="header" href="#collaborative-filtering">Collaborative <strong>filtering</strong></a></h2>
<p>interaction-only filtering</p>
<p>My own alias: &quot;interaction-based filtering&quot;</p>
<p>Types:</p>
<ul>
<li>Neighbourhood-based methods (similarity based)
<ul>
<li>Item-based, user-based</li>
</ul>
</li>
<li>Latent factor models
<ul>
<li>Matrix factorisation</li>
<li>Supervised learning</li>
</ul>
</li>
</ul>
<p>Collaborative filtering uses similarities/interactions/feedback signals between users and items simultaneously to provide recommendations (in a more supervised manner). This requires</p>
<ul>
<li>Feedback signals (labels) that indicate if a user has interacted with an item.</li>
</ul>
<p>Collaborative here refers to interaction between user and item.</p>
<p><img src="./recsys-2.png" alt="Feedback matrix" /></p>
<p>During retrieval, an embedding of a user or item is obtained, which is then used to find similar users or items.</p>
<h2 id="matrix-factorisation"><a class="header" href="#matrix-factorisation"><strong>Matrix factorisation</strong></a></h2>
<p><img src="./recsys-3.png" alt="Matrix factorisation" /></p>
<p>MSE = rating - predicted rating,           where predictedrating = global avg + item bias + user-item interaction</p>
<p>Objective functions: MSE, Frobenius distance</p>
<p>Optimisers: ****SVD, PCA, NMF, SGD, ALS (alternating least squares)</p>
<p>Cons: Cold-start problem - during retrieval, a new item does not have an assigned embedding.</p>
<p>During retrieval, user embedding can be looked up from user embedding matrix.</p>
<p>..............</p>
<p><a href="https://developers.google.com/machine-learning/recommendation/collaborative/matrix">https://developers.google.com/machine-learning/recommendation/collaborative/matrix</a></p>
<p>Matrix factorisation is an embedding model where it learns $U$ and $V$ such that the </p>
<p>$$
UV^T \approx A
$$</p>
<p><img src="./recsys-4.png" alt="Matrix factorisation" /></p>
<p><strong>Objectives</strong></p>
<p>There are several objective functions (to be minimised) to choose from:</p>
<ul>
<li>
<p>Frobenius norm</p>
<p>For the first entry in the matrix, take the squared difference between true and predicted. Repeat the same for all other entries. Finally sum all these squared differences. Treat unobserved as zeros.</p>
<p>$$
\sum_{i,j}(y_{i,j}-\hat{y}_{i,j})^2
$$</p>
</li>
<li>
<p>Observed-only MF</p>
<p>Only consider observed values.</p>
<p>$$
\sum_{i,j} (y_{i,j}^\text{(observed)}-\hat{y}_{i,j}^\text{(observed)})^2
$$</p>
<p><img src="./recsys-5.png" alt="Observed only MF" /></p>
</li>
<li>
<p>Weighted MF</p>
<p>$$
\sum(y^\text{(observed)}-\hat{y}^\text{(observed)})^2 + w(0-\hat{y}^\text{(unobserved)})^2
$$</p>
<p>Sometimes you also need to weight the observed pairs:</p>
<p>$$
\sum w^\text{(observed)}(y^\text{(observed)}-\hat{y}^\text{(observed)})^2 + w^\text{(unobserved)}(0-\hat{y}^\text{(unobserved)})^2
$$</p>
<p><img src="./recsys-6.png" alt="Weighted MF" /></p>
</li>
</ul>
<p><strong>Optimisers</strong> </p>
<ul>
<li>
<p>SGD</p>
<ol>
<li>Initialise embeddings to $$Uniform(1,\frac{1}{\sqrt{K}})$$ where K is no. of features</li>
</ol>
</li>
<li>
<p>Weighted ALS</p>
<ol>
<li>Initialise embeddings randomly.</li>
<li>Alternate between (i) fixing $U$ and solving $V$, and (ii) fixing $V$ and solving $U$. Each stage can be solved exactly via OLS. </li>
</ol>
<blockquote>
<p>⚠️ Only for objective functions that are squared loss.</p>
</blockquote>
</li>
<li>
<p>SVD</p>
<p>Not good if $A$ is very sparse. (Why?)</p>
</li>
<li>
<p>Coordinate descent</p>
</li>
<li>
<p>Conjugate gradient</p>
</li>
</ul>
<p>Embeddings ($U$ and $V$) are initialised randomly.</p>
<h3 id="item-based-collaborative-filtering"><a class="header" href="#item-based-collaborative-filtering">Item-based collaborative filtering</a></h3>
<ol>
<li>
<p>Create interaction matrix</p>
<p><img src="./recsys-7.png" alt="Interaction matrix" /></p>
</li>
<li>
<p>Create item-item similarity based on interaction matrix.</p>
<p><img src="./recsys-8.png" alt="Item-item similarity" /></p>
</li>
<li>
<p>Recommend:</p>
<ul>
<li>Customer B: Item 3</li>
<li>Customer C: Item 4, Item 2. Item 5 is similar to Item 4 (similarity value: 0.82). Item 2 is similar to Item 3 (similarity value: 0.45).</li>
</ul>
</li>
</ol>
<h3 id="neighbourhood-methods-based-on-feedback-matrix"><a class="header" href="#neighbourhood-methods-based-on-feedback-matrix"><strong>Neighbourhood methods based on feedback matrix</strong></a></h3>
<p>Get k most similar users to the user, recommend new items.</p>
<h3 id="supervised-learning"><a class="header" href="#supervised-learning"><strong>Supervised learning</strong></a></h3>
<p>Neural collaborative filtering</p>
<p><img src="./recsys-9.png" alt="Neural collaborative filtering" /></p>
<h2 id="hybrid"><a class="header" href="#hybrid">Hybrid</a></h2>
<p>&quot;feature-and-interaction filtering&quot;</p>
<p>Combination of content-based and collaborative filtering</p>
<p>Uses both</p>
<ol>
<li>Features of
<ul>
<li>Users</li>
<li>Items</li>
</ul>
</li>
<li>Interactions between users and items</li>
</ol>
<h3 id="supervised-learning-1"><a class="header" href="#supervised-learning-1">S<strong>upervised learning</strong></a></h3>
<p>Can be framed as binary classification or multiclass classification.</p>
<p><img src="./recsys-10.png" alt="Recsys supervised learning" /></p>
<p>During retrieval, ???</p>
<h3 id="ltr"><a class="header" href="#ltr"><strong>LTR</strong></a></h3>
<p>LTR trains a model to directly predict the probability of a certain item ranking over another item.</p>
<h3 id="factorisation-machine"><a class="header" href="#factorisation-machine"><strong>Factorisation machine</strong></a></h3>
<p>A generalisation of matrix factorisation that allows use of item and user metadata, and feedback signals. It models the interaction between user and item with higher-order dimensions. This is in contrast to Matrix Factorisation, where interaction is modelled as dot-product.</p>
<p><img src="./recsys-11.png" alt="Factorisation machine" /></p>
<p>$$
f(x) = w_0 + \sum_{p=1}^P w_p x_p + \sum_{p=1}^{P-1} \sum_{q=P+1}^P w_{p,q} x_p x_q
$$</p>
<h2 id="retrieval"><a class="header" href="#retrieval"><strong>Retrieval</strong></a></h2>
<p>One can think of the embedding space as an abstract representation common to both users and items, in which we can measure the notion of closeness or relevance using similarity metric.</p>
<ul>
<li>Cosine</li>
<li>Euclidean</li>
<li>Dot product</li>
</ul>
<p>At inference time,</p>
<ol>
<li>Look up embedding of input
<ul>
<li>If input is a user/query, look up its embedding.</li>
<li>If input is an item, look up its embedding.</li>
</ul>
</li>
<li>Select top k nearest neighbours. One may consider using approximate nearest neighbours for large corpora.</li>
</ol>
<h1 id="metrics"><a class="header" href="#metrics"><strong>Metrics</strong></a></h1>
<p>Accuracy: How similar are the recommendations compared to previous interactions?</p>
<p>Diversity: How dissimilar are the recommendations?</p>
<p>Coverage: What % of the user-item space are recommended?</p>
<p>Serendipity: How surprising are the relevant recommendations?</p>
<p>Novelty: How surprising are the recommendations in general?</p>
<p>Relevancy: How relevant are the recommendations?</p>
<h1 id="tricks"><a class="header" href="#tricks">Tricks</a></h1>
<ul>
<li>2-stage:
<ul>
<li>Stage 1: Candidate generation</li>
<li>Stage 2: Ranking</li>
</ul>
</li>
</ul>
<p><img src="./recsys-12.png" alt="2-stage recsys" /></p>
<ul>
<li>
<p>Banding</p>
<p>The top predictions are what the user has already read. But we don't want that. Instead it is customary to use the 70% percentile onwards.</p>
</li>
</ul>
<h1 id="case-studies"><a class="header" href="#case-studies">Case studies</a></h1>
<ul>
<li><a href="https://research.google/pubs/pub45530/">YouTube</a></li>
<li><a href="https://instagram-engineering.com/powered-by-ai-instagrams-explore-recommender-system-7ca901d2a882">Instagram Explore</a></li>
<li><a href="https://medium.com/airbnb-engineering/machine-learning-powered-search-ranking-of-airbnb-experiences-110b4b1a0789">Airbnb Experiences</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="anomaly-detection.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="recsys-ii.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="anomaly-detection.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="recsys-ii.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
