<!doctype <!DOCTYPE html>
<html>

<head>
    <title class="remotecomp"></title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <style>
        html {
            font-family: 'Courier New', Courier, monospace;
            background-color: black;
            color: aliceblue;
            padding: 20px;
        }

        .disclaimer {
            font-size: 10px;
        }

        .lastResult {
            padding-left: 4px;
        }
    </style>
</head>

<body>
    <h4 class="intro">You are hacking into Alice's computer.</h4>
    <div class="form">
        <p class="guessesCountdown"></p>
        <label for="guessField">Enter password: </label>
        <input type="text" id="guessField" class="guessField" style="background-color: black; border: black; color: greenyellow; font-family: 'Courier New', Courier, monospace">
        <input type="submit" value="Submit" class="guessSubmit">
    </div>
    <div class="resultParas">
            <p class="guesses"></p>
            <p class="lastResult"></p>
        </div>
    <h4>You have 3 tries to guess his/her password before the computer locks you out.</h4>
    <br>
    <h4>Select an algorithm to break the password:</h4>
    <form>
        <input type="radio" name="algorithm" value="1"> Use same name
        <br>
        <input type="radio" name="algorithm" value="2"> Append !
        <br>
        <input type="radio" name="algorithm" value="3"> Append 123
        <br>
        <input type="radio" name="algorithm" value="4"> Uppercase all letters
        <br>
        <input type="radio" name="algorithm" value="5"> Lowercase all letters
        <br>
        <input type="radio" name="algorithm" value="6"> Replace a with @
        <br>
        <input type="radio" name="algorithm" value="7"> Replace i with !
        <br>
    </form>
    <button onclick="runAlgorithm()">Run algorithm</button>
    <br>

    <p class='disclaimer'>Note that while this game might not be ethical, it is intended for entertainment purposes only. The IP addresses and
        names generated here are all randomly generated and made up.</p>

    <script>
        // Get text input and submit button from the form
        var guessField = document.querySelector('.guessField');
        var guessSubmit = document.querySelector('.guessSubmit');

        // For display
        var remotecomp = document.querySelector('.remotecomp');
        var introduction = document.querySelector('.intro');
        var guessesCountdown = document.querySelector('.guessesCountdown');
        var guesses = document.querySelector('.guesses');
        var lastResult = document.querySelector('.lastResult');

        var guessCount = 1;
        var guessesLeft = 3;
        var guessPrev = 0;
        var fontSize = 16;
        var resetButton;

        // Generate name
        var name = generateName();
        var ipAddress = generateIp();
        console.log(ipAddress);
        introduction.textContent = 'You are now hacking into ' + name + '\'s computer with IP address ' + ipAddress + '.';
        remotecomp.textContent = ipAddress;

        // Generate our random number
        var password = generatePassword(name, 0);
        console.log('Password is ' + password);

        guessesCountdown.textContent = 'Guesses left: ' + guessesLeft;

        function checkGuess() {

            var userGuess = guessField.value;

            if (guessCount === 1) {
                // guesses.textContent = 'Previous guesses: ';
            }
            // guesses.textContent += userGuess + ' ';

            if (userGuess === password) {
                lastResult.textContent = 'Correct! You managed to do it in ' + guessCount + ' guesses.';
                lastResult.style.backgroundColor = 'green';
                lowOrHi.textContent = '';
                guessesCountdown.style.fontSize = "16px";
                setGameOver();
            } else if (guessCount === 3) {
                lastResult.textContent = '!!!Your IP address has been banned!!!';
                setGameOver();
            } else {
                lastResult.textContent = 'Wrong!';
                lastResult.style.backgroundColor = 'red';
            }

            guessCount++;
            guessesLeft--;
            fontSize += 5
            guessesCountdown.style.fontSize = fontSize + 'px';
            guessField.value = '';

            guessesCountdown.textContent = 'Guesses left: ' + guessesLeft;
        }

        // Generate name
        function generateName() {
            const names = ["Alice", "Bob", "Candice", "Derek", "Emily", "Fang", "Gordon",
                "Helmi", "Izzat", "Jing Kai", "Khai", "Muhammad"];
            var rand = Math.floor(Math.random() * names.length);
            return names[rand];
        }

        function generateIp() {
            var address = '';
            for (var i = 0; i < 4; i++) {
                address += Math.floor(Math.random() * 256) + '.';
            }
            return address.slice(0, -1);
        }

        // Generate password based on a name
        function generatePassword(name, algorithm) {
            console.log("Name is " + name);
            name = name.replace(/\s+/g, '');
            var rand = Math.floor(Math.random() * 7) + 1;
            algorithm = parseInt(algorithm);
            algo = (algorithm === 0) ? rand : algorithm;

            if (algo === 1) {
                return name;
            } else if (algo === 2) {
                return name + '!';
            } else if (algo === 3) {
                return name + '123';
            } else if (algo === 4) {
                return name.toUpperCase();
            } else if (algo === 5) {
                return name.toLowerCase();
            } else if (algo === 6) {
                return name.toLowerCase().replace(/a/g, "@");
            } else if (algo === 7) {
                return name.toLowerCase().replace(/i/g, "!");
            }
        }

        function setGameOver() {
            guessField.disabled = true;
            guessSubmit.disabled = true;
            resetButton = document.createElement('button');
            resetButton.textContent = 'Kidding la. Let\'s, play again?';
            document.body.appendChild(resetButton);
            resetButton.addEventListener('click', resetGame);
        }

        function resetGame() {
            guessCount = 1;

            var resetParas = document.querySelectorAll('.resultParas p');
            for (var i = 0; i < resetParas.length; i++) {
                resetParas[i].textContent = '';
            }

            resetButton.parentNode.removeChild(resetButton);

            guessField.disabled = false;
            guessSubmit.disabled = false;
            guessField.value = '';
            guessField.focus();

            lastResult.style.backgroundColor = 'white';

            randomNumber = Math.floor(Math.random() * 1000) + 1;
        }

        function runAlgorithm() {
            var algo = document.querySelector('input[name="algorithm"]:checked').value;
            console.log("Running algorithm " + algo + " for " + name);
            guessField.value = generatePassword(name, algo);
        }
        // // Listens for click
        guessSubmit.addEventListener('click', checkGuess);
    </script>
</body>

</html>